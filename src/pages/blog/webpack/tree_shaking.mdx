import MDXContentCom from "@shared/MDXContent";
import { RandomCover } from "@constant";
export const meta = {
  title: "Webpack Tree Shaking",
  description: "Webpack Tree Shaking",
  date: "2022-11-13",
  cover: "/static/images/webpack.png"
};

export default ({ children }) => (
  <MDXContentCom meta={meta}>{children}</MDXContentCom>
);

{/* https://developer.mozilla.org/zh-CN/docs/Web/Media/Formats/Image_types */}

##

optimization[ɑptəməˈzeɪʃənz] 优化
https://sourcegraph.com/search?q=context:global+repo:%5Egithub%5C.com/webpack/webpack%24%40main+interface+Optimization&patternType=standard&case=yes

webpack [optimization.usedExports](https://webpack.docschina.org/configuration/optimization/#optimizationusedexports)
设置`mode: production`

Tree-Shaking 实现原理 https://juejin.cn/post/7002410645316436004

步骤：

- Make 阶段，收集模块导出变量并记录到模块依赖关系图 `ModuleGraph` 变量中
- Seal 阶段，遍历 ModuleGraph 标记模块导出变量有没有被使用
- 生成产物时，若变量没有被其它模块使用则删除对应的导出语句

这个时候 foo 变量对应的代码 const foo='foo' 都还保留完整，这是因为标记功能只会影响到模块的导出语句，真正执行“Shaking”操作的是 Terser 插件。
例如在上例中 foo 变量经过标记后，已经变成一段 Dead Code —— 不可能被执行到的代码，
这个时候只需要用 Terser 提供的 DCE 功能就可以删除这一段定义语句，以此实现完整的 Tree Shaking 效果。
