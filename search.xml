<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>å‰ç«¯é¢è¯•</title>
    <url>/2022/11/08/fe-interview/</url>
    <content><![CDATA[<h2 id="javascript"><a href="#javascript" class="headerlink" title="javascript"></a>javascript</h2><h3 id="this-çš„æŒ‡å‘ï¼ˆè°è°ƒç”¨æŒ‡å‘è°ï¼‰"><a href="#this-çš„æŒ‡å‘ï¼ˆè°è°ƒç”¨æŒ‡å‘è°ï¼‰" class="headerlink" title="this çš„æŒ‡å‘ï¼ˆè°è°ƒç”¨æŒ‡å‘è°ï¼‰"></a>this çš„æŒ‡å‘ï¼ˆè°è°ƒç”¨æŒ‡å‘è°ï¼‰</h3><h3 id="æ™®é€šå‡½æ•°å’Œç®­å¤´å‡½æ•°çš„åŒºåˆ«"><a href="#æ™®é€šå‡½æ•°å’Œç®­å¤´å‡½æ•°çš„åŒºåˆ«" class="headerlink" title="æ™®é€šå‡½æ•°å’Œç®­å¤´å‡½æ•°çš„åŒºåˆ«"></a>æ™®é€šå‡½æ•°å’Œç®­å¤´å‡½æ•°çš„åŒºåˆ«</h3><ul>
<li>è¯­æ³•æ›´åŠ ç®€æ´ã€æ¸…æ™°</li>
<li>ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ <code>this</code></li>
<li>ç®­å¤´å‡½æ•°ç»§æ‰¿è€Œæ¥çš„ <code>this</code> æŒ‡å‘æ°¸è¿œä¸å˜</li>
<li><code>call</code>,<code>apply</code>,<code>bind</code>æ— æ³•æ”¹å˜ç®­å¤´å‡½æ•°ä¸­ <code>this</code> çš„æŒ‡å‘</li>
<li>ç®­å¤´å‡½æ•°ä¸èƒ½ä½œä¸ºæ„é€ å‡½æ•°ä½¿ç”¨ (ä¸ºä»€ä¹ˆ)</li>
<li>ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ <code>arguments</code> (ä¸ºä»€ä¹ˆ)</li>
<li>ç®­å¤´å‡½æ•°æ²¡æœ‰åŸå‹ <code>prototype</code> (ä¸ºä»€ä¹ˆ)</li>
<li>ç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œ <code>Generator</code> å‡½æ•°ï¼Œä¸èƒ½ä½¿ç”¨ <code>yeild</code> å…³é”®å­— (ä¸ºä»€ä¹ˆ)</li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Arrow_functions#%E8%A7%A3%E6%9E%90%E9%A1%BA%E5%BA%8F">è§£æé¡ºåº</a> è™½ç„¶ç®­å¤´å‡½æ•°ä¸­çš„ç®­å¤´ä¸æ˜¯è¿ç®—ç¬¦ï¼Œä½†ç®­å¤´å‡½æ•°å…·æœ‰ä¸å¸¸è§„å‡½æ•°ä¸åŒçš„ç‰¹æ®Šè¿ç®—ç¬¦ä¼˜å…ˆçº§è§£æè§„åˆ™ã€‚</li>
</ul>
<p><a href="https://juejin.cn/post/6844903805960585224">ES6 - ç®­å¤´å‡½æ•°ã€ç®­å¤´å‡½æ•°ä¸æ™®é€šå‡½æ•°çš„åŒºåˆ«</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Arrow_functions">ç®­å¤´å‡½æ•°</a></p>
<h3 id="javascript-é—­åŒ…"><a href="#javascript-é—­åŒ…" class="headerlink" title="javascript é—­åŒ…"></a>javascript é—­åŒ…</h3><h3 id="javascript-çš„ä½œç”¨åŸŸ"><a href="#javascript-çš„ä½œç”¨åŸŸ" class="headerlink" title="javascript çš„ä½œç”¨åŸŸ"></a>javascript çš„ä½œç”¨åŸŸ</h3><h3 id="javascript-å˜é‡å‘ä¸Šæ‰¾å–çš„åŸç†-æ‰§è¡Œä¸Šä¸‹æ–‡"><a href="#javascript-å˜é‡å‘ä¸Šæ‰¾å–çš„åŸç†-æ‰§è¡Œä¸Šä¸‹æ–‡" class="headerlink" title="javascript å˜é‡å‘ä¸Šæ‰¾å–çš„åŸç†(æ‰§è¡Œä¸Šä¸‹æ–‡)"></a>javascript å˜é‡å‘ä¸Šæ‰¾å–çš„åŸç†(æ‰§è¡Œä¸Šä¸‹æ–‡)</h3><h3 id="javascript-çš„è¯­æ³•åˆ†æ"><a href="#javascript-çš„è¯­æ³•åˆ†æ" class="headerlink" title="javascript çš„è¯­æ³•åˆ†æ"></a>javascript çš„è¯­æ³•åˆ†æ</h3><h3 id="javascript-çš„è¯æ³•åˆ†æ"><a href="#javascript-çš„è¯æ³•åˆ†æ" class="headerlink" title="javascript çš„è¯æ³•åˆ†æ"></a>javascript çš„è¯æ³•åˆ†æ</h3><p><a href="https://juejin.cn/post/6943550570515038245">https://juejin.cn/post/6943550570515038245</a></p>
<h3 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h3><pre><code class="highlight ts"><span class="comment">// es5</span>
<span class="keyword">function</span> <span class="title function_">PersonFn</span> (<span class="params"></span>) &#123;&#125;

<span class="keyword">function</span> <span class="title function_">SupermanFn</span>(<span class="params"></span>) &#123;&#125;

<span class="title class_">SupermanFn</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">PersonFn</span>()


<span class="comment">// es6</span>
<span class="keyword">class</span> <span class="title class_">Person</span> () &#123;&#125;

<span class="keyword">class</span> <span class="title class_">Superman</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Person</span> &#123;&#125;</code></pre>

<h3 id="æ´‹è‘±æ¨¡å‹"><a href="#æ´‹è‘±æ¨¡å‹" class="headerlink" title="æ´‹è‘±æ¨¡å‹"></a>æ´‹è‘±æ¨¡å‹</h3><pre><code class="highlight ts"><span class="comment">// ç±»ä¼¼é€’å½’</span>
<span class="comment">// åœ¨ next ä¸­æ‰§è¡Œä¸‹ä¸€ä¸ªfunction, ä¾æ¬¡é€’å½’</span>
<span class="comment">// å¦‚æœä¸å¥½ç†è§£å¯ä»¥å‚è€ƒ`tapable` ä¸­ä»£ç çš„å®ç°, `tapable`æ˜¯æŠŠæ‰€æœ‰å‡½æ•°é“ºå¹³ï¼Œä¾æ¬¡åµŒå¥—</span>
<span class="comment">// è€Œä¸‹é¢çš„å®ç°æ˜¯å¯¹ä¾æ¬¡åµŒå¥—æ”¹æˆäº†é€’å½’åµŒå¥—</span>
<span class="comment">// ä»¥ä¸Šæ˜¯ä¸ªäººç†è§£</span>
<span class="keyword">function</span> <span class="title function_">compose</span> (<span class="params">middleware</span>) &#123;
   <span class="keyword">return</span> <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;
      <span class="keyword">let</span> args = <span class="variable language_">arguments</span>
      <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">dispatch</span> (<span class="params">i</span>) &#123;
         <span class="keyword">const</span> fn = middleware[i]
         <span class="keyword">if</span> (!fn) <span class="keyword">return</span> <span class="literal">null</span>
         <span class="keyword">await</span> <span class="title function_">fn</span>(<span class="keyword">function</span> <span class="title function_">next</span> (<span class="params"></span>) &#123;
            <span class="title function_">dispatch</span>(i + <span class="number">1</span>)
         &#125;, ...args)
      &#125;

      <span class="keyword">await</span> <span class="title function_">dispatch</span>(<span class="number">0</span>)
   &#125;
&#125;

<span class="keyword">let</span> middleware = []
middleware.<span class="title function_">push</span>(<span class="function">(<span class="params">next</span>) =&gt;</span> &#123;
	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">0</span>)
	<span class="title function_">next</span>()
	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;next:&quot;</span>, <span class="number">3.3</span>)
&#125;)
middleware.<span class="title function_">push</span>(<span class="function">(<span class="params">next</span>) =&gt;</span> &#123;
	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>)
	<span class="title function_">next</span>()
	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;next:&quot;</span>, <span class="number">1.1</span>)
&#125;)
middleware.<span class="title function_">push</span>(<span class="function">() =&gt;</span> &#123;
    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>)
&#125;)

<span class="keyword">let</span> fn = <span class="title function_">compose</span>(middleware)
<span class="title function_">fn</span>() <span class="comment">// 0 1 2 next:1.1 next:3.3</span>
</code></pre>

<h2 id="æµè§ˆå™¨"><a href="#æµè§ˆå™¨" class="headerlink" title="æµè§ˆå™¨"></a>æµè§ˆå™¨</h2><h3 id="æµè§ˆå™¨çš„è¿›ç¨‹ï¼ˆChromeï¼‰"><a href="#æµè§ˆå™¨çš„è¿›ç¨‹ï¼ˆChromeï¼‰" class="headerlink" title="æµè§ˆå™¨çš„è¿›ç¨‹ï¼ˆChromeï¼‰"></a>æµè§ˆå™¨çš„è¿›ç¨‹ï¼ˆChromeï¼‰</h3><ul>
<li>Browser Process æµè§ˆå™¨çš„ä¸»è¿›ç¨‹ï¼ˆè´Ÿè´£åè°ƒã€ä¸»æ§ï¼‰ ï¼ˆ1ï¼‰è´Ÿè´£åŒ…æ‹¬åœ°å€æ ï¼Œä¹¦ç­¾æ ï¼Œå‰è¿›åé€€æŒ‰é’®ç­‰éƒ¨åˆ†çš„å·¥ä½œ ï¼ˆ2ï¼‰è´Ÿè´£å¤„ç†æµè§ˆå™¨çš„ä¸€äº›ä¸å¯è§çš„åº•å±‚æ“ä½œï¼Œæ¯”å¦‚ç½‘ç»œè¯·æ±‚å’Œæ–‡ä»¶è®¿é—® ï¼ˆ3ï¼‰è´Ÿè´£å„ä¸ªé¡µé¢çš„ç®¡ç†ï¼Œåˆ›å»ºå’Œé”€æ¯å…¶ä»–è¿›ç¨‹</li>
<li>Utility Process</li>
<li>Render Process è´Ÿè´£ä¸€ä¸ª tab å†…å…³äºç½‘é¡µå‘ˆç°çš„æ‰€æœ‰äº‹æƒ…ï¼Œé¡µé¢æ¸²æŸ“ï¼Œè„šæœ¬æ‰§è¡Œï¼Œäº‹ä»¶å¤„ç†ç­‰</li>
<li>GPU Process è´Ÿè´£æ§åˆ¶ä¸€ä¸ªç½‘é¡µç”¨åˆ°çš„æ‰€æœ‰æ’ä»¶ï¼Œå¦‚ flash æ¯ç§ç±»å‹çš„æ’ä»¶å¯¹åº”ä¸€ä¸ªè¿›ç¨‹ï¼Œä»…å½“ä½¿ç”¨è¯¥æ’ä»¶æ—¶æ‰åˆ›å»º</li>
<li>Plugin Process è´Ÿè´£å¤„ç† GPU ç›¸å…³çš„ä»»åŠ¡</li>
</ul>
<p><a href="https://juejin.cn/post/6844903812642111501">æµè§ˆå™¨å¤šçº¿ç¨‹å’Œ js å•çº¿ç¨‹</a></p>
<h3 id="åœ¨æµè§ˆå™¨è¾“å…¥-URL-å›è½¦ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆ"><a href="#åœ¨æµè§ˆå™¨è¾“å…¥-URL-å›è½¦ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆ" class="headerlink" title="åœ¨æµè§ˆå™¨è¾“å…¥ URL å›è½¦ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆ"></a>åœ¨æµè§ˆå™¨è¾“å…¥ URL å›è½¦ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆ</h3><p><a href="https://zhuanlan.zhihu.com/p/80551769">åœ¨æµè§ˆå™¨è¾“å…¥ URL å›è½¦ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆ</a></p>
<h3 id="æµè§ˆå™¨-GC"><a href="#æµè§ˆå™¨-GC" class="headerlink" title="æµè§ˆå™¨ GC"></a>æµè§ˆå™¨ GC</h3><h2 id="node"><a href="#node" class="headerlink" title="node"></a>node</h2><h3 id="npm-æ‰§è¡Œå‘½ä»¤çš„æµç¨‹"><a href="#npm-æ‰§è¡Œå‘½ä»¤çš„æµç¨‹" class="headerlink" title="npm æ‰§è¡Œå‘½ä»¤çš„æµç¨‹"></a>npm æ‰§è¡Œå‘½ä»¤çš„æµç¨‹</h3><h3 id="eventloop"><a href="#eventloop" class="headerlink" title="eventloop"></a>eventloop</h3><h3 id="å‰ç«¯é¡µé¢ä¼˜åŒ–"><a href="#å‰ç«¯é¡µé¢ä¼˜åŒ–" class="headerlink" title="å‰ç«¯é¡µé¢ä¼˜åŒ–"></a>å‰ç«¯é¡µé¢ä¼˜åŒ–</h3><ul>
<li>å‹ç¼© js&#x2F;css&#x2F;html&#x2F;å›¾ç‰‡ï¼Œå‡å°‘è¯·æ±‚æµé‡</li>
<li>åˆå¹¶å°æ–‡ä»¶éƒ½ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå‡å°‘è¯·æ±‚æ•°</li>
<li>é™æ€èµ„æºä½¿ç”¨ CDN</li>
<li>å›¾ç‰‡å°½é‡ä½¿ç”¨ webpç­‰å‹ç¼©æ•ˆæœæ¯”è¾ƒå¥½çš„å›¾ç‰‡æ ¼å¼ ï¼Œ å¯ä»¥ä½¿ç”¨pictureæ ‡ç­¾</li>
<li>æœåŠ¡ç«¯å¼€å¯ gzipç­‰å‹ç¼©</li>
<li>ä½¿ç”¨PWA</li>
<li>ä½¿ç”¨ç¼“å­˜</li>
<li>å›¾ç‰‡æ‡’åŠ è½½&#x2F;ä½¿ç”¨é›ªç¢§å›¾&#x2F;ä½¿ç”¨ svg</li>
<li>ä½¿ç”¨ js æ‡’åŠ è½½&#x2F;é¢„åŠ è½½</li>
<li>å‡å°‘ dom çš„å±‚çº§åµŒå¥—</li>
<li>é¿å… table å¸ƒå±€</li>
<li>css3 å¼€å¯ GPU åŠ é€Ÿ</li>
<li>é¿å…é‡å®šå‘</li>
<li>æ¥å£ä½¿ç”¨å¼‚æ­¥è¯·æ±‚</li>
<li>å°½é‡å‡å°‘è¯·æ±‚</li>
<li>å¦‚æœæœ‰å¿…è¦å¯ä»¥ä½¿ç”¨Workers</li>
<li>é¿å…&#x2F;å‡å°‘é‡æ’ä¸é‡ç»˜</li>
</ul>
<h2 id="ç½‘ç»œ"><a href="#ç½‘ç»œ" class="headerlink" title="ç½‘ç»œ"></a>ç½‘ç»œ</h2><h3 id="http1-å’Œ-http2-çš„åŒºåˆ«"><a href="#http1-å’Œ-http2-çš„åŒºåˆ«" class="headerlink" title="http1 å’Œ http2 çš„åŒºåˆ«"></a>http1 å’Œ http2 çš„åŒºåˆ«</h3><h3 id="ç½‘ç»œåˆ†å±‚"><a href="#ç½‘ç»œåˆ†å±‚" class="headerlink" title="ç½‘ç»œåˆ†å±‚"></a>ç½‘ç»œåˆ†å±‚</h3><h2 id="TypeScript"><a href="#TypeScript" class="headerlink" title="TypeScript"></a>TypeScript</h2><h3 id="TypeScript-çš„ç±»å‹"><a href="#TypeScript-çš„ç±»å‹" class="headerlink" title="TypeScript çš„ç±»å‹"></a>TypeScript çš„ç±»å‹</h3><p><code>any</code>,<code>string</code>,<code>number</code>,<code>boolean</code>,<code>Symbol</code>,<code>Array</code>,<code>null</code>,<code>unknow</code>,<code>never</code>,<code>void</code> â€¦</p>
<h3 id="TypeScript-ä¸­-anyã€neverã€unknownã€null-undefined-å’Œ-void-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#TypeScript-ä¸­-anyã€neverã€unknownã€null-undefined-å’Œ-void-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="TypeScript ä¸­ anyã€neverã€unknownã€null &amp; undefined å’Œ void æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>TypeScript ä¸­ anyã€neverã€unknownã€null &amp; undefined å’Œ void æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><pre><code class="highlight plaintext">any: åŠ¨æ€çš„å˜é‡ç±»å‹ï¼ˆå¤±å»äº†ç±»å‹æ£€æŸ¥çš„ä½œç”¨ï¼‰ã€‚
never: æ°¸ä¸å­˜åœ¨çš„å€¼çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼šnever ç±»å‹æ˜¯é‚£äº›æ€»æ˜¯ä¼šæŠ›å‡ºå¼‚å¸¸æˆ–æ ¹æœ¬å°±ä¸ä¼šæœ‰è¿”å›å€¼çš„å‡½æ•°è¡¨è¾¾å¼æˆ–ç®­å¤´å‡½æ•°è¡¨è¾¾å¼çš„è¿”å›å€¼ç±»å‹ã€‚
unknown: ä»»ä½•ç±»å‹çš„å€¼éƒ½å¯ä»¥èµ‹ç»™ Â unknownÂ  ç±»å‹ï¼Œä½†æ˜¯ Â unknownÂ  ç±»å‹çš„å€¼åªèƒ½èµ‹ç»™ Â unknownÂ  æœ¬èº«å’Œ Â anyÂ  ç±»å‹ã€‚
null &amp; undefined: é»˜è®¤æƒ…å†µä¸‹ null å’Œ undefined æ˜¯æ‰€æœ‰ç±»å‹çš„å­ç±»å‹ã€‚ å°±æ˜¯è¯´ä½ å¯ä»¥æŠŠ Â null å’Œ undefined èµ‹å€¼ç»™ number ç±»å‹çš„å˜é‡ã€‚å½“ä½ æŒ‡å®šäº† --strictNullChecks æ ‡è®°ï¼Œnull å’Œ undefined åªèƒ½èµ‹å€¼ç»™ void å’Œå®ƒä»¬å„è‡ªã€‚
void: æ²¡æœ‰ä»»ä½•ç±»å‹ã€‚ä¾‹å¦‚ï¼šä¸€ä¸ªå‡½æ•°å¦‚æœæ²¡æœ‰è¿”å›å€¼ï¼Œé‚£ä¹ˆè¿”å›å€¼å¯ä»¥å®šä¹‰ä¸º voidã€‚

ä½œè€…ï¼šå‘¨å§æ—¥å¸¸äº‹
é“¾æ¥ï¼šhttps://juejin.cn/post/6999985372440559624
æ¥æºï¼šç¨€åœŸæ˜é‡‘</code></pre>

<h3 id="TypeScript-è”åˆç±»å‹"><a href="#TypeScript-è”åˆç±»å‹" class="headerlink" title="TypeScript è”åˆç±»å‹"></a>TypeScript è”åˆç±»å‹</h3><h3 id="TypeScript-ä¸­å¦‚ä½•è”åˆæšä¸¾ç±»å‹çš„-Key"><a href="#TypeScript-ä¸­å¦‚ä½•è”åˆæšä¸¾ç±»å‹çš„-Key" class="headerlink" title="TypeScript ä¸­å¦‚ä½•è”åˆæšä¸¾ç±»å‹çš„ Key?"></a>TypeScript ä¸­å¦‚ä½•è”åˆæšä¸¾ç±»å‹çš„ Key?</h3><pre><code class="highlight ts"><span class="keyword">enum</span> str &#123;
  A,
  B,
  C
&#125;
<span class="keyword">type</span> strUnion = keyof <span class="keyword">typeof</span> str; <span class="comment">// &#x27;A&#x27; | &#x27;B&#x27; | &#x27;C&#x27;</span></code></pre>

<h3 id="type-å’Œ-interface-çš„åŒºåˆ«"><a href="#type-å’Œ-interface-çš„åŒºåˆ«" class="headerlink" title="type å’Œ interface çš„åŒºåˆ«"></a>type å’Œ interface çš„åŒºåˆ«</h3><h3 id="åå˜ã€é€†å˜ã€åŒå˜å’ŒæŠ—å˜çš„ç†è§£ï¼Ÿ"><a href="#åå˜ã€é€†å˜ã€åŒå˜å’ŒæŠ—å˜çš„ç†è§£ï¼Ÿ" class="headerlink" title="åå˜ã€é€†å˜ã€åŒå˜å’ŒæŠ—å˜çš„ç†è§£ï¼Ÿ"></a>åå˜ã€é€†å˜ã€åŒå˜å’ŒæŠ—å˜çš„ç†è§£ï¼Ÿ</h3><pre><code class="highlight ts">åå˜ï¼šX = Y Y ç±»å‹å¯ä»¥èµ‹å€¼ç»™ X ç±»å‹çš„æƒ…å†µå°±å«åšåå˜ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯ X ç±»å‹å…¼å®¹ Y ç±»å‹
<span class="keyword">interface</span> X &#123; <span class="attr">name</span>: <span class="built_in">string</span>; <span class="attr">age</span>: <span class="built_in">number</span>; &#125;
<span class="keyword">interface</span> Y &#123; <span class="attr">name</span>: <span class="built_in">string</span>; <span class="attr">age</span>: <span class="built_in">number</span>; <span class="attr">hobbies</span>: <span class="built_in">string</span>[] &#125;
<span class="keyword">let</span> <span class="attr">x</span>: X = &#123; <span class="attr">name</span>: <span class="string">&#x27;xiaoming&#x27;</span>, <span class="attr">age</span>: <span class="number">16</span> &#125;
<span class="keyword">let</span> <span class="attr">y</span>: Y = &#123; <span class="attr">name</span>: <span class="string">&#x27;xiaohong&#x27;</span>, <span class="attr">age</span>: <span class="number">18</span>, <span class="attr">hobbies</span>: [<span class="string">&#x27;eat&#x27;</span>] &#125;
x = y
å¤åˆ¶ä»£ç 
é€†å˜ï¼šprintY = printX å‡½æ•°X ç±»å‹å¯ä»¥èµ‹å€¼ç»™å‡½æ•°Y ç±»å‹ï¼Œå› ä¸ºå‡½æ•°Y åœ¨è°ƒç”¨çš„æ—¶å€™å‚æ•°æ˜¯æŒ‰ç…§Yç±»å‹è¿›è¡Œçº¦æŸçš„ï¼Œä½†æ˜¯ç”¨åˆ°çš„æ˜¯å‡½æ•°Xçš„Xçš„å±æ€§å’Œæ–¹æ³•ï¼Œtsæ£€æŸ¥ç»“æœæ˜¯ç±»å‹å®‰å…¨çš„ã€‚è¿™ç§ç‰¹æ€§å°±å«åšé€†å˜ï¼Œå‡½æ•°çš„å‚æ•°æœ‰é€†å˜çš„æ€§è´¨ã€‚
<span class="keyword">let</span> <span class="attr">printY</span>: <span class="function">(<span class="params"><span class="attr">y</span>: Y</span>) =&gt;</span> <span class="built_in">void</span>
printY = <span class="function">(<span class="params">y</span>) =&gt;</span> &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(y.<span class="property">hobbies</span>) &#125;
<span class="keyword">let</span> <span class="attr">printX</span>: <span class="function">(<span class="params"><span class="attr">x</span>: X</span>) =&gt;</span> <span class="built_in">void</span>
printX = <span class="function">(<span class="params">x</span>) =&gt;</span> &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(x.<span class="property">name</span>) &#125;
printY = printX
å¤åˆ¶ä»£ç 
åŒå˜ï¼ˆåŒå‘åå˜ï¼‰ï¼šX = Yï¼›Y = Xçˆ¶ç±»å‹å¯ä»¥èµ‹å€¼ç»™å­ç±»å‹ï¼Œå­ç±»å‹å¯ä»¥èµ‹å€¼ç»™çˆ¶ç±»å‹ï¼Œæ—¢é€†å˜åˆåå˜ï¼Œå«åšâ€œåŒå‘åå˜â€ï¼ˆts2.<span class="property">x</span> ä¹‹å‰æ”¯æŒè¿™ç§èµ‹å€¼ï¼Œä¹‹å ts åŠ äº†ä¸€ä¸ªç¼–è¯‘é€‰é¡¹ strictFunctionTypesï¼Œè®¾ç½®ä¸º <span class="literal">true</span> å°±åªæ”¯æŒå‡½æ•°å‚æ•°çš„é€†å˜ï¼Œè®¾ç½®ä¸º <span class="literal">false</span> åˆ™æ”¯æŒåŒå‘åå˜ï¼‰
æŠ—å˜ï¼ˆä¸å˜ï¼‰ï¼šéçˆ¶å­ç±»å‹ä¹‹é—´ä¸ä¼šå‘ç”Ÿå‹å˜ï¼Œåªè¦ç±»å‹ä¸ä¸€æ ·å°±ä¼šæŠ¥é”™
</code></pre>

<h3 id="declareï¼Œdeclare-global-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#declareï¼Œdeclare-global-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="declareï¼Œdeclare global æ˜¯ä»€ä¹ˆï¼Ÿ"></a>declareï¼Œdeclare global æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>declare æ˜¯ç”¨æ¥å®šä¹‰å…¨å±€å˜é‡ã€å…¨å±€å‡½æ•°ã€å…¨å±€å‘½åç©ºé—´ã€js modulesã€class ç­‰<br>declare global ä¸ºå…¨å±€å¯¹è±¡ window å¢åŠ æ–°çš„å±æ€§</p>
<h3 id="TypeScript-ç±»ä¸­æˆå‘˜çš„-publicã€privateã€protectedã€readonly-ä¿®é¥°ç¬¦çš„ç†è§£"><a href="#TypeScript-ç±»ä¸­æˆå‘˜çš„-publicã€privateã€protectedã€readonly-ä¿®é¥°ç¬¦çš„ç†è§£" class="headerlink" title="TypeScript ç±»ä¸­æˆå‘˜çš„ publicã€privateã€protectedã€readonly ä¿®é¥°ç¬¦çš„ç†è§£"></a>TypeScript ç±»ä¸­æˆå‘˜çš„ publicã€privateã€protectedã€readonly ä¿®é¥°ç¬¦çš„ç†è§£</h3><p>public: æˆå‘˜éƒ½é»˜è®¤ä¸º publicï¼Œè¢«æ­¤é™å®šç¬¦ä¿®é¥°çš„æˆå‘˜æ˜¯å¯ä»¥è¢«å¤–éƒ¨è®¿é—®ï¼›<br>private: è¢«æ­¤é™å®šç¬¦ä¿®é¥°çš„æˆå‘˜æ˜¯åªå¯ä»¥è¢«ç±»çš„å†…éƒ¨è®¿é—®ï¼›<br>protected: è¢«æ­¤é™å®šç¬¦ä¿®é¥°çš„æˆå‘˜æ˜¯åªå¯ä»¥è¢«ç±»çš„å†…éƒ¨ä»¥åŠç±»çš„å­ç±»è®¿é—®;<br>readonly: å…³é”®å­—å°†å±æ€§è®¾ç½®ä¸ºåªè¯»çš„ã€‚ åªè¯»å±æ€§å¿…é¡»åœ¨å£°æ˜æ—¶æˆ–æ„é€ å‡½æ•°é‡Œè¢«åˆå§‹åŒ–ã€‚</p>
<h3 id="keyof-å’Œ-typeof-å…³é”®å­—çš„ä½œç”¨"><a href="#keyof-å’Œ-typeof-å…³é”®å­—çš„ä½œç”¨" class="headerlink" title="keyof å’Œ typeof å…³é”®å­—çš„ä½œç”¨"></a>keyof å’Œ typeof å…³é”®å­—çš„ä½œç”¨</h3><p>keyof ç´¢å¼•ç±»å‹æŸ¥è¯¢æ“ä½œç¬¦ è·å–ç´¢å¼•ç±»å‹çš„å±æ€§åï¼Œæ„æˆè”åˆç±»å‹ã€‚<br>typeof è·å–ä¸€ä¸ªå˜é‡æˆ–å¯¹è±¡çš„ç±»å‹ã€‚</p>
<h3 id="å·¥å…·ç±»å‹-Partialã€Requiredã€Readonlyã€Recordã€Extractã€ReturnTypeã€Excludeã€Omit-çš„ä½œç”¨"><a href="#å·¥å…·ç±»å‹-Partialã€Requiredã€Readonlyã€Recordã€Extractã€ReturnTypeã€Excludeã€Omit-çš„ä½œç”¨" class="headerlink" title="å·¥å…·ç±»å‹ Partialã€Requiredã€Readonlyã€Recordã€Extractã€ReturnTypeã€Excludeã€Omit çš„ä½œç”¨"></a>å·¥å…·ç±»å‹ Partialã€Requiredã€Readonlyã€Recordã€Extractã€ReturnTypeã€Excludeã€Omit çš„ä½œç”¨</h3><h3 id="å®ç°ä¸€ä¸ªé€’å½’çš„ç±»å‹"><a href="#å®ç°ä¸€ä¸ªé€’å½’çš„ç±»å‹" class="headerlink" title="å®ç°ä¸€ä¸ªé€’å½’çš„ç±»å‹"></a>å®ç°ä¸€ä¸ªé€’å½’çš„ç±»å‹</h3><h3 id="TypeScript-ä¸­-ã€-ã€-ã€-ã€-ã€-ç­‰ç¬¦å·çš„å«ä¹‰"><a href="#TypeScript-ä¸­-ã€-ã€-ã€-ã€-ã€-ç­‰ç¬¦å·çš„å«ä¹‰" class="headerlink" title="TypeScript ä¸­ ?.ã€??ã€!ã€!.ã€_ã€** ç­‰ç¬¦å·çš„å«ä¹‰"></a>TypeScript ä¸­ ?.ã€??ã€!ã€!.ã€_ã€** ç­‰ç¬¦å·çš„å«ä¹‰</h3><p>?. å¯é€‰é“¾ é‡åˆ° null å’Œ undefined å¯ä»¥ç«‹å³åœæ­¢è¡¨è¾¾å¼çš„è¿è¡Œã€‚<br>?? ç©ºå€¼åˆå¹¶è¿ç®—ç¬¦ å½“å·¦ä¾§æ“ä½œæ•°ä¸º null æˆ– undefined æ—¶ï¼Œå…¶è¿”å›å³ä¾§çš„æ“ä½œæ•°ï¼Œå¦åˆ™è¿”å›å·¦ä¾§çš„æ“ä½œæ•°ã€‚<br>! éç©ºæ–­è¨€è¿ç®—ç¬¦ x! å°†ä» x å€¼åŸŸä¸­æ’é™¤ null å’Œ undefined<br>!. åœ¨å˜é‡ååæ·»åŠ ï¼Œå¯ä»¥æ–­è¨€æ’é™¤ undefined å’Œ null ç±»å‹<br>_ æ•°å­—åˆ†å‰²ç¬¦ åˆ†éš”ç¬¦ä¸ä¼šæ”¹å˜æ•°å€¼å­—é¢é‡çš„å€¼ï¼Œä½¿äººæ›´å®¹æ˜“è¯»æ‡‚æ•°å­— .e.g 1_101_324ã€‚<br>** æ±‚å¹‚</p>
<h2 id="React"><a href="#React" class="headerlink" title="React"></a>React</h2><h3 id="hooks"><a href="#hooks" class="headerlink" title="hooks"></a>hooks</h3><h3 id="react-diff"><a href="#react-diff" class="headerlink" title="react diff"></a>react diff</h3><h3 id="fiber"><a href="#fiber" class="headerlink" title="fiber"></a>fiber</h3><h2 id="ç®—æ³•æˆ–ä»£ç å®ç°"><a href="#ç®—æ³•æˆ–ä»£ç å®ç°" class="headerlink" title="ç®—æ³•æˆ–ä»£ç å®ç°"></a>ç®—æ³•æˆ–ä»£ç å®ç°</h2><h3 id="å¼‚æ­¥åŠ æ³•-å­—èŠ‚"><a href="#å¼‚æ­¥åŠ æ³•-å­—èŠ‚" class="headerlink" title="å¼‚æ­¥åŠ æ³•(å­—èŠ‚)"></a>å¼‚æ­¥åŠ æ³•(å­—èŠ‚)</h3><pre><code class="highlight ts"><span class="comment">// const addRemote = async (a, b) =&gt; new Promise(resolve =&gt; &#123;</span>
<span class="comment">//     setTimeout(() =&gt; resolve(a + b), 1000)</span>
<span class="comment">// &#125;)</span>

<span class="comment">// const addRemote = async (a, b) =&gt; new Promise(resolve =&gt;</span>
<span class="comment">//     setTimeout ( () =&gt; resolve(a + b), 1000)</span>
<span class="comment">// 2):</span>
<span class="comment">// async function add (...inputs) &#123;</span>
<span class="comment">// &#125;</span>
<span class="comment">// addmte</span>
<span class="comment">// // çš„åŠ æ³•ã€‚</span>
<span class="comment">// async function add(..inputs) &#123;</span>
<span class="comment">// 1ä½ çš„å®ç°</span>
<span class="comment">// // å·è¯·ç”¨ç¤ºä¾‹éªŒè¯è¿è¡Œç»“æœï¼š</span>
<span class="comment">// add(1, 2). then(result =&gt; &#123;</span>
<span class="comment">// console.log(result): // 3</span>
<span class="comment">// add(1, 2, 3, 4) .then(result =&gt; f</span>
<span class="comment">// console.log(result): // 10</span>
<span class="comment">// add(1, 2, 1, 2, 1, 2. 3, 4). then(result =&gt; f</span>
<span class="comment">// console.log(result): // 16</span>
<span class="comment">// &#125;)</span></code></pre>

<h2 id="å®ç°-EventEmitter-æ¨¡å‹ï¼Œå®ç°-on-once-off-emit-æ–¹æ³•"><a href="#å®ç°-EventEmitter-æ¨¡å‹ï¼Œå®ç°-on-once-off-emit-æ–¹æ³•" class="headerlink" title="å®ç° EventEmitter æ¨¡å‹ï¼Œå®ç° on, once, off, emit æ–¹æ³•"></a>å®ç° EventEmitter æ¨¡å‹ï¼Œå®ç° <code>on</code>, <code>once</code>, <code>off</code>, <code>emit</code> æ–¹æ³•</h2><pre><code class="highlight ts"><span class="keyword">class</span> <span class="title class_">EventEmitter</span> &#123;
  <span class="attr">_event</span>: <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="title class_">Array</span>&lt;<span class="title class_">Function</span>&gt;&gt;;
  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;
    <span class="variable language_">this</span>.<span class="property">_event</span> = &#123;&#125;;
  &#125;

  <span class="title function_">on</span>(<span class="params"><span class="attr">type</span>: <span class="built_in">string</span>, <span class="attr">callback</span>: <span class="title class_">Function</span></span>) &#123;
    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_event</span>[<span class="keyword">type</span>]) &#123;
      <span class="variable language_">this</span>.<span class="property">_event</span>[<span class="keyword">type</span>].<span class="title function_">push</span>(callback);
    &#125; <span class="keyword">else</span> &#123;
      <span class="variable language_">this</span>.<span class="property">_event</span>[<span class="keyword">type</span>] = [callback];
    &#125;
    <span class="keyword">return</span> <span class="variable language_">this</span>;
  &#125;

  <span class="title function_">once</span>(<span class="params"><span class="attr">type</span>: <span class="built_in">string</span>, <span class="attr">callback</span>: <span class="title class_">Function</span></span>) &#123;
    <span class="keyword">let</span> <span class="title function_">fn</span> = (<span class="params">...<span class="attr">args</span>: <span class="title class_">Array</span>&lt;<span class="built_in">any</span>&gt;</span>) =&gt; &#123;
      callback.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);
      <span class="variable language_">this</span>.<span class="title function_">off</span>(<span class="keyword">type</span>, fn);
    &#125;;
    <span class="variable language_">this</span>.<span class="title function_">on</span>(<span class="keyword">type</span>, fn);
    <span class="keyword">return</span> <span class="variable language_">this</span>;
  &#125;

  <span class="title function_">off</span>(<span class="params"><span class="attr">type</span>: <span class="built_in">string</span>, <span class="attr">callback</span>: <span class="title class_">Function</span></span>) &#123;
    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_event</span>[<span class="keyword">type</span>]) &#123;
      <span class="variable language_">this</span>.<span class="property">_event</span>[<span class="keyword">type</span>] = <span class="variable language_">this</span>.<span class="property">_event</span>[<span class="keyword">type</span>].<span class="title function_">filter</span>(<span class="function"><span class="params">item</span> =&gt;</span> item !== callback);
    &#125;
    <span class="keyword">return</span> <span class="variable language_">this</span>;
  &#125;

  <span class="title function_">emit</span>(<span class="params"><span class="attr">type</span>: <span class="built_in">string</span></span>) &#123;
    <span class="variable language_">this</span>.<span class="property">_event</span>[<span class="keyword">type</span>].<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> <span class="title function_">item</span>());
    <span class="keyword">return</span> <span class="variable language_">this</span>;
  &#125;
&#125;

<span class="keyword">const</span> eventEmitter = <span class="keyword">new</span> <span class="title class_">EventEmitter</span>();

<span class="keyword">let</span> <span class="title function_">handle1</span> = (<span class="params"></span>) =&gt; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;click1&quot;</span>);
<span class="keyword">let</span> <span class="title function_">handle2</span> = (<span class="params"></span>) =&gt; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;click2&quot;</span>);
<span class="keyword">let</span> <span class="title function_">handle3</span> = (<span class="params"></span>) =&gt; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;click3&quot;</span>);
<span class="keyword">let</span> <span class="title function_">handle4</span> = (<span class="params"></span>) =&gt; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;click4&quot;</span>);

eventEmitter.<span class="title function_">on</span>(<span class="string">&quot;click&quot;</span>, handle1);
eventEmitter.<span class="title function_">on</span>(<span class="string">&quot;click&quot;</span>, handle2);
eventEmitter.<span class="title function_">once</span>(<span class="string">&quot;click&quot;</span>, handle3);
eventEmitter.<span class="title function_">emit</span>(<span class="string">&quot;click&quot;</span>);
eventEmitter.<span class="title function_">emit</span>(<span class="string">&quot;click&quot;</span>);</code></pre>

<h3 id="è§‚å¯Ÿè€…æ¨¡å¼ï¼Œè¯·å®ç°-observable-å’Œ-observe-ä¸¤ä¸ªå‡½æ•°"><a href="#è§‚å¯Ÿè€…æ¨¡å¼ï¼Œè¯·å®ç°-observable-å’Œ-observe-ä¸¤ä¸ªå‡½æ•°" class="headerlink" title="è§‚å¯Ÿè€…æ¨¡å¼ï¼Œè¯·å®ç° observable å’Œ observe ä¸¤ä¸ªå‡½æ•°"></a>è§‚å¯Ÿè€…æ¨¡å¼ï¼Œè¯·å®ç° observable å’Œ observe ä¸¤ä¸ªå‡½æ•°</h3><pre><code class="highlight ts"></code></pre>

<h3 id="å­—ç¬¦ä¸²éšè—éƒ¨åˆ†å†…å®¹-é˜¿é‡Œ"><a href="#å­—ç¬¦ä¸²éšè—éƒ¨åˆ†å†…å®¹-é˜¿é‡Œ" class="headerlink" title="å­—ç¬¦ä¸²éšè—éƒ¨åˆ†å†…å®¹ (é˜¿é‡Œ)"></a>å­—ç¬¦ä¸²éšè—éƒ¨åˆ†å†…å®¹ (é˜¿é‡Œ)</h3><p>å®ç°ä¸€ä¸ªæ–¹æ³•ï¼Œæ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²å’Œä¸€ä¸ªç¬¦å·ï¼Œå°†å­—ç¬¦ä¸²ä¸­é—´å››ä½æŒ‰æŒ‡å®šç¬¦å·éšè—</p>
<ol>
<li>ç¬¦å·æ— æŒ‡å®šæ—¶ä½¿ç”¨æ˜Ÿå·ï¼ˆ*ï¼‰</li>
<li>æ¥æ”¶çš„å­—ç¬¦ä¸²å°äºæˆ–ç­‰äºå››ä½æ—¶ï¼Œè¿”å›åŒæ ·é•¿åº¦çš„ç¬¦å·ä¸²ï¼Œç­‰åŒäºå…¨éšè—ï¼Œå¦‚ 123ï¼Œéšè—åæ˜¯***</li>
<li>å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¤§äºå››ä½çš„å¥‡æ•°æ—¶ï¼Œå¦‚ 123456789ï¼Œéšè—åæ˜¯ 12789ï¼Œå¥‡æ•°å¤šå‡ºæ¥çš„ä¸€ä½åœ¨æœ«å°¾</li>
</ol>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="highlight js"><span class="title function_">mask</span>(<span class="string">&quot;alibaba&quot;</span>, <span class="string">&quot;#&quot;</span>); <span class="comment">// a####ba</span>
<span class="title function_">mask</span>(<span class="string">&quot;85022088&quot;</span>); <span class="comment">// 85****88</span>
<span class="title function_">mask</span>(<span class="string">&quot;hello&quot;</span>); <span class="comment">// ****o</span>
<span class="title function_">mask</span>(<span class="string">&quot;abc&quot;</span>, <span class="string">&quot;?&quot;</span>); <span class="comment">// ???</span>
<span class="title function_">mask</span>(<span class="string">&quot;é˜¿é‡Œå·´å·´é›†å›¢&quot;</span>, <span class="string">&quot;?&quot;</span>); <span class="comment">// é˜¿????å›¢</span></code></pre>

<p>å®ç°</p>
<pre><code class="highlight ts"><span class="keyword">function</span> <span class="title function_">mask</span>(<span class="params">str, char = <span class="string">&quot;*&quot;</span></span>) &#123;
  <span class="keyword">if</span> (str.<span class="property">length</span> &lt;= <span class="number">4</span>) <span class="keyword">return</span> char.<span class="title function_">repeat</span>(str.<span class="property">length</span>);
  <span class="comment">/* ä»£ç å®ç° */</span>
  <span class="keyword">let</span> result = <span class="string">&quot;&quot;</span>;
  <span class="keyword">let</span> i = <span class="title class_">Math</span>.<span class="title function_">floor</span>(str.<span class="property">length</span> / <span class="number">2</span>) - <span class="number">1</span>;
  <span class="keyword">let</span> j = <span class="title class_">Math</span>.<span class="title function_">floor</span>(str.<span class="property">length</span> / <span class="number">2</span>);
  <span class="keyword">while</span> (result.<span class="property">length</span> !== str.<span class="property">length</span>) &#123;
    <span class="keyword">if</span> (j - i &lt;= <span class="number">4</span>) &#123;
      result = char + result;
      result += char;
    &#125; <span class="keyword">else</span> &#123;
      result = (str[i] || <span class="string">&quot;&quot;</span>) + result;
      result += str[j];
    &#125;
    i--;
    j++;
  &#125;
  <span class="keyword">return</span> result;
&#125;</code></pre>

<p>å®ç°æ¥æºï¼š<a href="https://github.com/FrankKai/FrankKai.github.io/issues/245">https://github.com/FrankKai/FrankKai.github.io/issues/245</a></p>
<h3 id="HashMap"><a href="#HashMap" class="headerlink" title="HashMap"></a>HashMap</h3><pre><code class="highlight ts"><span class="keyword">function</span> <span class="title function_">HashMap</span>(<span class="params"></span>) &#123;
  <span class="variable language_">this</span>.<span class="property">map</span> = &#123;&#125;;
&#125;
<span class="title class_">HashMap</span>.<span class="property"><span class="keyword">prototype</span></span> = &#123;
  <span class="attr">get</span>: <span class="keyword">function</span> (<span class="params">key</span>) &#123;
    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);
    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">map</span>.<span class="title function_">hasOwnProperty</span>(key)) &#123;
      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">map</span>[key];
    &#125;
    <span class="keyword">return</span> <span class="literal">null</span>;
  &#125;,
  <span class="attr">put</span>: <span class="keyword">function</span> (<span class="params">key, val</span>) &#123;
    <span class="variable language_">this</span>.<span class="property">map</span>[key] = val;
  &#125;,
  <span class="attr">remove</span>: <span class="keyword">function</span> (<span class="params">key</span>) &#123;
    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">map</span>.<span class="title function_">hasOwnProperty</span>(key)) &#123;
      <span class="keyword">let</span> tmp = <span class="variable language_">this</span>.<span class="property">map</span>[key];
      <span class="keyword">delete</span> <span class="variable language_">this</span>.<span class="property">map</span>[key];
      <span class="keyword">return</span> tmp;
    &#125;
    <span class="keyword">return</span> <span class="literal">null</span>;
  &#125;,
  <span class="attr">clear</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;
    <span class="variable language_">this</span>.<span class="property">map</span> = &#123;&#125;;
  &#125;,
  <span class="attr">keySet</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;
    <span class="keyword">let</span> _keys = [];
    <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> <span class="variable language_">this</span>.<span class="property">map</span>) &#123;
      _keys.<span class="title function_">push</span>(key);
    &#125;
    <span class="keyword">return</span> _keys;
  &#125;
&#125;;
<span class="title class_">HashMap</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> = <span class="title class_">HashMap</span>;
<span class="keyword">let</span> hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>();</code></pre>

<h3 id="LRU"><a href="#LRU" class="headerlink" title="LRU"></a>LRU</h3><h3 id="DFS-æ·±åº¦ä¼˜å…ˆ"><a href="#DFS-æ·±åº¦ä¼˜å…ˆ" class="headerlink" title="DFS æ·±åº¦ä¼˜å…ˆ"></a>DFS æ·±åº¦ä¼˜å…ˆ</h3><h3 id="å¹¿åº¦ä¼˜å…ˆ"><a href="#å¹¿åº¦ä¼˜å…ˆ" class="headerlink" title="å¹¿åº¦ä¼˜å…ˆ"></a>å¹¿åº¦ä¼˜å…ˆ</h3>]]></content>
      <categories>
        <category>é¢è¯•</category>
      </categories>
      <tags>
        <tag>å‰ç«¯</tag>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title>Markdown</title>
    <url>/2024/10/01/markdown/</url>
    <content><![CDATA[<h2 id="æœ‰åºåˆ—è¡¨"><a href="#æœ‰åºåˆ—è¡¨" class="headerlink" title="æœ‰åºåˆ—è¡¨"></a>æœ‰åºåˆ—è¡¨</h2><p>ä½¿ç”¨æ•°å­—åŠ <code>.</code> åŠ ç©ºæ ¼å¼€å¤´</p>
<pre><code class="highlight markdown"><span class="bullet">1.</span> æœ‰åºåˆ—è¡¨ 1
<span class="bullet">2.</span> æœ‰åºåˆ—è¡¨ 2
<span class="bullet">3.</span> æœ‰åºåˆ—è¡¨ 3</code></pre>

<ol>
<li>æœ‰åºåˆ—è¡¨ 1</li>
<li>æœ‰åºåˆ—è¡¨ 2</li>
<li>æœ‰åºåˆ—è¡¨ 3</li>
</ol>
<h2 id="æ— åºåˆ—è¡¨"><a href="#æ— åºåˆ—è¡¨" class="headerlink" title="æ— åºåˆ—è¡¨"></a>æ— åºåˆ—è¡¨</h2><p>ä½¿ç”¨<code>-</code> åŠ ç©ºæ ¼å¼€å¤´</p>
<pre><code class="highlight markdown"><span class="bullet">-</span> æ— åºåˆ—è¡¨
<span class="bullet">-</span> æ— åºåˆ—è¡¨
<span class="bullet">-</span> æ— åºåˆ—è¡¨
<span class="bullet">  -</span> æ— åºåˆ—è¡¨
<span class="bullet">  -</span> æ— åºåˆ—è¡¨</code></pre>

<ul>
<li>æ— åºåˆ—è¡¨</li>
<li>æ— åºåˆ—è¡¨</li>
<li>æ— åºåˆ—è¡¨<ul>
<li>æ— åºåˆ—è¡¨</li>
<li>æ— åºåˆ—è¡¨</li>
</ul>
</li>
</ul>
<h2 id="æ ‡é¢˜"><a href="#æ ‡é¢˜" class="headerlink" title="æ ‡é¢˜"></a>æ ‡é¢˜</h2><p>ä½¿ç”¨<code>#</code>åŠ ç©ºæ ¼å¼€å¤´</p>
<h3 id="Heading-H3"><a href="#Heading-H3" class="headerlink" title="Heading H3"></a>Heading H3</h3><h4 id="Heading-H4"><a href="#Heading-H4" class="headerlink" title="Heading H4"></a>Heading H4</h4><h2 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h2><p>ä½¿ç”¨<code>&gt;</code>å¼€å¤´</p>
<pre><code class="highlight markdown"><span class="quote">&gt; å¯¹äºç¾å¾·ï¼Œæˆ‘ä»¬ä»…æ­¢äºè®¤è¯†æ˜¯ä¸å¤Ÿçš„ï¼Œæˆ‘ä»¬è¿˜å¿…é¡»åŠªåŠ›åŸ¹å…»å®ƒï¼Œè¿ç”¨å®ƒï¼Œæˆ–æ˜¯é‡‡å–ç§ç§æ–¹æ³•ï¼Œä»¥ä½¿æˆ‘ä»¬æˆä¸ºè‰¯å–„ä¹‹äººã€‚ --èå£«æ¯”äºš</span>

<span class="quote">&gt; &gt; é»‘å¤œæ— è®ºæ€æ ·æ‚ é•¿ï¼Œç™½æ˜¼æ€»ä¼šåˆ°æ¥ã€‚</span>

<span class="quote">&gt; &gt; &gt; To be or not to be,that&#x27;s a question. --èå£«æ¯”äºš</span></code></pre>

<blockquote>
<p>å¯¹äºç¾å¾·ï¼Œæˆ‘ä»¬ä»…æ­¢äºè®¤è¯†æ˜¯ä¸å¤Ÿçš„ï¼Œæˆ‘ä»¬è¿˜å¿…é¡»åŠªåŠ›åŸ¹å…»å®ƒï¼Œè¿ç”¨å®ƒï¼Œæˆ–æ˜¯é‡‡å–ç§ç§æ–¹æ³•ï¼Œä»¥ä½¿æˆ‘ä»¬æˆä¸ºè‰¯å–„ä¹‹äººã€‚ â€“èå£«æ¯”äºš</p>
</blockquote>
<blockquote>
<blockquote>
<p>é»‘å¤œæ— è®ºæ€æ ·æ‚ é•¿ï¼Œç™½æ˜¼æ€»ä¼šåˆ°æ¥ã€‚</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>To be or not to be,thatâ€™s a question. â€“èå£«æ¯”äºš</p>
</blockquote>
</blockquote>
</blockquote>
<h2 id="ç²—ä½“"><a href="#ç²—ä½“" class="headerlink" title="ç²—ä½“"></a>ç²—ä½“</h2><p>ä½¿ç”¨<code>**</code>è¿›è¡ŒåŒ…æ‹¬</p>
<pre><code class="highlight bash">**ç²—ä½“**</code></pre>

<p><strong>ç²—ä½“</strong></p>
<h2 id="æ–œä½“"><a href="#æ–œä½“" class="headerlink" title="æ–œä½“"></a>æ–œä½“</h2><p>ä½¿ç”¨<code>*</code>æˆ–<code>_</code>è¿›è¡ŒåŒ…æ‹¬</p>
<pre><code class="highlight markdown"><span class="emphasis">_æ–œä½“_</span></code></pre>

<p><em>æ–œä½“</em></p>
<h2 id="æ–œä½“åŠ ç²—"><a href="#æ–œä½“åŠ ç²—" class="headerlink" title="æ–œä½“åŠ ç²—"></a>æ–œä½“åŠ ç²—</h2><p>ä½¿ç”¨<code>**</code>è¿›è¡ŒåŒ…æ‹¬</p>
<pre><code class="highlight markdown"><span class="strong">**<span class="emphasis">_æ–œä½“_</span>**</span></code></pre>

<p><strong><em>æ–œä½“</em></strong></p>
<h2 id="å›¾ç‰‡"><a href="#å›¾ç‰‡" class="headerlink" title="å›¾ç‰‡"></a>å›¾ç‰‡</h2><p><code>![img altçš„å€¼](å›¾ç‰‡åœ°å€)</code></p>
<pre><code class="highlight markdown">![<span class="string">ShineShao</span>](<span class="link">https://avatars2.githubusercontent.com/u/16034259?s=460&amp;u=7caff2589de5d263f44675662d8f1a5b91a1d706&amp;v=4</span>)</code></pre>

<p><img src="https://avatars2.githubusercontent.com/u/16034259?s=460&u=7caff2589de5d263f44675662d8f1a5b91a1d706&v=4" alt="ShineShao"></p>
<h2 id="é“¾æ¥"><a href="#é“¾æ¥" class="headerlink" title="é“¾æ¥"></a>é“¾æ¥</h2><p><code>[é“¾æ¥å](é“¾æ¥åœ°å€)</code></p>
<pre><code class="highlight markdown">&#123;/_ é“¾æ¥ <span class="emphasis">_/&#125;</span>
<span class="emphasis">[<span class="string">ShineShao</span>](<span class="link">https://github.com/freeshineit</span>)</span>
<span class="emphasis"></span>
<span class="emphasis">&#123;/_</span> å›¾ç‰‡é“¾æ¥ <span class="emphasis">_/&#125;</span>
<span class="emphasis">[<span class="string">![ShineShao</span>](<span class="link">https://avatars2.githubusercontent.com/u/16034259?s=460&amp;u=7caff2589de5d263f44675662d8f1a5b91a1d706&amp;v=4</span>)](<span class="link">https://github.com/freeshineit</span>)</span></code></pre>

<p><a href="https://github.com/freeshineit">ShineShao</a></p>
<p><a href="https://github.com/freeshineit"><img src="https://avatars2.githubusercontent.com/u/16034259?s=460&u=7caff2589de5d263f44675662d8f1a5b91a1d706&v=4" alt="ShineShao"></a></p>
<h2 id="åˆ†å‰²çº¿"><a href="#åˆ†å‰²çº¿" class="headerlink" title="åˆ†å‰²çº¿"></a>åˆ†å‰²çº¿</h2><p>ä½¿ç”¨è‡³å°‘è¿ç»­çš„ä¸‰ä¸ª<code>-</code></p>
<pre><code class="highlight markdown">---</code></pre>

<hr>
<h2 id="åˆ é™¤çº¿"><a href="#åˆ é™¤çº¿" class="headerlink" title="åˆ é™¤çº¿"></a>åˆ é™¤çº¿</h2><p>ä½¿ç”¨<code>~~</code>è¿›è¡ŒåŒ…æ‹¬</p>
<pre><code class="highlight markdown">~~åˆ†å‰²çº¿~~</code></pre>

<p><del>åˆ†å‰²çº¿</del></p>
<h2 id="è¡¨æ ¼"><a href="#è¡¨æ ¼" class="headerlink" title="è¡¨æ ¼"></a>è¡¨æ ¼</h2><pre><code class="highlight markdown">| è¡¨å¤´     |   è¡¨å¤´   |     è¡¨å¤´ |
| :------- | :------: | -------: |
| å†…å®¹å±…å·¦ | å†…å®¹å±…ä¸­ | å†…å®¹å±…å³ |</code></pre>

<table>
<thead>
<tr>
<th align="left">è¡¨å¤´</th>
<th align="center">è¡¨å¤´</th>
<th align="right">è¡¨å¤´</th>
</tr>
</thead>
<tbody><tr>
<td align="left">å•å…ƒæ ¼</td>
<td align="center">å•å…ƒæ ¼</td>
<td align="right">å•å…ƒæ ¼å•å…ƒæ ¼å•å…ƒæ ¼å•å…ƒæ ¼</td>
</tr>
<tr>
<td align="left">å•å…ƒæ ¼</td>
<td align="center">å•å…ƒæ ¼å•å…ƒæ ¼å•å…ƒæ ¼å•å…ƒæ ¼</td>
<td align="right">å•å…ƒæ ¼</td>
</tr>
</tbody></table>
<h2 id="ä»£ç å—"><a href="#ä»£ç å—" class="headerlink" title="ä»£ç å—"></a>ä»£ç å—</h2><pre><code class="highlight go"><span class="keyword">package</span> main;

<span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span>;

<span class="function"><span class="keyword">func</span> <span class="title">main</span> <span class="params">()</span></span> &#123;
  fmt.Println(<span class="string">&quot;Hello World&quot;</span>)
&#125;</code></pre>

<h2 id="diff"><a href="#diff" class="headerlink" title="diff"></a>diff</h2><pre><code class="highlight diff"><span class="addition">+ 123</span>
<span class="deletion">- 123412</span></code></pre>

<h2 id="æ™®é€šæ–‡æœ¬"><a href="#æ™®é€šæ–‡æœ¬" class="headerlink" title="æ™®é€šæ–‡æœ¬"></a>æ™®é€šæ–‡æœ¬</h2><p>æ¯ä¸ªäººéƒ½ä¼šæœ‰ç¼ºé™·ï¼Œå°±åƒè¢«ä¸Šå¸å’¬è¿‡çš„è‹¹æœï¼Œæœ‰çš„äººç¼ºé™·æ¯”è¾ƒå¤§ï¼Œæ­£æ˜¯å› ä¸ºä¸Šå¸ç‰¹åˆ«å–œæ¬¢ä»–çš„èŠ¬èŠ³ã€‚</p>
<h2 id="checkbox"><a href="#checkbox" class="headerlink" title="checkbox"></a>checkbox</h2><pre><code class="highlight markdown"><span class="bullet">-</span> [ ] ä»»åŠ¡ä¸€ æœªåšä»»åŠ¡ <span class="code">`- + ç©ºæ ¼ + [ ]`</span>
<span class="bullet">-</span> [x] ä»»åŠ¡äºŒ å·²åšä»»åŠ¡ <span class="code">`- + ç©ºæ ¼ + [x]`</span></code></pre>

<ul>
<li><input disabled="" type="checkbox"> ä»»åŠ¡ä¸€ æœªåšä»»åŠ¡ <code>- + ç©ºæ ¼ + [ ]</code></li>
<li><input checked="" disabled="" type="checkbox"> ä»»åŠ¡äºŒ å·²åšä»»åŠ¡ <code>- + ç©ºæ ¼ + [x]</code></li>
</ul>
<h2 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h2><pre><code class="highlight markdown">[<span class="symbol">//</span>]: <span class="link"># &quot;æ³¨é‡Š&quot;</span></code></pre>

<h2 id="ç‰¹æ®Šå­—ç¬¦"><a href="#ç‰¹æ®Šå­—ç¬¦" class="headerlink" title="ç‰¹æ®Šå­—ç¬¦"></a>ç‰¹æ®Šå­—ç¬¦</h2><pre><code class="highlight markdown"><span class="literal">&amp;nbsp;</span> ç©ºæ ¼
<span class="literal">&amp;lt;</span> &lt;
<span class="literal">&amp;gt;</span> &gt;
<span class="literal">&amp;amp;</span> &amp;
<span class="literal">&amp;yen;</span> Â¥
<span class="literal">&amp;copy;</span> Â©
<span class="literal">&amp;reg;</span> Â®
<span class="literal">&amp;deg;</span>C Â°C
<span class="literal">&amp;plusmn;</span> Â±
<span class="literal">&amp;times;</span> Ã—
<span class="literal">&amp;divide;</span> Ã·
m<span class="literal">&amp;sup2;</span> mÂ²
m<span class="literal">&amp;sup3;</span> mÂ³</code></pre>

<p>&nbsp;<br>&lt;<br>&gt;<br>&amp;<br>&yen;<br>&copy;<br>&reg;<br>&deg;C<br>&plusmn;<br>&times;<br>&divide;<br>m&sup2;<br>m&sup3;</p>
<h2 id="details"><a href="#details" class="headerlink" title="details"></a>details</h2><pre><code class="highlight markdown"><span class="language-xml"><span class="tag">&lt;<span class="name">details</span>&gt;</span></span>
  <span class="language-xml"><span class="tag">&lt;<span class="name">summary</span>&gt;</span></span>å±•å¼€<span class="language-xml"><span class="tag">&lt;/<span class="name">summary</span>&gt;</span></span>
  Something small enough to escape casual notice.
<span class="language-xml"><span class="tag">&lt;/<span class="name">details</span>&gt;</span></span></code></pre>

<details>
  <summary>å±•å¼€</summary>
  Something small enough to escape casual notice.
</details>

<h2 id="è¡¨æƒ…"><a href="#è¡¨æƒ…" class="headerlink" title="è¡¨æƒ…"></a>è¡¨æƒ…</h2><pre><code class="highlight markdown">ğŸ¶ ğŸ‘
ğŸ˜ ğŸ”•</code></pre>

<p>ğŸ¶ ğŸ‘<br>ğŸ˜ ğŸ”•</p>
<h2 id="è„šæ³¨"><a href="#è„šæ³¨" class="headerlink" title="è„šæ³¨"></a>è„šæ³¨</h2><pre><code class="highlight markdown">ä½¿ç”¨ <span class="code">`Markdown`</span>[^1]å¯ä»¥æ•ˆç‡çš„ä¹¦å†™æ–‡æ¡£, ç›´æ¥è½¬æ¢æˆ <span class="code">`HTML`</span>[^2], ä½ å¯ä»¥ä½¿ç”¨ <span class="code">`Typora`</span>[^t] ç¼–è¾‘å™¨è¿›è¡Œä¹¦å†™ã€‚

[<span class="symbol">^1</span>]: <span class="link">Markdown æ˜¯ä¸€ç§çº¯æ–‡æœ¬æ ‡è®°è¯­è¨€</span>
[<span class="symbol">^2</span>]: <span class="link">HyperText Markup Language è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€</span>
[<span class="string">^t</span>]: [<span class="string">NEW WAY TO READ &amp; WRITE MARKDOWN.</span>](<span class="link">https://www.baidu.com</span>)</code></pre>

<p>ä½¿ç”¨ <code>Markdown</code>[^1]å¯ä»¥æ•ˆç‡çš„ä¹¦å†™æ–‡æ¡£, ç›´æ¥è½¬æ¢æˆ <code>HTML</code>[^2], ä½ å¯ä»¥ä½¿ç”¨ <code>Typora</code>[^t] ç¼–è¾‘å™¨è¿›è¡Œä¹¦å†™ã€‚</p>
<p>[^1]: Markdown æ˜¯ä¸€ç§çº¯æ–‡æœ¬æ ‡è®°è¯­è¨€<br>[^2]: HyperText Markup Language è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€<br>[^t]: <a href="https://www.baidu.com/">NEW WAY TO READ &amp; WRITE MARKDOWN.</a></p>
<p><a href="LICENSE">MIT</a> Â© <a href="https://github.com/freeshineit">ShineShao</a></p>
]]></content>
      <categories>
        <category>Markdown</category>
      </categories>
      <tags>
        <tag>Markdown</tag>
      </tags>
  </entry>
  <entry>
    <title>Sass è¯­æ³•</title>
    <url>/2022/10/08/css/scss/</url>
    <content><![CDATA[<h2 id="each-ä½¿ç”¨è¯´æ˜"><a href="#each-ä½¿ç”¨è¯´æ˜" class="headerlink" title="@each ä½¿ç”¨è¯´æ˜"></a><code>@each</code> ä½¿ç”¨è¯´æ˜</h2><p>The <a href="https://sass-lang.com/documentation/at-rules/control/each">@each</a> rule makes it easy to emit styles or evaluate code for each element of a list or each pair in a map. Itâ€™s great for repetitive styles that only have a few variations between them. Itâ€™s usually written</p>
<h2 id="code"><a href="#code" class="headerlink" title="code"></a>code</h2><pre><code class="highlight scss"><span class="variable">$sizes</span>: <span class="number">40px</span>, <span class="number">50px</span>, <span class="number">80px</span>;
<span class="keyword">@each</span> <span class="variable">$size</span> in <span class="variable">$sizes</span> &#123;
  <span class="selector-class">.icon-</span>#&#123;<span class="variable">$size</span>&#125; &#123;
    <span class="attribute">font-size</span>: <span class="variable">$size</span>;
    <span class="attribute">height</span>: <span class="variable">$size</span>;
    <span class="attribute">width</span>: <span class="variable">$size</span>;
  &#125;
&#125;

# result <span class="selector-class">.icon-40px</span> &#123;
  <span class="attribute">font-size</span>: <span class="number">40px</span>;
  <span class="attribute">height</span>: <span class="number">40px</span>;
  <span class="attribute">width</span>: <span class="number">40px</span>;
&#125;

<span class="selector-class">.icon-50px</span> &#123;
  <span class="attribute">font-size</span>: <span class="number">50px</span>;
  <span class="attribute">height</span>: <span class="number">50px</span>;
  <span class="attribute">width</span>: <span class="number">50px</span>;
&#125;

<span class="selector-class">.icon-80px</span> &#123;
  <span class="attribute">font-size</span>: <span class="number">80px</span>;
  <span class="attribute">height</span>: <span class="number">80px</span>;
  <span class="attribute">width</span>: <span class="number">80px</span>;
&#125;</code></pre>

<pre><code class="highlight scss"><span class="comment">// æ•°ç»„</span>
<span class="variable">$countries</span>: ((ad, <span class="number">376</span>), (ae, <span class="number">971</span>)), ((az, <span class="number">994</span>), (ba, <span class="number">387</span>));
<span class="variable">$offset</span>: -<span class="number">32px</span>;

<span class="keyword">@each</span> <span class="variable">$arr</span> in <span class="variable">$countries</span> &#123;
  <span class="comment">// get index (form 1)</span>
  <span class="variable">$i</span>: <span class="built_in">index</span>(<span class="variable">$countries</span>, <span class="variable">$arr</span>); <span class="comment">// =&gt; number | null</span>

  <span class="keyword">@each</span> <span class="variable">$c</span> in <span class="variable">$arr</span> &#123;
    <span class="variable">$j</span>: <span class="built_in">index</span>(<span class="variable">$arr</span>, <span class="variable">$c</span>);

    <span class="selector-class">.flag</span><span class="selector-class">.flag-</span>#&#123;<span class="built_in">nth</span>($c, <span class="number">1</span>)&#125; &#123;
      <span class="attribute">background-position</span>: <span class="variable">$offset</span> * (<span class="variable">$j</span> - <span class="number">1</span>) <span class="variable">$offset</span> * (<span class="variable">$i</span> - <span class="number">1</span>);
    &#125;
  &#125;
&#125;

# result <span class="selector-class">.flag</span><span class="selector-class">.flag-ad</span> &#123;
  <span class="attribute">background-position</span>: <span class="number">0px</span> <span class="number">0px</span>;
&#125;
<span class="selector-class">.flag</span><span class="selector-class">.flag-ae</span> &#123;
  <span class="attribute">background-position</span>: -<span class="number">32px</span> <span class="number">0px</span>;
&#125;
<span class="selector-class">.flag</span><span class="selector-class">.flag-az</span> &#123;
  <span class="attribute">background-position</span>: <span class="number">0px</span> -<span class="number">32px</span>;
&#125;
<span class="selector-class">.flag</span><span class="selector-class">.flag-ba</span> &#123;
  <span class="attribute">background-position</span>: -<span class="number">32px</span> -<span class="number">32px</span>;
&#125;</code></pre>]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>Sass</tag>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>Git å¸¸ç”¨å‘½ä»¤</title>
    <url>/2023/02/18/git/antic/</url>
    <content><![CDATA[<h1 id="shell"><a href="#shell" class="headerlink" title="shell"></a>shell</h1><pre><code class="highlight shell"><span class="meta prompt_"># </span><span class="language-bash">rebase</span>
git rebase master
<span class="meta prompt_"></span>
<span class="meta prompt_"># </span><span class="language-bash">è§£å†³å†²çªå</span>
git add .
<span class="meta prompt_"></span>
<span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">continue</span></span>
git rebase --continue</code></pre>

<pre><code class="highlight shell"><span class="meta prompt_"># </span><span class="language-bash">discard ä¸¢å¼ƒç¼“å­˜</span>
git reset HEAD
<span class="meta prompt_"></span>
<span class="meta prompt_"># </span><span class="language-bash">ä¸¢å¼ƒæŒ‡å®šæ–‡ä»¶ç¼“å­˜</span>
git reset HEAD &lt;file&gt;
<span class="meta prompt_"></span>
<span class="meta prompt_"># </span><span class="language-bash">æ’¤é”€æœ€æ–°çš„commit</span>
git reset HEAD^
<span class="meta prompt_"></span>
<span class="meta prompt_"># </span><span class="language-bash">ä¿®æ”¹æœ€æ–°çš„ä¸€æ¬¡commit æ—¥å¿—</span>
git commit --amend
<span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># æˆ–è€…ä½¿ç”¨åˆ«å</span></span>
git ca
</code></pre>

<h3 id="ä½¿ç”¨-æ‰§è¡Œå¤šæ¡å‘½ä»¤"><a href="#ä½¿ç”¨-æ‰§è¡Œå¤šæ¡å‘½ä»¤" class="headerlink" title="ä½¿ç”¨; æ‰§è¡Œå¤šæ¡å‘½ä»¤"></a>ä½¿ç”¨<code>;</code> æ‰§è¡Œå¤šæ¡å‘½ä»¤</h3><pre><code class="highlight shell">git add .; git status</code></pre>

<h3 id="é…ç½®å‘½ä»¤åˆ«åï¼ˆAliasesï¼‰"><a href="#é…ç½®å‘½ä»¤åˆ«åï¼ˆAliasesï¼‰" class="headerlink" title="é…ç½®å‘½ä»¤åˆ«åï¼ˆAliasesï¼‰"></a>é…ç½®å‘½ä»¤åˆ«åï¼ˆ<a href="https://git-scm.com/book/zh-tw/v2/Git-%E5%9F%BA%E7%A4%8E-Git-Aliases">Aliases</a>ï¼‰</h3><p>git é»˜è®¤é…ç½®äº†éƒ¨åˆ†åˆ«åï¼Œå¯ä»¥ä½¿ç”¨<code>git config --list</code> æŸ¥çœ‹</p>
<pre><code class="highlight bash"><span class="comment"># git commit -m</span>
<span class="comment"># git config --global alias.cm commit -m</span>
git cm

<span class="comment"># git log --stat --abbrev-commit</span>
<span class="comment"># git config --global alias.ll log --stat --abbrev-commit</span>
git ll

<span class="comment"># git diff</span>
<span class="comment"># git config --global alias.d diff</span>
git d</code></pre>

<p>é…ç½®åˆ«åå‘½ä»¤</p>
<pre><code class="highlight bash"><span class="comment"># é…ç½®åˆ«åå‘½ä»¤</span>
git config --global alias.st status

<span class="comment"># ä½¿ç”¨ git st ç›¸å½“äº git status</span>
git st</code></pre>

<p>git log åˆ«åé…ç½®</p>
<pre><code class="highlight bash"><span class="comment"># git l</span>
git config --global alias.l <span class="string">&quot;log --graph --all --pretty=format:&#x27;%C(yellow)%h%C(cyan)%d%Creset %s %C(white)- %an, %ar%Creset&#x27;&quot;</span>

<span class="comment"># git ll</span>
git config --global alias.ll <span class="string">&quot;log --stat --abbrev-commit&quot;</span>

<span class="comment"># git lg</span>
git config --global alias.lg <span class="string">&quot;log --color --graph --pretty=format:&#x27;%C(bold white)%h%Creset -%C(bold green)%d%Creset %s %C(bold green)(%cr)%Creset %C(bold blue)&lt;%an&gt;%Creset&#x27; --abbrev-commit --date=relative&quot;</span>

<span class="comment"># git llg</span>
git config --global alias.llg <span class="string">&quot;log --color --graph --pretty=format:&#x27;%C(bold white)%H %d%Creset%n%s%n%+b%C(bold blue)%an &lt;%ae&gt;%Creset %C(bold green)%cr (%ci)&#x27; --abbrev-commit&quot;</span></code></pre>
]]></content>
      <categories>
        <category>git</category>
      </categories>
      <tags>
        <tag>Git</tag>
        <tag>Tool</tag>
      </tags>
  </entry>
  <entry>
    <title>Golang Sync</title>
    <url>/2023/02/18/golang/sync/</url>
    <content><![CDATA[<h2 id="golang-goroutine-åŒæ­¥æ“ä½œ"><a href="#golang-goroutine-åŒæ­¥æ“ä½œ" class="headerlink" title="golang goroutine åŒæ­¥æ“ä½œ"></a>golang goroutine åŒæ­¥æ“ä½œ</h2><h3 id="sync-WaitGroup"><a href="#sync-WaitGroup" class="headerlink" title="sync.WaitGroup"></a><a href="https://golang.org/pkg/sync/#WaitGroup">sync.WaitGroup</a></h3><pre><code class="highlight go"><span class="keyword">package</span> main

<span class="keyword">import</span> (
	<span class="string">&quot;fmt&quot;</span>
	<span class="string">&quot;sync&quot;</span>
	<span class="string">&quot;time&quot;</span>
)

<span class="function"><span class="keyword">func</span> <span class="title">worker</span><span class="params">(i <span class="type">int</span>, wg *sync.WaitGroup)</span></span> &#123;
	fmt.Printf(<span class="string">&quot;sync worker %d starting\n&quot;</span>, i)
	time.Sleep(time.Second)
	fmt.Printf(<span class="string">&quot;sync worker %d done\n&quot;</span>, i)
	<span class="keyword">defer</span> wg.Done()
&#125;

<span class="comment">// sync.WaitGroup</span>
<span class="function"><span class="keyword">func</span> <span class="title">SyncWaitGroup</span><span class="params">()</span></span> &#123;
	<span class="keyword">var</span> wg sync.WaitGroup
	fmt.Println(<span class="string">&quot;this is SyncWaitGroup func&quot;</span>)
	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++ &#123;
		<span class="comment">// åˆ›å»º10ä¸ª goroutine</span>
		wg.Add(<span class="number">1</span>)
		<span class="keyword">go</span> worker(i, &amp;wg)
	&#125;
	wg.Wait()
&#125;
</code></pre>

<h3 id="Channel"><a href="#Channel" class="headerlink" title="Channel"></a><a href="https://blog.golang.org/pipelines">Channel</a></h3><pre><code class="highlight go"><span class="keyword">package</span> main

<span class="keyword">import</span> (
	<span class="string">&quot;fmt&quot;</span>
	<span class="string">&quot;time&quot;</span>
)

<span class="function"><span class="keyword">func</span> <span class="title">chanWorker</span><span class="params">(i <span class="type">int</span>, done <span class="keyword">chan</span> <span class="type">int</span>)</span></span> &#123;
	fmt.Printf(<span class="string">&quot;chan worker %d starting\n&quot;</span>, i)
	time.Sleep(time.Second)
	fmt.Printf(<span class="string">&quot;chan worker %d done\n&quot;</span>, i)
	done &lt;- i
&#125;

<span class="comment">// chan</span>
<span class="function"><span class="keyword">func</span> <span class="title">Channel</span><span class="params">()</span></span> &#123;
	c := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>)
	fmt.Println(<span class="string">&quot;this is Channel func&quot;</span>)
	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++ &#123;
		<span class="comment">// åˆ›å»º10ä¸ª goroutine</span>
		<span class="keyword">go</span> chanWorker(i, c)
	&#125;
	&lt;-c
&#125;
</code></pre>
]]></content>
      <categories>
        <category>Golang</category>
      </categories>
      <tags>
        <tag>Golang</tag>
        <tag>goroutine</tag>
        <tag>channel</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸‹è½½githubä¸Šé¡¹ç›®æŒ‡å®šçš„æ–‡ä»¶å¤¹</title>
    <url>/2022/02/09/github/download/</url>
    <content><![CDATA[<h2 id="node-å®ç°ä¸‹è½½æŒ‡å®šæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹"><a href="#node-å®ç°ä¸‹è½½æŒ‡å®šæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹" class="headerlink" title="node å®ç°ä¸‹è½½æŒ‡å®šæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹"></a>node å®ç°ä¸‹è½½æŒ‡å®šæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹</h2><p><a href="https://github.com/qqxs/got-github-examples">got-github-examples</a></p>
<ol>
<li>åˆ›å»ºå­˜å‚¨çš„æ–‡ä»¶å¤¹</li>
</ol>
<pre><code class="highlight ts"><span class="keyword">import</span> fs <span class="keyword">from</span> <span class="string">&quot;fs&quot;</span>;

<span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">makeDir</span>(<span class="params"></span>
<span class="params">  <span class="attr">root</span>: <span class="built_in">string</span>,</span>
<span class="params">  options = &#123; recursive: <span class="literal">true</span> &#125;</span>
<span class="params"></span>): <span class="title class_">Promise</span>&lt;<span class="built_in">string</span> | <span class="literal">undefined</span>&gt; &#123;
  <span class="keyword">return</span> fs.<span class="property">promises</span>.<span class="title function_">mkdir</span>(root, options);
&#125;</code></pre>

<ol start="2">
<li>ä¸‹è½½æŒ‡å®šçš„æ–‡ä»¶å¤¹æˆ–æ–‡ä»¶</li>
</ol>
<pre><code class="highlight ts"><span class="keyword">import</span> got <span class="keyword">from</span> <span class="string">&quot;got&quot;</span>;
<span class="keyword">import</span> tar <span class="keyword">from</span> <span class="string">&quot;tar&quot;</span>;
<span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&quot;path&quot;</span>;
<span class="keyword">import</span> &#123; <span class="title class_">Stream</span> &#125; <span class="keyword">from</span> <span class="string">&quot;stream&quot;</span>;
<span class="keyword">import</span> &#123; promisify &#125; <span class="keyword">from</span> <span class="string">&quot;util&quot;</span>;
<span class="keyword">import</span> &#123; makeDir &#125; <span class="keyword">from</span> <span class="string">&quot;./make-dir&quot;</span>;

<span class="keyword">const</span> pipeline = <span class="title function_">promisify</span>(<span class="title class_">Stream</span>.<span class="property">pipeline</span>);

<span class="comment">// tar extract å†…å®¹æ”¾ç½®çš„è·¯å¾„</span>
<span class="keyword">const</span> root = path.<span class="title function_">resolve</span>(<span class="string">&quot;data-fetch-app&quot;</span>);

<span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">downloadExample</span>(<span class="params"></span>) &#123;
  <span class="keyword">await</span> <span class="title function_">makeDir</span>(root);
  process.<span class="title function_">chdir</span>(root);
  <span class="keyword">return</span> <span class="title function_">pipeline</span>(
    got.<span class="title function_">stream</span>(
      <span class="comment">// `https://codeload.github.com/$&#123;user&#125;/$&#123;repo&#125;/tar.gz/$&#123;branch&#125;`</span>
      <span class="comment">// example</span>
      <span class="string">`https://codeload.github.com/qqxs/got-github-examples/tar.gz/main`</span>
    ),
    tar.<span class="title function_">extract</span>(
      &#123;
        <span class="attr">cwd</span>: root,
        <span class="attr">strip</span>: <span class="number">3</span> <span class="comment">// å±‚çº§</span>
      &#125;,
      <span class="comment">// [`$&#123;repo&#125;-$&#123;branch&#125;/$&#123;examplePath&#125;`]</span>
      <span class="comment">// example</span>
      [<span class="string">`got-github-examples-main/examples/example01`</span>]
    )
  );
&#125;

<span class="title function_">downloadExample</span>();</code></pre>

<ol start="3">
<li>æ‰§è¡Œ</li>
</ol>
<pre><code class="highlight bash">ts-node index.ts</code></pre>

<h2 id="curl-å®ç°ä¸‹è½½æŒ‡å®šæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹"><a href="#curl-å®ç°ä¸‹è½½æŒ‡å®šæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹" class="headerlink" title="curl å®ç°ä¸‹è½½æŒ‡å®šæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹"></a>curl å®ç°ä¸‹è½½æŒ‡å®šæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹</h2><pre><code class="highlight bash"><span class="comment"># mkdir my-app &amp;&amp; curl https://codeload.github.com/[user]/[repo]/tar.gz/[branch] | tar -xz -C my-app --strip=2 [repo]-[branch]/[examplePath]</span>
<span class="comment"># ä¸‹è½½githubä¸Š`freeshineit/next-examples`çš„ mainåˆ†æ”¯ä¸‹ `with-typescript-eslint-jest-app` æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹</span>
<span class="built_in">mkdir</span> my-app &amp;&amp; curl https://codeload.github.com/freeshineit/next-examples/tar.gz/main | tar -xz -C my-app --strip=2 next-examples-main/with-typescript-eslint-jest-app</code></pre>
]]></content>
      <categories>
        <category>Github</category>
      </categories>
      <tags>
        <tag>Github</tag>
        <tag>got</tag>
      </tags>
  </entry>
  <entry>
    <title>Gulp æºç åˆ†æ</title>
    <url>/2022/11/28/gulp/source/</url>
    <content><![CDATA[<h2 id="Gulp"><a href="#Gulp" class="headerlink" title="Gulp"></a>Gulp</h2><pre><code class="highlight js"><span class="meta">&quot;use strict&quot;</span>;

<span class="keyword">var</span> util = <span class="built_in">require</span>(<span class="string">&quot;util&quot;</span>);
<span class="comment">// https://www.npmjs.com/package/undertaker</span>
<span class="comment">// undertakerç±»æä¾›äº†taskï¼Œseriesï¼Œparallelï¼Œgetï¼Œsetï¼Œtreeå’Œregistryæ–¹æ³•</span>
<span class="comment">// undertakerç±»ç»§æ‰¿äºnodeæ ¸å¿ƒç±»eventemitter</span>
<span class="keyword">var</span> <span class="title class_">Undertaker</span> = <span class="built_in">require</span>(<span class="string">&quot;undertaker&quot;</span>);
<span class="comment">// https://www.npmjs.com/package/vinyl-fs</span>
<span class="comment">// vinylæ˜¯vitual file formateè™šæ‹Ÿæ–‡ä»¶æ ¼å¼ï¼Œç”¨äºæè¿°ä¸€ä¸ªæ–‡ä»¶ã€‚</span>
<span class="comment">// å®ƒæœ‰ä¸¤ä¸ªä¸»è¦çš„å±æ€§ï¼Œpathå±æ€§å’Œcontentså±æ€§ã€‚æ¯ä¸€ä¸ªVinylå®ä¾‹ä»£è¡¨ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ã€ç›®å½•æˆ–è€…symlinkç¬¦å·è¿æ¥ã€‚</span>
<span class="keyword">var</span> vfs = <span class="built_in">require</span>(<span class="string">&quot;vinyl-fs&quot;</span>);
<span class="comment">// https://www.npmjs.com/package/glob-watcher</span>
<span class="comment">// è§‚å¯Ÿglobså¹¶åœ¨æ›´æ”¹æ—¶æ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä½¿ç”¨æ™ºèƒ½é»˜è®¤å€¼å–æ¶ˆç»‘å®šå’Œæ’é˜Ÿã€‚</span>
<span class="keyword">var</span> watch = <span class="built_in">require</span>(<span class="string">&quot;glob-watcher&quot;</span>);

<span class="keyword">function</span> <span class="title function_">Gulp</span>(<span class="params"></span>) &#123;
  <span class="comment">// æ”¹å˜Undertakerçš„this æŒ‡å‘ï¼ŒæŒ‡å‘Gulp</span>
  <span class="title class_">Undertaker</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>);

  <span class="comment">// Bind the functions for destructuring</span>
  <span class="variable language_">this</span>.<span class="property">watch</span> = <span class="variable language_">this</span>.<span class="property">watch</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);
  <span class="comment">// ä»»åŠ¡ã€‚ ç”±undertakerç±»æä¾›</span>
  <span class="variable language_">this</span>.<span class="property">task</span> = <span class="variable language_">this</span>.<span class="property">task</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);
  <span class="comment">// ä»»åŠ¡é¡ºåºä¾æ¬¡æ‰§è¡Œã€‚ ç”±undertakerç±»æä¾›</span>
  <span class="variable language_">this</span>.<span class="property">series</span> = <span class="variable language_">this</span>.<span class="property">series</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);
  <span class="comment">// å°†ä»»åŠ¡åŠŸèƒ½æˆ–ç»„åˆæ“ä½œç»„åˆæˆå¹¶è¡Œæ‰§è¡Œçš„è¾ƒå¤§æ“ä½œã€‚ ç”±undertakerç±»æä¾›</span>
  <span class="variable language_">this</span>.<span class="property">parallel</span> = <span class="variable language_">this</span>.<span class="property">parallel</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);
  <span class="comment">// https://www.gulpjs.com.cn/docs/api/registry/</span>
  <span class="comment">// å…è®¸å°†è‡ªå®šä¹‰çš„æ³¨å†Œè¡¨æ’å…¥åˆ°ä»»åŠ¡ç³»ç»Ÿä¸­ï¼Œä»¥æœŸæä¾›å…±äº«ä»»åŠ¡æˆ–å¢å¼ºåŠŸèƒ½ã€‚</span>
  <span class="comment">// ç”±undertakerç±»æä¾›</span>
  <span class="variable language_">this</span>.<span class="property">registry</span> = <span class="variable language_">this</span>.<span class="property">registry</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);
  <span class="comment">// è·å–å½“å‰ä»»åŠ¡ä¾èµ–å…³ç³»æ ‘ã€‚ ç”±undertakerç±»æä¾›</span>
  <span class="variable language_">this</span>.<span class="property">tree</span> = <span class="variable language_">this</span>.<span class="property">tree</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);
  <span class="comment">// ç”±undertakerç±»æä¾›</span>
  <span class="variable language_">this</span>.<span class="property">lastRun</span> = <span class="variable language_">this</span>.<span class="property">lastRun</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);
  <span class="comment">// åˆ›å»ºä¸€ä¸ªæµï¼Œç”¨äºä»æ–‡ä»¶ç³»ç»Ÿè¯»å– Vinyl å¯¹è±¡ã€‚ç”± vinyl-fs æä¾›</span>
  <span class="variable language_">this</span>.<span class="property">src</span> = <span class="variable language_">this</span>.<span class="property">src</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);
  <span class="comment">// åˆ›å»ºä¸€ä¸ªç”¨äºå°† Vinyl å¯¹è±¡å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„æµã€‚ç”± vinyl-fs æä¾›</span>
  <span class="variable language_">this</span>.<span class="property">dest</span> = <span class="variable language_">this</span>.<span class="property">dest</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);
  <span class="comment">// ç¬¦å·é“¾æ¥ã€‚ ç”± vinyl-fs æä¾›</span>
  <span class="variable language_">this</span>.<span class="property">symlink</span> = <span class="variable language_">this</span>.<span class="property">symlink</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);
&#125;

<span class="comment">// https://nodejs.org/docs/latest/api/util.html#utilinheritsconstructor-superconstructor</span>
<span class="comment">// ç»§æ‰¿</span>
<span class="comment">// å·²ç»ä¸å»ºè®®ä½¿ç”¨äº†ï¼Œ æœ€å¥½ä½¿ç”¨es6çš„ç»§æ‰¿æ–¹å¼  extends</span>
util.<span class="title function_">inherits</span>(<span class="title class_">Gulp</span>, <span class="title class_">Undertaker</span>);

<span class="comment">// https://www.npmjs.com/package/vinyl-fs#options</span>
<span class="comment">// vfs.src(globs[, options])</span>
<span class="title class_">Gulp</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">src</span> = vfs.<span class="property">src</span>;
<span class="comment">// https://www.npmjs.com/package/vinyl-fs#destfolder-options</span>
<span class="comment">// vfs.dest(folder[, options])</span>
<span class="comment">// å°†æ–‡ä»¶å¤¹è·¯å¾„å­—ç¬¦ä¸²æˆ–å‡½æ•°ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå°†é€‰é¡¹å¯¹è±¡ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ã€‚</span>
<span class="comment">// å¦‚æœç»™å®šä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå°†ä¸æ¯ä¸ªvinyl Fileå¯¹è±¡ä¸€èµ·è°ƒç”¨ï¼Œå¹¶ä¸”å¿…é¡»è¿”å›æ–‡ä»¶å¤¹è·¯å¾„ã€‚</span>
<span class="comment">// è¿”å›ä¸€ä¸ªæµï¼Œè¯¥æµæ¥å—vinyl Fileå¯¹è±¡ï¼Œå°†å®ƒä»¬å†™å…¥æŒ‡å®šæ–‡ä»¶å¤¹/cwdä¸­çš„ç£ç›˜ï¼Œå¹¶å°†å®ƒä»¬ä¼ é€’åˆ°ä¸‹æ¸¸ï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥ç»§ç»­ä½¿ç”¨ç®¡é“ã€‚</span>
<span class="comment">// ä¸€æ—¦æ–‡ä»¶å†™å…¥ç£ç›˜åï¼Œå°†å°è¯•ç¡®å®švinyl Fileå¯¹è±¡çš„`stat.mode`ã€`stat.mtime`å’Œ`stat.atime`æ˜¯å¦ä¸æ–‡ä»¶ç³»ç»Ÿä¸Šçš„æ–‡ä»¶ä¸åŒã€‚</span>
<span class="comment">// å¦‚æœå®ƒä»¬ä¸åŒï¼Œå¹¶ä¸”æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹æ‹¥æœ‰è¯¥æ–‡ä»¶ï¼Œåˆ™ä¼šæ›´æ–°ç›¸åº”çš„æ–‡ä»¶ç³»ç»Ÿå…ƒæ•°æ®ã€‚</span>
<span class="comment">// å¦‚æœå®ƒä»¬æ²¡æœ‰å·®å¼‚æˆ–è¿›ç¨‹ä¸æ‹¥æœ‰æ–‡ä»¶ï¼Œåˆ™ä¼šè‡ªåŠ¨è·³è¿‡å°è¯•ã€‚</span>
<span class="comment">// å¦‚æœæ–‡ä»¶å…·æœ‰æŒ‡å®šç›®æ ‡è·¯å¾„çš„`symlink`å±æ€§ï¼Œåˆ™å°†åˆ›å»º`symlink`ã€‚</span>
<span class="title class_">Gulp</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">dest</span> = vfs.<span class="property">dest</span>;

<span class="comment">// https://www.npmjs.com/package/vinyl-fs#symlinkfolder-options</span>
<span class="comment">// vfs.symlink(folder[, options])</span>
<span class="comment">// å°†æ–‡ä»¶å¤¹è·¯å¾„å­—ç¬¦ä¸²æˆ–å‡½æ•°ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå°†é€‰é¡¹å¯¹è±¡ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ã€‚</span>
<span class="comment">// å¦‚æœç»™å®šä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå°†ä¸æ¯ä¸ªvinyl Fileå¯¹è±¡ä¸€èµ·è°ƒç”¨ï¼Œå¹¶ä¸”å¿…é¡»è¿”å›æ–‡ä»¶å¤¹è·¯å¾„ã€‚</span>
<span class="comment">// è¿”å›ä¸€ä¸ªæµï¼Œè¯¥æµæ¥å—vinyl Fileå¯¹è±¡ï¼Œåœ¨æŒ‡å®šçš„æ–‡ä»¶å¤¹/cwdå¤„åˆ›å»ºä¸€ä¸ª`symlink`ï¼Œå¹¶å°†å…¶ä¼ é€’åˆ°ä¸‹æ¸¸ï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥ç»§ç»­ä½¿ç”¨ç®¡é“ä¼ é€’è¿™äº›å¯¹è±¡ã€‚</span>
<span class="title class_">Gulp</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">symlink</span> = vfs.<span class="property">symlink</span>;
<span class="comment">// åœ¨ `glob-watcher` å‰åšæ ¡éªŒå’Œå…¼å®¹</span>
<span class="comment">//</span>
<span class="title class_">Gulp</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">watch</span> = <span class="keyword">function</span> (<span class="params">glob, opt, task</span>) &#123;
  <span class="keyword">if</span> (
    <span class="keyword">typeof</span> opt === <span class="string">&quot;string&quot;</span> ||
    <span class="keyword">typeof</span> task === <span class="string">&quot;string&quot;</span> ||
    <span class="title class_">Array</span>.<span class="title function_">isArray</span>(opt) ||
    <span class="title class_">Array</span>.<span class="title function_">isArray</span>(task)
  ) &#123;
    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(
      <span class="string">&quot;watching &quot;</span> +
        glob +
        <span class="string">&quot;: watch task has to be &quot;</span> +
        <span class="string">&quot;a function (optionally generated by using gulp.parallel &quot;</span> +
        <span class="string">&quot;or gulp.series)&quot;</span>
    );
  &#125;

  <span class="keyword">if</span> (<span class="keyword">typeof</span> opt === <span class="string">&quot;function&quot;</span>) &#123;
    task = opt;
    opt = &#123;&#125;;
  &#125;

  opt = opt || &#123;&#125;;

  <span class="keyword">var</span> fn;
  <span class="keyword">if</span> (<span class="keyword">typeof</span> task === <span class="string">&quot;function&quot;</span>) &#123;
    fn = <span class="variable language_">this</span>.<span class="title function_">parallel</span>(task);
  &#125;

  <span class="comment">// watch() æ–¹æ³•æ—¶é€šè¿‡ `events` å‚æ•°è¿›è¡ŒæŒ‡å®šã€‚</span>
  <span class="comment">// å¯ç”¨çš„äº‹ä»¶æœ‰ &#x27;add&#x27;ã€&#x27;addDir&#x27;ã€&#x27;change&#x27;ã€&#x27;unlink&#x27;ã€&#x27;unlinkDir&#x27;ã€&#x27;ready&#x27;ã€&#x27;error&#x27;ã€‚</span>
  <span class="comment">// æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ª &#x27;all&#x27; äº‹ä»¶ï¼Œå®ƒè¡¨ç¤ºé™¤ &#x27;ready&#x27; å’Œ &#x27;error&#x27; ä¹‹å¤–çš„æ‰€æœ‰äº‹ä»¶ã€‚</span>
  <span class="keyword">return</span> <span class="title function_">watch</span>(glob, opt, fn);
&#125;;

<span class="comment">// Let people use this class from our instance</span>
<span class="title class_">Gulp</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">Gulp</span> = <span class="title class_">Gulp</span>;
<span class="comment">// Gulp å®ä¾‹</span>
<span class="keyword">var</span> inst = <span class="keyword">new</span> <span class="title class_">Gulp</span>();
<span class="variable language_">module</span>.<span class="property">exports</span> = inst;</code></pre>
]]></content>
      <categories>
        <category>Gulp</category>
      </categories>
      <tags>
        <tag>Tool</tag>
        <tag>Gulp</tag>
      </tags>
  </entry>
  <entry>
    <title>javascript apply,callå’Œbind</title>
    <url>/2022/10/26/js/apply_call_bind/</url>
    <content><![CDATA[<h2 id="apply-åŸç†"><a href="#apply-åŸç†" class="headerlink" title="apply åŸç†"></a>apply åŸç†</h2><p><a href="">apply</a> xxxx</p>
<h2 id="apply-å®ç°"><a href="#apply-å®ç°" class="headerlink" title="apply å®ç°"></a>apply å®ç°</h2><pre><code class="highlight ts"><span class="comment">/**</span>
<span class="comment"> *</span>
<span class="comment"> */</span>
<span class="keyword">function</span> <span class="title function_">_apply</span>(<span class="params"><span class="attr">_this</span>: <span class="built_in">any</span>, <span class="attr">args</span>: <span class="built_in">any</span>[]</span>) &#123;&#125;

(<span class="keyword">function</span> (<span class="params"></span>) &#123;
  <span class="comment">// npx ts-node app/typeof.ts</span>
  <span class="comment">// å¦‚æœæœ‰é”™ ä¼šæœ‰æ‰“å°</span>
  <span class="keyword">const</span> assert = <span class="built_in">require</span>(<span class="string">&quot;assert&quot;</span>);
&#125;)();</code></pre>

<h2 id="call-åŸç†"><a href="#call-åŸç†" class="headerlink" title="call åŸç†"></a>call åŸç†</h2><p><a href="">call</a> xxxx</p>
<h2 id="call-å®ç°"><a href="#call-å®ç°" class="headerlink" title="call å®ç°"></a>call å®ç°</h2><pre><code class="highlight ts"><span class="comment">/**</span>
<span class="comment"> *</span>
<span class="comment"> */</span>
<span class="keyword">function</span> <span class="title function_">_call</span>(<span class="params"><span class="attr">_this</span>: <span class="built_in">any</span>, ...<span class="attr">args</span>: <span class="built_in">any</span>[]</span>) &#123;&#125;

(<span class="keyword">function</span> (<span class="params"></span>) &#123;
  <span class="comment">// npx ts-node app/typeof.ts</span>
  <span class="comment">// å¦‚æœæœ‰é”™ ä¼šæœ‰æ‰“å°</span>
  <span class="keyword">const</span> assert = <span class="built_in">require</span>(<span class="string">&quot;assert&quot;</span>);
&#125;)();</code></pre>

<h2 id="bind-åŸç†"><a href="#bind-åŸç†" class="headerlink" title="bind åŸç†"></a>bind åŸç†</h2><p><a href="">bind</a> xxxx</p>
<h2 id="bind-å®ç°"><a href="#bind-å®ç°" class="headerlink" title="bind å®ç°"></a>bind å®ç°</h2><pre><code class="highlight ts"><span class="comment">/**</span>
<span class="comment"> *</span>
<span class="comment"> */</span>
<span class="keyword">function</span> <span class="title function_">_bind</span>(<span class="params"><span class="attr">_this</span>: <span class="built_in">any</span>, ...<span class="attr">args</span>: <span class="built_in">any</span>[]</span>) &#123;&#125;

(<span class="keyword">function</span> (<span class="params"></span>) &#123;
  <span class="comment">// npx ts-node app/typeof.ts</span>
  <span class="comment">// å¦‚æœæœ‰é”™ ä¼šæœ‰æ‰“å°</span>
  <span class="keyword">const</span> assert = <span class="built_in">require</span>(<span class="string">&quot;assert&quot;</span>);
&#125;)();</code></pre>

<h2 id="apply-call-å’Œ-bind-å…±åŒç‚¹"><a href="#apply-call-å’Œ-bind-å…±åŒç‚¹" class="headerlink" title="apply, call å’Œ bind å…±åŒç‚¹"></a>apply, call å’Œ bind å…±åŒç‚¹</h2><h2 id="apply-call-å’Œ-bind-ä¸åŒç‚¹"><a href="#apply-call-å’Œ-bind-ä¸åŒç‚¹" class="headerlink" title="apply, call å’Œ bind ä¸åŒç‚¹"></a>apply, call å’Œ bind ä¸åŒç‚¹</h2>]]></content>
      <categories>
        <category>Javascript</category>
      </categories>
      <tags>
        <tag>Javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>javascript instanceof åŸç†</title>
    <url>/2022/10/26/js/instanceof/</url>
    <content><![CDATA[<h2 id="instanceof-åŸç†"><a href="#instanceof-åŸç†" class="headerlink" title="instanceof åŸç†"></a>instanceof åŸç†</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/instanceof">instanceof</a> è¿ç®—ç¬¦ç”¨äºæ£€æµ‹æ„é€ å‡½æ•°çš„ prototype å±æ€§æ˜¯å¦å‡ºç°åœ¨æŸä¸ªå®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Šã€‚</p>
<h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><pre><code class="highlight ts"><span class="comment">/**</span>
<span class="comment"> *</span>
<span class="comment"> * ç®€å•æ¨¡æ‹Ÿ instanceofçš„å®ç°</span>
<span class="comment"> *</span>
<span class="comment"> * https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/instanceof</span>
<span class="comment"> *</span>
<span class="comment"> * instanceof è¿ç®—ç¬¦ç”¨äºæ£€æµ‹æ„é€ å‡½æ•°çš„ prototype å±æ€§æ˜¯å¦å‡ºç°åœ¨æŸä¸ªå®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Šã€‚</span>
<span class="comment"> *</span>
<span class="comment"> * éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœè¡¨è¾¾å¼ obj instanceof Foo è¿”å› trueï¼Œåˆ™å¹¶ä¸æ„å‘³ç€è¯¥è¡¨è¾¾å¼ä¼šæ°¸è¿œè¿”å› trueï¼Œ</span>
<span class="comment"> * å› ä¸º Foo.prototype å±æ€§çš„å€¼æœ‰å¯èƒ½ä¼šæ”¹å˜ï¼Œæ”¹å˜ä¹‹åçš„å€¼å¾ˆæœ‰å¯èƒ½ä¸å­˜åœ¨äº obj çš„åŸå‹é“¾ä¸Šï¼Œ</span>
<span class="comment"> * è¿™æ—¶åŸè¡¨è¾¾å¼çš„å€¼å°±ä¼šæˆä¸º falseã€‚å¦å¤–ä¸€ç§æƒ…å†µä¸‹ï¼ŒåŸè¡¨è¾¾å¼çš„å€¼ä¹Ÿä¼šæ”¹å˜ï¼Œå°±æ˜¯æ”¹å˜å¯¹è±¡ obj çš„åŸå‹é“¾çš„æƒ…å†µï¼Œè™½ç„¶åœ¨ç›®å‰çš„ ES è§„èŒƒä¸­ï¼Œ</span>
<span class="comment"> * æˆ‘ä»¬åªèƒ½è¯»å–å¯¹è±¡çš„åŸå‹è€Œä¸èƒ½æ”¹å˜å®ƒï¼Œä½†å€ŸåŠ©äºéæ ‡å‡†çš„ __proto__ ä¼ªå±æ€§ï¼Œæ˜¯å¯ä»¥å®ç°çš„ã€‚</span>
<span class="comment"> * æ¯”å¦‚æ‰§è¡Œ obj.__proto__ = &#123;&#125; ä¹‹åï¼Œobj instanceof Foo å°±ä¼šè¿”å› false äº†ã€‚</span>
<span class="comment"> *</span>
<span class="comment"> *</span>
<span class="comment"> * <span class="doctag">@param</span> instance å®ä¾‹å¯¹è±¡</span>
<span class="comment"> * <span class="doctag">@param</span> Func æ„é€ å‡½æ•°</span>
<span class="comment"> * <span class="doctag">@returns</span> <span class="variable">boolean</span></span>
<span class="comment"> */</span>
<span class="keyword">function</span> <span class="title function_">_instanceof</span>(<span class="params"><span class="attr">instance</span>: <span class="built_in">any</span>, <span class="title class_">Func</span>: <span class="built_in">any</span></span>) &#123;
  <span class="keyword">let</span> instance_proto = instance.<span class="property">__proto__</span>;
  <span class="keyword">let</span> <span class="title class_">FuncProto</span> = <span class="title class_">Func</span>.<span class="property"><span class="keyword">prototype</span></span>;

  <span class="keyword">while</span> (<span class="literal">true</span>) &#123;
    <span class="keyword">if</span> (instance_proto === <span class="literal">null</span>) &#123;
      <span class="keyword">return</span> <span class="literal">false</span>;
    &#125;
    <span class="keyword">if</span> (instance_proto === <span class="title class_">FuncProto</span>) &#123;
      <span class="keyword">return</span> <span class="literal">true</span>;
    &#125;

    instance_proto = instance_proto.<span class="property">__proto__</span>;
  &#125;
&#125;

(<span class="keyword">function</span> (<span class="params"></span>) &#123;
  <span class="comment">// npx ts-node app/typeof.ts</span>
  <span class="comment">// å¦‚æœæœ‰é”™ ä¼šæœ‰æ‰“å°</span>
  <span class="keyword">const</span> assert = <span class="built_in">require</span>(<span class="string">&quot;assert&quot;</span>);

  <span class="comment">// å®šä¹‰æ„é€ å‡½æ•°</span>
  <span class="keyword">function</span> <span class="title function_">C</span>(<span class="params"></span>) &#123;&#125;
  <span class="keyword">function</span> <span class="title function_">D</span>(<span class="params"></span>) &#123;&#125;

  <span class="keyword">let</span> o = <span class="title function_">new</span> (C <span class="keyword">as</span> <span class="built_in">any</span>)();

  assert.<span class="title function_">equal</span>(o <span class="keyword">instanceof</span> C, <span class="title function_">_instanceof</span>(o, C));
  assert.<span class="title function_">equal</span>(o <span class="keyword">instanceof</span> <span class="title class_">Object</span>, <span class="title function_">_instanceof</span>(o, <span class="title class_">Object</span>));
  assert.<span class="title function_">equal</span>(C.<span class="property"><span class="keyword">prototype</span></span> <span class="keyword">instanceof</span> <span class="title class_">Object</span>, <span class="title function_">_instanceof</span>(C.<span class="property"><span class="keyword">prototype</span></span>, <span class="title class_">Object</span>));

  <span class="comment">//</span>
  C.<span class="property"><span class="keyword">prototype</span></span> = &#123;&#125;;
  <span class="keyword">let</span> o2 = <span class="title function_">new</span> (C <span class="keyword">as</span> <span class="built_in">any</span>)();
  assert.<span class="title function_">equal</span>(o <span class="keyword">instanceof</span> C, <span class="title function_">_instanceof</span>(o2, C));

  <span class="comment">//  falseï¼ŒC.prototype æŒ‡å‘äº†ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œè¿™ä¸ªç©ºå¯¹è±¡ä¸åœ¨ o çš„åŸå‹é“¾ä¸Šã€‚</span>
  assert.<span class="title function_">equal</span>(<span class="literal">false</span>, <span class="title function_">_instanceof</span>(o, C));

  D.<span class="property"><span class="keyword">prototype</span></span> = <span class="title function_">new</span> (C <span class="keyword">as</span> <span class="built_in">any</span>)(); <span class="comment">// ç»§æ‰¿</span>

  <span class="keyword">let</span> o3 = <span class="title function_">new</span> (D <span class="keyword">as</span> <span class="built_in">any</span>)();

  assert.<span class="title function_">equal</span>(o3 <span class="keyword">instanceof</span> D, <span class="title function_">_instanceof</span>(o3, D));

  <span class="comment">// true å› ä¸º C.prototype ç°åœ¨åœ¨ o3 çš„åŸå‹é“¾ä¸Š</span>
  assert.<span class="title function_">equal</span>(o3 <span class="keyword">instanceof</span> C, <span class="title function_">_instanceof</span>(o3, C));
&#125;)();</code></pre>]]></content>
      <categories>
        <category>Javascript</category>
      </categories>
      <tags>
        <tag>Javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>javascript typeof åŸç†</title>
    <url>/2022/10/25/js/typeof/</url>
    <content><![CDATA[<h2 id="typeof-åŸç†"><a href="#typeof-åŸç†" class="headerlink" title="typeof åŸç†"></a>typeof åŸç†</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/typeof">typeof</a> è¿ç®—ç¬¦è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ“ä½œæ•°çš„ç±»å‹ã€‚</p>
<p>javascript åœ¨åº•å±‚å­˜å‚¨å˜é‡çš„æ—¶å€™,ä¼šåœ¨å˜é‡çš„æœºå™¨ç çš„ä½ä½(å‰ä¸‰ä½) 1-3 ä½å­˜å‚¨å…¶ç±»å‹ä¿¡æ¯: å¯¹è±¡:000 (null æ˜¯ 000ï¼Œ è¿™ä¹Ÿæ˜¯ null çš„ typeof å€¼ä¸ºä»€ä¹ˆæ˜¯ object çš„åŸå› ) æµ®ç‚¹æ•°:010 å­—ç¬¦ä¸²:100 å¸ƒå°”:110 â€ã€‚<br><code>typeof</code>ç›´æ¥æ ¹æ®å˜é‡å€¼å¾—å†…å­˜æ ‡è¯†ç¬¦è¿›è¡Œåˆ¤æ–­å¹¶è¿”å›çš„æ˜¯å¯¹åº”å­—ç¬¦ä¸²å½¢å¼çš„å€¼ã€‚</p>
<h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><pre><code class="highlight ts"><span class="comment">/**</span>
<span class="comment"> * æ¨¡æ‹Ÿ typeof</span>
<span class="comment"> *</span>
<span class="comment"> * typeofåŸç†ï¼š</span>
<span class="comment"> * js åœ¨åº•å±‚å­˜å‚¨å˜é‡çš„æ—¶å€™,ä¼šåœ¨å˜é‡çš„æœºå™¨ç çš„ä½ä½1-3ä½å­˜å‚¨å…¶ç±»å‹ä¿¡æ¯: å¯¹è±¡:000 (null æ˜¯ 000ï¼Œ è¿™ä¹Ÿæ˜¯ null çš„typeof å€¼ä¸ºä»€ä¹ˆæ˜¯objectçš„åŸå› ) æµ®ç‚¹æ•°:010 å­—ç¬¦ä¸²:100 å¸ƒå°”:110 â€ã€‚</span>
<span class="comment"> * typeofç›´æ¥æ ¹æ®å˜é‡å€¼å¾—å†…å­˜æ ‡è¯†ç¬¦è¿›è¡Œåˆ¤æ–­å¹¶è¿”å›çš„æ˜¯å¯¹åº”å­—ç¬¦ä¸²å½¢å¼çš„å€¼ã€‚</span>
<span class="comment"> *</span>
<span class="comment"> * å®ç°ï¼š</span>
<span class="comment"> * 1. åˆ›å»ºä¸€ä¸ªæšä¸¾å¯¹è±¡</span>
<span class="comment"> * 2. åˆ©ç”¨ Object.prototype.toString.call æ¥è·å–ç±»å‹</span>
<span class="comment"> * 3. å†å¯¹ Number, String, Boolean å¯¹è±¡è¿›è¡Œç‰¹æ®Šå¤„ç†</span>
<span class="comment"> *</span>
<span class="comment"> * <span class="doctag">@param</span> target any</span>
<span class="comment"> * <span class="doctag">@returns</span> <span class="variable">string</span></span>
<span class="comment"> */</span>
<span class="keyword">function</span> <span class="title function_">_typeof</span>(<span class="params"><span class="attr">target</span>: <span class="built_in">any</span></span>) &#123;
  <span class="keyword">const</span> <span class="title class_">EnumMap</span> = &#123;
    [<span class="string">&quot;[object Number]&quot;</span>]: <span class="string">&quot;number&quot;</span>,
    [<span class="string">&quot;[object String]&quot;</span>]: <span class="string">&quot;string&quot;</span>,
    [<span class="string">&quot;[object Object]&quot;</span>]: <span class="string">&quot;object&quot;</span>,
    [<span class="string">&quot;[object Array]&quot;</span>]: <span class="string">&quot;object&quot;</span>,
    [<span class="string">&quot;[object Null]&quot;</span>]: <span class="string">&quot;object&quot;</span>,
    [<span class="string">&quot;[object Boolean]&quot;</span>]: <span class="string">&quot;boolean&quot;</span>,
    [<span class="string">&quot;[object Function]&quot;</span>]: <span class="string">&quot;function&quot;</span>,
    [<span class="string">&quot;[object Undefined]&quot;</span>]: <span class="string">&quot;undefined&quot;</span>,
    [<span class="string">&quot;[object Symbol]&quot;</span>]: <span class="string">&quot;symbol&quot;</span>,
    [<span class="string">&quot;[object BigInt]&quot;</span>]: <span class="string">&quot;bigint&quot;</span>,
    [<span class="string">&quot;[object Set]&quot;</span>]: <span class="string">&quot;object&quot;</span>,
    [<span class="string">&quot;[object Map]&quot;</span>]: <span class="string">&quot;object&quot;</span>
  &#125;;

  <span class="keyword">const</span> <span class="attr">key</span>: keyof <span class="keyword">typeof</span> <span class="title class_">EnumMap</span> = <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(target);

  <span class="comment">//  è¿™ä¸ªå‡ ä¸ªç‰¹æ®Šå¤„ç†ä¸€ä¸‹</span>
  <span class="keyword">if</span> (
    [<span class="string">&quot;[object Number]&quot;</span>, <span class="string">&quot;[object String]&quot;</span>, <span class="string">&quot;[object Boolean]&quot;</span>].<span class="title function_">includes</span>(key) &amp;&amp;
    target <span class="keyword">instanceof</span> <span class="title class_">Object</span>
  ) &#123;
    <span class="keyword">return</span> <span class="string">&quot;object&quot;</span>;
  &#125;
  <span class="keyword">return</span> <span class="title class_">EnumMap</span>[key];
&#125;

<span class="comment">// npx ts-node app/typeof.ts</span>
<span class="comment">// å¦‚æœæœ‰é”™ ä¼šæœ‰æ‰“å°</span>
<span class="keyword">const</span> assert = <span class="built_in">require</span>(<span class="string">&quot;assert&quot;</span>);
<span class="comment">// test</span>
assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> <span class="number">12312</span>, <span class="title function_">_typeof</span>(<span class="number">12312</span>));
assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> <span class="keyword">new</span> <span class="title class_">Number</span>(<span class="number">12312</span>), <span class="title function_">_typeof</span>(<span class="keyword">new</span> <span class="title class_">Number</span>(<span class="number">12312</span>)));
<span class="comment">//</span>
assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> <span class="literal">true</span>, <span class="title function_">_typeof</span>(<span class="literal">true</span>));
assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> <span class="literal">false</span>, <span class="title function_">_typeof</span>(<span class="literal">false</span>));
assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> <span class="keyword">new</span> <span class="title class_">Boolean</span>(<span class="literal">true</span>), <span class="title function_">_typeof</span>(<span class="keyword">new</span> <span class="title class_">Boolean</span>(<span class="literal">true</span>)));
assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> <span class="keyword">new</span> <span class="title class_">Boolean</span>(<span class="literal">false</span>), <span class="title function_">_typeof</span>(<span class="keyword">new</span> <span class="title class_">Boolean</span>(<span class="literal">false</span>)));
<span class="comment">//</span>
assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> <span class="string">&quot;string&quot;</span>, <span class="title function_">_typeof</span>(<span class="string">&quot;string&quot;</span>));
assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;string&quot;</span>), <span class="title function_">_typeof</span>(<span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;string&quot;</span>)));

<span class="comment">// object</span>
assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> &#123;&#125;, <span class="title function_">_typeof</span>(&#123;&#125;));
assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> <span class="keyword">new</span> <span class="title class_">Object</span>(&#123;&#125;), <span class="title function_">_typeof</span>(<span class="keyword">new</span> <span class="title class_">Object</span>(&#123;&#125;)));
assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> <span class="title class_">Object</span>.<span class="title function_">create</span>(&#123;&#125;), <span class="title function_">_typeof</span>(<span class="title class_">Object</span>.<span class="title function_">create</span>(&#123;&#125;)));
<span class="comment">//</span>
assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> [], <span class="title function_">_typeof</span>([]));
assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> <span class="keyword">new</span> <span class="title class_">Array</span>(), <span class="title function_">_typeof</span>(<span class="keyword">new</span> <span class="title class_">Array</span>()));
<span class="comment">//</span>
assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> <span class="literal">null</span>, <span class="title function_">_typeof</span>(<span class="literal">null</span>));
<span class="comment">//</span>
assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> <span class="literal">undefined</span>, <span class="title function_">_typeof</span>(<span class="literal">undefined</span>));

<span class="comment">//</span>
assert.<span class="title function_">equal</span>(
  <span class="title function_">typeof</span> (<span class="function">() =&gt;</span> &#123;&#125;),
  <span class="title function_">_typeof</span>(<span class="function">() =&gt;</span> &#123;&#125;)
);
assert.<span class="title function_">equal</span>(
  <span class="keyword">typeof</span> <span class="keyword">function</span> <span class="title function_">a</span>(<span class="params"></span>) &#123;&#125;,
  <span class="title function_">_typeof</span>(<span class="keyword">function</span> <span class="title function_">a</span>(<span class="params"></span>) &#123;&#125;)
);
assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> <span class="keyword">new</span> <span class="title class_">Function</span>(), <span class="title function_">_typeof</span>(<span class="keyword">new</span> <span class="title class_">Function</span>()));

<span class="comment">//</span>
assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> <span class="title class_">Symbol</span>, <span class="title function_">_typeof</span>(<span class="title class_">Symbol</span>));
assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> <span class="title class_">Symbol</span>(), <span class="title function_">_typeof</span>(<span class="title class_">Symbol</span>()));

<span class="comment">// // bigint</span>
<span class="comment">// assert.equal(typeof 123n, _typeof(123n));</span>
<span class="comment">// assert.equal(typeof new BigInt(123n), _typeof(new BigInt(123n)));</span>

assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> <span class="keyword">new</span> <span class="title class_">Set</span>(), <span class="title function_">_typeof</span>(<span class="keyword">new</span> <span class="title class_">Set</span>()));
assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> <span class="keyword">new</span> <span class="title class_">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]), <span class="title function_">_typeof</span>(<span class="keyword">new</span> <span class="title class_">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])));

<span class="comment">//</span>
assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> <span class="keyword">new</span> <span class="title class_">Map</span>(), <span class="title function_">_typeof</span>(<span class="keyword">new</span> <span class="title class_">Map</span>()));

<span class="comment">//</span>
<span class="keyword">class</span> <span class="title class_">Point</span> &#123;&#125;

<span class="keyword">let</span> point = <span class="keyword">new</span> <span class="title class_">Point</span>();

assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> <span class="title class_">Point</span>, <span class="title function_">_typeof</span>(<span class="title class_">Point</span>));
assert.<span class="title function_">equal</span>(<span class="keyword">typeof</span> point, <span class="title function_">_typeof</span>(point));</code></pre>]]></content>
      <categories>
        <category>Javascript</category>
      </categories>
      <tags>
        <tag>Javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>react-scripts5 + craco7 + antd4 é…ç½®</title>
    <url>/2024/10/01/react/cra5_craco7_antd4/</url>
    <content><![CDATA[<h2 id="å®‰è£…ä¾èµ–"><a href="#å®‰è£…ä¾èµ–" class="headerlink" title="å®‰è£…ä¾èµ–"></a>å®‰è£…ä¾èµ–</h2><pre><code class="highlight bash">pnpm add less less-loader @craco/craco craco-less babel-plugin-import postcss-px-to-viewport-8-plugin postcss -D</code></pre>

<h2 id="config"><a href="#config" class="headerlink" title="config"></a>config</h2><p>é…ç½®æ”¯æŒ antd4 æŒ‰éœ€åŠ è½½ã€å®šåˆ¶ä¸»é¢˜ã€æ”¯æŒ px è½¬ vw å’Œ é…ç½®åˆ«å</p>
<p>åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹æ–°å»º <code>craco.config.js</code></p>
<pre><code class="highlight js"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);
<span class="keyword">const</span> <span class="title class_">CracoLessPlugin</span> = <span class="built_in">require</span>(<span class="string">&quot;craco-less&quot;</span>);

<span class="variable language_">module</span>.<span class="property">exports</span> = &#123;
  <span class="attr">babel</span>: &#123;
    <span class="comment">// é…ç½®babelæ’ä»¶</span>
    <span class="attr">plugins</span>: [
      [
        <span class="comment">// å®‰è£… babel-plugin-import  https://www.npmjs.com/package/babel-plugin-import</span>
        <span class="comment">// https://4x.ant.design/docs/react/customize-theme-cn#%E6%B2%A1%E6%9C%89%E7%94%9F%E6%95%88%EF%BC%9F</span>
        <span class="string">&quot;import&quot;</span>,
        &#123;
          <span class="attr">libraryName</span>: <span class="string">&quot;antd&quot;</span>,
          <span class="attr">libraryDirectory</span>: <span class="string">&quot;es&quot;</span>,
          <span class="attr">style</span>: <span class="literal">true</span> <span class="comment">// åŠ è½½lessæ–‡ä»¶</span>
        &#125;
      ]
    ]
  &#125;,
  <span class="attr">style</span>: &#123;
    <span class="attr">postcss</span>: &#123;
      <span class="attr">mode</span>: <span class="string">&quot;exclude&quot;</span>,
      <span class="attr">loaderOptions</span>: &#123;
        <span class="attr">postcssOptions</span>: &#123;
            <span class="comment">// postcss éœ€è¦å¤§äºç­‰äº 8</span>
          <span class="attr">ident</span>: <span class="string">&quot;postcss&quot;</span>,
          <span class="attr">plugins</span>: [
            [
              <span class="comment">// https://www.npmjs.com/package/postcss-px-to-viewport-8-plugin</span>
              <span class="string">&quot;postcss-px-to-viewport-8-plugin&quot;</span>,
              &#123;
                <span class="attr">unitToConvert</span>: <span class="string">&quot;px&quot;</span>, <span class="comment">// è¦è½¬åŒ–çš„å•ä½</span>
                <span class="attr">viewportWidth</span>: <span class="number">375</span>, <span class="comment">// UIè®¾è®¡ç¨¿çš„å®½åº¦</span>
                <span class="attr">viewportUnit</span>: <span class="string">&quot;vw&quot;</span>, <span class="comment">// æŒ‡å®šéœ€è¦è½¬æ¢æˆçš„è§†çª—å•ä½ï¼Œå»ºè®®ä½¿ç”¨ rem</span>
                <span class="attr">fontViewportUnit</span>: <span class="string">&quot;vw&quot;</span>, <span class="comment">// å­—ä½“ä½¿ç”¨çš„è§†å£å•ä½</span>
                <span class="attr">unitPrecision</span>: <span class="number">13</span>, <span class="comment">// æŒ‡å®š`px`è½¬æ¢ä¸ºè§†çª—å•ä½å€¼çš„å°æ•°å xä½æ•°</span>
                <span class="comment">// propList: å½“æœ‰äº›å±æ€§çš„å•ä½æˆ‘ä»¬ä¸å¸Œæœ›è½¬æ¢çš„æ—¶å€™ï¼Œå¯ä»¥æ·»åŠ åœ¨æ•°ç»„åé¢ï¼Œå¹¶åœ¨å‰é¢åŠ ä¸Š!å·ï¼Œå¦‚propList: [&quot;*&quot;,&quot;!letter-spacing&quot;],è¿™è¡¨ç¤ºï¼šæ‰€æœ‰csså±æ€§çš„å±æ€§çš„å•ä½éƒ½è¿›è¡Œè½¬åŒ–ï¼Œé™¤äº†letter-spacingçš„</span>
                <span class="attr">propList</span>: [<span class="string">&quot;*&quot;</span>], <span class="comment">// æŒ‡å®šè½¬æ¢çš„csså±æ€§çš„å•ä½ï¼Œ*ä»£è¡¨å…¨éƒ¨csså±æ€§çš„å•ä½éƒ½è¿›è¡Œè½¬æ¢</span>
                <span class="comment">// è½¬æ¢çš„é»‘åå•ï¼Œåœ¨é»‘åå•é‡Œé¢çš„æˆ‘ä»¬å¯ä»¥å†™å…¥å­—ç¬¦ä¸²ï¼Œåªè¦ç±»ååŒ…å«æœ‰è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œå°±ä¸ä¼šè¢«åŒ¹é…ã€‚æ¯”å¦‚selectorBlackList: [&#x27;wrap&#x27;],å®ƒè¡¨ç¤ºå½¢å¦‚wrap,my-wrap,wrapperè¿™æ ·çš„ç±»åçš„å•ä½ï¼Œéƒ½ä¸ä¼šè¢«è½¬æ¢</span>
                <span class="attr">selectorBlackList</span>: [<span class="string">&quot;ignore&quot;</span>], <span class="comment">// æŒ‡å®šä¸è½¬æ¢ä¸ºè§†çª—å•ä½çš„ç±»åï¼Œ</span>
                <span class="attr">minPixelValue</span>: <span class="number">1</span>, <span class="comment">// é»˜è®¤å€¼1ï¼Œå°äºæˆ–ç­‰äº1pxåˆ™ä¸è¿›è¡Œè½¬æ¢</span>
                <span class="attr">mediaQuery</span>: <span class="literal">true</span>, <span class="comment">// æ˜¯å¦åœ¨åª’ä½“æŸ¥è¯¢çš„cssä»£ç ä¸­ä¹Ÿè¿›è¡Œè½¬æ¢ï¼Œé»˜è®¤false</span>
                <span class="attr">replace</span>: <span class="literal">true</span>, <span class="comment">// æ˜¯å¦è½¬æ¢åç›´æ¥æ›´æ¢å±æ€§å€¼</span>
                <span class="attr">exclude</span>: [<span class="regexp">/node_modules/</span>], <span class="comment">// è®¾ç½®å¿½ç•¥æ–‡ä»¶ï¼Œç”¨æ­£åˆ™åšç›®å½•ååŒ¹é…</span>
                <span class="attr">landscape</span>: <span class="literal">false</span> <span class="comment">// æ˜¯å¦å¤„ç†æ¨ªå±æƒ…å†µ</span>
              &#125;
            ]
          ]
        &#125;
      &#125;
    &#125;
  &#125;,
  <span class="attr">plugins</span>: [
    &#123;
      <span class="attr">plugin</span>: <span class="title class_">CracoLessPlugin</span>,
      <span class="attr">options</span>: &#123;
        <span class="attr">lessLoaderOptions</span>: &#123;
          <span class="attr">lessOptions</span>: &#123; <span class="comment">// less &gt;= 4, less-loader &gt;= 11</span>
            <span class="attr">modifyVars</span>: &#123;
              <span class="string">&quot;primary-color&quot;</span>: <span class="string">&quot;#1DA57A&quot;</span>,
              <span class="string">&quot;link-color&quot;</span>: <span class="string">&quot;#1DA57A&quot;</span>,
              <span class="string">&quot;border-radius-base&quot;</span>: <span class="string">&quot;2px&quot;</span>
              <span class="comment">// æ›´æ”¹antd é»˜è®¤çš„ç±»åå‰ç¼€ï¼Œç»“åˆ ConfigProvider ä½¿ç”¨ https://4x.ant.design/docs/react/customize-theme-variable-cn#%E4%BB%A3%E7%A0%81%E8%B0%83%E6%95%B4</span>
              <span class="comment">// &quot;@ant-prefix&quot;: &quot;custom&quot;</span>
            &#125;,
            <span class="attr">javascriptEnabled</span>: <span class="literal">true</span> <span class="comment">// å…è®¸lessæ–‡ä»¶ä¸­ä½¿ç”¨jsè¡¨è¾¾å¼</span>
          &#125;
        &#125;
      &#125;
    &#125;
  ],
  <span class="attr">webpack</span>: &#123;
    <span class="comment">// .... å…¶ä»–é…ç½®</span>
    <span class="attr">alias</span>: &#123;
      <span class="comment">// æ–‡ä»¶è·¯å¾„åˆ«å</span>
      <span class="string">&quot;@&quot;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;src&quot;</span>)
    &#125;
  &#125;,
<span class="comment">//   devServer: &#123;&#125;</span>
&#125;;
</code></pre>



<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://create-react-app.dev/">create-react-app</a><br><a href="https://craco.js.org/docs/">@craco&#x2F;craco</a><br><a href="https://4x.ant.design/docs/react/customize-theme-cn">antd4</a><br><a href="https://www.npmjs.com/package/postcss-px-to-viewport-8-plugin">postcss-px-to-viewport-8-plugin</a></p>
<p>å¤‡æ³¨ï¼šç”±äº <a href="https://www.npmjs.com/package/react-scripts">react-scripts</a> ä¸åœ¨æ›´æ–°ç»´æŠ¤ï¼Œæ¨èç¼–è¯‘å·¥å…·æ¢æˆ <a href="https://cn.vitejs.dev/guide/">vite</a></p>
]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title>javascript ç‰ˆ React åˆ«åï¼ˆaliasï¼‰</title>
    <url>/2021/11/10/react/jsconfig/</url>
    <content><![CDATA[<h2 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h2><p>è™½ç„¶è¯´è¿‘å‡ å¹´å·²ç»ä¸åœ¨å†™ javascript ç‰ˆ React äº†ï¼Œä¸€ç›´åœ¨ç”¨ typescript ä½†æ˜¯æœ€è¿‘æ¥äº†ä¸ªå¤–åŒ…ï¼Œå…¶ä»–å°ä¼™ä¼´ä¸å¤ªç†Ÿ typescriptã€‚æ‰€ä»¥å°±æ‰“ç®—é…ç½®ä¸€ä¸‹ä½¿ç”¨ javascript ç¯å¢ƒé¡¹ç›®çš„åˆ«åã€‚</p>
<p>ä½¿ç”¨<a href="https://create-react-app.dev/">create-react-app</a> åˆ›å»º javascript ç‰ˆ React é¡¹ç›®ï¼Œå®‰è£… <a href="https://github.com/gsoft-inc/craco"><code>@craco/craco</code></a>ã€‚</p>
<p>å…·ä½“é…ç½®çœç•¥ï¼Œæ¥ä¸‹æ¥ä¸»è¦è¯´ç”¨åˆ«åçš„é…ç½®ã€‚ï¼ˆæƒ³è¦äº†è§£å…·ä½“é…ç½®è¯·å‚è€ƒ<a href="https://github.com/gsoft-inc/craco/blob/master/packages/craco/README.md#installation%EF%BC%89">https://github.com/gsoft-inc/craco/blob/master/packages/craco/README.md#installationï¼‰</a></p>
<h2 id="craco-ä¸­é…ç½®-webpack"><a href="#craco-ä¸­é…ç½®-webpack" class="headerlink" title="craco ä¸­é…ç½® webpack"></a>craco ä¸­é…ç½® webpack</h2><p>åœ¨æ ¹ç›®å½•<code>craco.config.js</code>æ–‡ä»¶ä¸­é…ç½®åˆ«å</p>
<pre><code class="highlight js"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;
  <span class="attr">webpack</span>: &#123;
    <span class="comment">// .... å…¶ä»–é…ç½®</span>
    <span class="attr">alias</span>: &#123;
      <span class="comment">// æ–‡ä»¶è·¯å¾„åˆ«å</span>
      <span class="string">&quot;@&quot;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;src&quot;</span>),
      <span class="string">&quot;@components&quot;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;src/components&quot;</span>),
      <span class="string">&quot;@utils&quot;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;src/utils&quot;</span>),
      <span class="string">&quot;@assets&quot;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;src/assets&quot;</span>),
      <span class="string">&quot;@containers&quot;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;src/containers&quot;</span>),
      <span class="string">&quot;@hooks&quot;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;src/hooks&quot;</span>),
      <span class="string">&quot;@store&quot;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;src/store&quot;</span>)
    &#125;
  &#125;
&#125;;</code></pre>

<h2 id="jsconfig-json"><a href="#jsconfig-json" class="headerlink" title="jsconfig.json"></a>jsconfig.json</h2><p>åœ¨æ ¹ç›®å½•ä¸‹æ–°å»º<code>jsconfig.json</code>, æ·»åŠ ä¸‹é¢å†…å®¹å³å¯ã€‚</p>
<pre><code class="highlight json"><span class="punctuation">&#123;</span>
  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>
    <span class="attr">&quot;module&quot;</span><span class="punctuation">:</span> <span class="string">&quot;commonjs&quot;</span><span class="punctuation">,</span>
    <span class="attr">&quot;jsx&quot;</span><span class="punctuation">:</span> <span class="string">&quot;preserve&quot;</span><span class="punctuation">,</span>
    <span class="attr">&quot;baseUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.&quot;</span><span class="punctuation">,</span>
    <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>
      <span class="attr">&quot;@components/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;./src/components/*&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span>
      <span class="attr">&quot;@assets/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;./src/assets/*&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span>
      <span class="attr">&quot;@containers/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;./src/containers/*&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span>
      <span class="attr">&quot;@hooks/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;./src/hooks/*&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span>
      <span class="attr">&quot;@store/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;./src/store/*&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span>
      <span class="attr">&quot;@utils/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;./src/utils/*&quot;</span><span class="punctuation">]</span>
    <span class="punctuation">&#125;</span>
  <span class="punctuation">&#125;</span><span class="punctuation">,</span>
  <span class="attr">&quot;include&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;./src/**/*&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span>
  <span class="attr">&quot;exclude&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;node_modules&quot;</span><span class="punctuation">,</span> <span class="string">&quot;build&quot;</span><span class="punctuation">,</span> <span class="string">&quot;coverage&quot;</span><span class="punctuation">,</span> <span class="string">&quot;dist&quot;</span><span class="punctuation">,</span> <span class="string">&quot;lib&quot;</span><span class="punctuation">]</span>
<span class="punctuation">&#125;</span></code></pre>

<p>æ³¨æ„ âš ï¸ï¼š è¿™ä¸ªæ–‡ä»¶æœ‰ä¸¥æ ¼çš„ json æ ¼å¼è¦æ±‚ï¼Œ ä¾‹å¦‚æœ€åä¸€é¡¹ä¸èƒ½æœ‰<code>,</code> ç­‰</p>
<p>â¤ï¸ â¤ï¸ è¿˜æ˜¯ ts é¦™ â¤ï¸ â¤ï¸</p>
]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title>docker nginx éƒ¨ç½²Reacté¡¹ç›®</title>
    <url>/2021/12/11/react/nginx_deploy/</url>
    <content><![CDATA[<h2 id="docker-nginx"><a href="#docker-nginx" class="headerlink" title="docker nginx"></a>docker nginx</h2><ol>
<li>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»º <code>docker-compose.yml</code>æ–‡ä»¶</li>
</ol>
<pre><code class="highlight yml"><span class="attr">version:</span> <span class="string">&quot;2&quot;</span>
<span class="attr">services:</span>
  <span class="comment"># æœåŠ¡åç§°</span>
  <span class="attr">nginx:</span>
    <span class="comment"># é•œåƒ:ç‰ˆæœ¬</span>
    <span class="attr">image:</span> <span class="string">nginx:latest</span>
    <span class="comment"># æ˜ å°„å®¹å™¨80ç«¯å£åˆ°æœ¬åœ°80ç«¯å£</span>
    <span class="attr">ports:</span>
      <span class="bullet">-</span> <span class="string">&quot;80:80&quot;</span>
    <span class="comment"># æ•°æ®å· æ˜ å°„æœ¬åœ°æ–‡ä»¶åˆ°å®¹å™¨</span>
    <span class="comment"># è¿™ä¸ªæ›´æ–°èµ·æ¥ç‰¹åˆ«é¦™</span>
    <span class="attr">volumes:</span>
      <span class="comment"># æ˜ å°„nginx.confæ–‡ä»¶åˆ°å®¹å™¨çš„/etc/nginx/conf.dç›®å½•å¹¶è¦†ç›–default.confæ–‡ä»¶</span>
      <span class="bullet">-</span> <span class="string">./nginx.conf:/etc/nginx/conf.d/default.conf</span>
      <span class="comment"># æ˜ å°„buildæ–‡ä»¶å¤¹åˆ°å®¹å™¨çš„/usr/share/nginx/htmlæ–‡ä»¶å¤¹</span>
      <span class="bullet">-</span> <span class="string">./build:/usr/share/nginx/html</span>
    <span class="comment"># è¦†ç›–å®¹å™¨å¯åŠ¨åé»˜è®¤æ‰§è¡Œçš„å‘½ä»¤ã€‚</span>
    <span class="attr">command:</span> <span class="string">/bin/bash</span> <span class="string">-c</span> <span class="string">&quot;nginx -g &#x27;daemon off;&#x27;&quot;</span></code></pre>

<p>æŒ‚è½½ nginx é…ç½®</p>
<pre><code class="highlight bash">location / &#123;
    root   /usr/share/nginx/html;
    index  index.html index.htm;
    <span class="comment"># å…¶ä½œç”¨æ˜¯æŒ‰é¡ºåºæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œè¿”å›ç¬¬ä¸€ä¸ªæ‰¾åˆ°çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼ˆç»“å°¾åŠ æ–œçº¿è¡¨ç¤ºä¸ºæ–‡ä»¶å¤¹ï¼‰ï¼Œå¦‚æœæ‰€æœ‰çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹éƒ½æ‰¾ä¸åˆ°ï¼Œä¼šè¿›è¡Œä¸€ä¸ªå†…éƒ¨é‡å®šå‘åˆ°æœ€åä¸€ä¸ªå‚æ•°ã€‚</span>
    try_files <span class="variable">$uri</span> /index.html;
&#125;

<span class="comment"># æ¥å£ä»£ç†</span>
location ^~ /api/ &#123;
    <span class="comment"># proxy_set_header X-Forwarded-Host $host;</span>
    <span class="comment"># proxy_set_header X-Forwarded-Server $host;</span>
    <span class="comment"># proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span>
    proxy_pass http://xxx.xxxxx.xxxx;
&#125;</code></pre>

<ol start="2">
<li>ç¼–è¯‘ react é¡¹ç›®</li>
</ol>
<pre><code class="highlight bash">yarn run build</code></pre>

<ol start="3">
<li>ç”Ÿæˆå®¹å™¨å¹¶éƒ¨ç½²</li>
</ol>
<pre><code class="highlight bash">docker-compose up -d</code></pre>

<ol start="4">
<li><p>æœ¬åœ°è®¿é—® <code>http://localhost/</code></p>
</li>
<li><p>åœæ­¢å¹¶åˆ é™¤å®¹å™¨ <code>docker-compose down</code></p>
</li>
</ol>
]]></content>
      <categories>
        <category>React</category>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>React</tag>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>svg è½¬å›¾ç‰‡</title>
    <url>/2023/02/24/svg/to_image/</url>
    <content><![CDATA[<h2 id="svg-è½¬å›¾ç‰‡"><a href="#svg-è½¬å›¾ç‰‡" class="headerlink" title="svg è½¬å›¾ç‰‡"></a>svg è½¬å›¾ç‰‡</h2><pre><code class="highlight js"><span class="comment">// åºåˆ—åŒ– svg æ–‡ä»¶ï¼ˆxmlï¼‰ è½¬æˆå­—ç¬¦ä¸²</span>
<span class="keyword">const</span> svgString = <span class="keyword">new</span> <span class="title class_">XMLSerializer</span>()
  .<span class="title function_">serializeToString</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;svg&#x27;</span>));

<span class="keyword">const</span> img = <span class="keyword">new</span> <span class="title class_">Image</span>();
<span class="comment">// svgString svgçš„xmlæ–‡ä»¶å­—ç¬¦ä¸²</span>
<span class="keyword">const</span> svg = <span class="keyword">new</span> <span class="title class_">Blob</span>([svgString], &#123;<span class="attr">type</span>: <span class="string">&quot;image/svg+xml;charset=utf-8&quot;</span>&#125;);

<span class="keyword">const</span> domURL = self.<span class="property">URL</span> || self.<span class="property">webkitURL</span> || self;
<span class="keyword">const</span> url = domURL.<span class="title function_">createObjectURL</span>(svg);

img.<span class="property">src</span> = url;

<span class="comment">// append img to body</span>
<span class="comment">// ...</span></code></pre>

]]></content>
      <categories>
        <category>Svg</category>
      </categories>
      <tags>
        <tag>Svg</tag>
      </tags>
  </entry>
  <entry>
    <title>Mac å·¥å…·</title>
    <url>/2023/02/18/tools/mac/</url>
    <content><![CDATA[<h2 id="homebrew"><a href="#homebrew" class="headerlink" title="homebrew"></a><a href="https://brew.sh/">homebrew</a></h2><p><a href="https://brew.sh/">homebrew</a> å®‰è£… <code>/bin/bash -c &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)&quot;</code></p>
<ol>
<li><p>å®‰è£…æ’ä»¶</p>
<ul>
<li>å®‰è£… <a href="https://git-scm.com/">git</a></li>
</ul>
<p><code>brew install git</code></p>
<ul>
<li>å®‰è£… <a href="https://github.com/wting/autojump">autojump</a></li>
</ul>
<p><code>brew install autojump</code></p>
<p>åœ¨ ~&#x2F;.zshrc ä¸­æ‰¾åˆ°<code>plugins</code> æ·»åŠ  <code>autojump</code>, æ³¨æ„ âš ï¸ æ¯ä¸ªæ’ä»¶é—´ç”¨ç©ºæ ¼éš”å¼€</p>
</li>
</ol>
<h2 id="iTerm2"><a href="#iTerm2" class="headerlink" title="iTerm2"></a><a href="https://iterm2.com/">iTerm2</a></h2><ol>
<li><p>å®‰è£…æ’ä»¶</p>
<ul>
<li>å®‰è£… <a href="https://ohmyz.sh/">oh-my-zsh</a> ä¸»é¢˜</li>
</ul>
<pre><code class="highlight bash">sh -c <span class="string">&quot;\$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)&quot;</span></code></pre>

<ul>
<li>å®‰è£… <a href="https://github.com/zsh-users/zsh-autosuggestions">zsh-autosuggestions</a></li>
</ul>
<pre><code class="highlight bash">git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-autosuggestions <span class="variable">$&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;</span>/plugins/zsh-autosuggestions</code></pre>

<p>åœ¨ ~&#x2F;.zshrc ä¸­æ‰¾åˆ°<code>plugins</code> æ·»åŠ  <code>zsh-autosuggestions</code>, æ³¨æ„ âš ï¸ æ¯ä¸ªæ’ä»¶é—´ç”¨ç©ºæ ¼éš”å¼€</p>
<ul>
<li>å®‰è£… <a href="https://github.com/zsh-users/zsh-syntax-highlighting">zsh-syntax-highlighting</a></li>
</ul>
<pre><code class="highlight bash">git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-syntax-highlighting.git <span class="variable">$&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;</span>/plugins/zsh-syntax-highlighting</code></pre>

<p>åœ¨ ~&#x2F;.zshrc ä¸­æ‰¾åˆ°<code>plugins</code> æ·»åŠ  <code>zsh-syntax-highlighting</code>, æ³¨æ„ âš ï¸ æ¯ä¸ªæ’ä»¶é—´ç”¨ç©ºæ ¼éš”å¼€</p>
<p>æœ€ç»ˆç»“æœ</p>
<pre><code class="highlight bash">plugins=(
 git
 zsh-syntax-highlighting
 zsh-autosuggestions
 autojump
)</code></pre></li>
</ol>
<h2 id="vim-é…ç½®"><a href="#vim-é…ç½®" class="headerlink" title="vim é…ç½®"></a>vim é…ç½®</h2><p>å¯ä»¥å‚è€ƒ é˜®ä¸€å³°è€å¸ˆçš„ <a href="https://www.ruanyifeng.com/blog/2018/09/vimrc.html">Vim é…ç½®å…¥é—¨</a></p>
<p>åœ¨ <code>~/.vimrc</code> é…ç½® (å¦‚æœæ²¡æœ‰è¯·è‡ªå»º<code>touch ~/.vimrc</code>)</p>
<p>æˆ‘çš„åŸºæœ¬è®¾ç½®</p>
<pre><code class="highlight bash"><span class="built_in">set</span> number
syntax on
<span class="built_in">set</span> mouse=a
<span class="built_in">set</span> encoding=utf-8
<span class="built_in">set</span> autoindent
<span class="built_in">set</span> tabstop=2
<span class="built_in">set</span> cursorline
<span class="built_in">set</span> ruler
<span class="built_in">set</span> showmatch
<span class="built_in">set</span> incsearch
<span class="built_in">set</span> hlsearch</code></pre>
]]></content>
      <categories>
        <category>Tool</category>
      </categories>
      <tags>
        <tag>Tool</tag>
        <tag>Mac</tag>
      </tags>
  </entry>
  <entry>
    <title>Yarn workspace</title>
    <url>/2021/08/05/tools/yarn_workspace/</url>
    <content><![CDATA[<h2 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h2><p><a href="https://yarnpkg.com/features/workspaces">yarn Workspaces</a> æ—¨åœ¨ç®€åŒ– monorepos çš„ä½¿ç”¨ï¼Œä»¥æ›´å…·å£°æ˜æ€§çš„æ–¹å¼è§£å†³ yarn é“¾æ¥çš„ä¸»è¦ç”¨ä¾‹ä¹‹ä¸€ã€‚ç®€è¨€ä¹‹ï¼Œå®ƒä»¬å…è®¸æ‚¨çš„å¤šä¸ªé¡¹ç›®ä¸€èµ·ç”Ÿæ´»åœ¨åŒä¸€ä¸ªå­˜å‚¨åº“ä¸­ï¼Œå¹¶ç›¸äº’äº¤å‰å¼•ç”¨â€”â€”å¯¹ä¸€ä¸ªé¡¹ç›®çš„æºä»£ç çš„ä»»ä½•ä¿®æ”¹éƒ½ä¼šç«‹å³åº”ç”¨äºå…¶ä»–é¡¹ç›®ã€‚</p>
<p>é¦–å…ˆï¼Œä¸€äº›è¯æ±‡ï¼šåœ¨å·¥ä½œåŒºç‰¹æ€§çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œé¡¹ç›®æ˜¯ç»„æˆå·¥ä½œåŒºçš„æ•´ä¸ªç›®å½•æ ‘ï¼ˆé€šå¸¸æ˜¯å­˜å‚¨åº“æœ¬èº«ï¼‰ã€‚å·¥ä½œåŒºæ˜¯ç”±åŒä¸€é¡¹ç›®ä¸­æ‚¨è‡ªå·±çš„æºç»„æˆçš„æœ¬åœ°åŒ…ã€‚æœ€åï¼Œå·¥ä½œæ ‘æ˜¯ä¸ºåˆ—å‡ºè‡ªå·±çš„å­å·¥ä½œç©ºé—´çš„å·¥ä½œç©ºé—´æŒ‡å®šçš„åç§°ã€‚é¡¹ç›®åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå·¥ä½œæ ‘ï¼Œè¿™äº›å·¥ä½œæ ‘æœ¬èº«å¯èƒ½åŒ…å«ä»»æ„æ•°é‡çš„å·¥ä½œç©ºé—´ã€‚ä»»ä½•é¡¹ç›®éƒ½è‡³å°‘åŒ…å«ä¸€ä¸ªå·¥ä½œåŒºï¼šæ ¹å·¥ä½œåŒºã€‚</p>
<h2 id="åˆ›å»º"><a href="#åˆ›å»º" class="headerlink" title="åˆ›å»º"></a>åˆ›å»º</h2><ul>
<li>åˆå§‹åŒ–</li>
</ul>
<pre><code class="highlight bash"><span class="built_in">mkdir</span> yarn_workspaces &amp;&amp; <span class="built_in">cd</span> yarn_workspaces

<span class="comment"># åˆå§‹åŒ–</span>
<span class="comment"># é…ç½® package.json</span>
yarn init

<span class="built_in">mkdir</span> packages

<span class="comment"># é…ç½® workspaces</span>
<span class="comment"># &quot;workspaces&quot;: [</span>
<span class="comment">#  &quot;packages/*&quot;</span>
<span class="comment"># ]</span></code></pre>

<ul>
<li>é…ç½®æ ¹ç›®å½•ä¸‹<code>package.json</code></li>
</ul>
<pre><code class="highlight json"><span class="punctuation">&#123;</span>
  <span class="attr">&quot;private&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span>
  <span class="attr">&quot;workspaces&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;packages/*&quot;</span><span class="punctuation">]</span>
<span class="punctuation">&#125;</span></code></pre>

<ul>
<li><p>create common package (componentsã€utilsâ€¦)</p>
<ul>
<li>åˆå§‹åŒ– <code>@mono/common</code> package</li>
</ul>
<pre><code class="highlight bash"><span class="built_in">cd</span> packages &amp;&amp; <span class="built_in">mkdir</span> common

yarn init -y

<span class="built_in">mkdir</span> components &amp;&amp; <span class="built_in">mkdir</span> utils</code></pre>

<ul>
<li>é…ç½® <code>package.json</code></li>
</ul>
<pre><code class="highlight json"><span class="punctuation">&#123;</span>
  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;@mono/common&quot;</span><span class="punctuation">,</span>
  <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;index.ts&quot;</span>
<span class="punctuation">&#125;</span></code></pre>

<p>æ³¨ï¼šç”±äºæ•´ä¸ªé¡¹ç›®éƒ½æ˜¯åŸºäº<code>typescript</code>çš„, æ‰€ä»¥ <code>main</code> å°±ç›´æ¥æŒ‡å®š <code>index.ts</code>ã€‚å¦‚æœè¦å‘å¸ƒåˆ° npm ä¸Šæœ€å¥½è¿˜æ˜¯ä½¿ç”¨<code>.js</code>ã€‚</p>
</li>
<li><p>create mobile web app (html5)</p>
<ul>
<li>åˆå§‹åŒ– app</li>
</ul>
<pre><code class="highlight bash"><span class="built_in">cd</span> packages &amp;&amp; <span class="built_in">mkdir</span> mobile

<span class="comment"># åˆ›å»º index.html</span>
<span class="built_in">touch</span> index.html</code></pre>
</li>
<li><p>create web app (react spa)</p>
<ul>
<li>åˆå§‹åŒ– app</li>
</ul>
<pre><code class="highlight bash"><span class="built_in">cd</span> packages

<span class="comment"># åˆ›å»º react spa app</span>
yarn create react-app my-app --template typescript</code></pre>

<ul>
<li>scripts</li>
</ul>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹<code>package.json</code>ä¸­<code>scripts</code>æ·»åŠ ä¸‹é¢è„šæœ¬</p>
<pre><code class="highlight json"><span class="punctuation">&#123;</span>
  <span class="attr">&quot;react-sap-app&quot;</span><span class="punctuation">:</span> <span class="string">&quot;yarn workspace react-spa-app start&quot;</span>
<span class="punctuation">&#125;</span></code></pre>

<ul>
<li>é…ç½®ä½¿ç”¨æœ¬åœ° package</li>
</ul>
<pre><code class="highlight bash"><span class="comment"># å®‰è£… @craco/craco</span>
<span class="comment"># åœ¨ä¸æ‰§è¡Œ`eject`çš„æ¡ä»¶ä¸‹æ³¨å…¥webpackeç­‰ é…ç½®</span>
yarn add @craco/craco -D</code></pre>

<p>åœ¨<code>react-spa-app</code>æ ¹ç›®å½•ä¸‹æ–°å»ºåˆ›å»º<code>craco.config.js</code>æ–‡ä»¶</p>
<pre><code class="highlight js"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);
<span class="keyword">const</span> &#123; getLoader, loaderByName &#125; = <span class="built_in">require</span>(<span class="string">&quot;@craco/craco&quot;</span>);

<span class="comment">// é…ç½®åŒ…æ‹¬æ ¹ç›®å½•ä»¥å¤–æ–‡ä»¶è·¯å¾„</span>
<span class="comment">// absolutePath åŒ…å `@mono/common`</span>
<span class="comment">// åœ¨`react-spa-app`é¡¹ç›®ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨ import nameFn from &quot;@mono/common&quot;</span>
<span class="keyword">const</span> absolutePath = path.<span class="title function_">join</span>(__dirname, <span class="string">&quot;../common&quot;</span>);

<span class="variable language_">module</span>.<span class="property">exports</span> = &#123;
  <span class="attr">webpack</span>: &#123;
    <span class="attr">alias</span>: &#123;&#125;,
    <span class="attr">plugins</span>: [],
    <span class="attr">configure</span>: <span class="function">(<span class="params">webpackConfig, &#123; env, paths &#125;</span>) =&gt;</span> &#123;
      <span class="keyword">const</span> &#123; isFound, match &#125; = <span class="title function_">getLoader</span>(
        webpackConfig,
        <span class="title function_">loaderByName</span>(<span class="string">&quot;babel-loader&quot;</span>)
      );
      <span class="keyword">if</span> (isFound) &#123;
        <span class="keyword">const</span> include = <span class="title class_">Array</span>.<span class="title function_">isArray</span>(match.<span class="property">loader</span>.<span class="property">include</span>)
          ? match.<span class="property">loader</span>.<span class="property">include</span>
          : [match.<span class="property">loader</span>.<span class="property">include</span>];
        match.<span class="property">loader</span>.<span class="property">include</span> = include.<span class="property">concat</span>[absolutePath];
      &#125;
      <span class="keyword">return</span> webpackConfig;
    &#125;
  &#125;
&#125;;</code></pre>
</li>
<li><p>create ssr web app (next.js)</p>
<ul>
<li>åˆå§‹åŒ– ssr web app</li>
</ul>
<pre><code class="highlight bash"><span class="built_in">cd</span> packages

<span class="comment"># åˆ›å»º react ssr app</span>
yarn create next-app --example with-typescript nextjs-app</code></pre>

<ul>
<li>scripts</li>
</ul>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹<code>package.json</code>ä¸­<code>scripts</code>æ·»åŠ ä¸‹é¢è„šæœ¬</p>
<pre><code class="highlight json"><span class="punctuation">&#123;</span>
  <span class="attr">&quot;react-sap-app&quot;</span><span class="punctuation">:</span> <span class="string">&quot;yarn workspace nextjs-app dev&quot;</span>
<span class="punctuation">&#125;</span></code></pre>

<ul>
<li>é…ç½®ä½¿ç”¨æœ¬åœ° package</li>
</ul>
<pre><code class="highlight bash"><span class="comment"># æ³¨æ„âš ï¸ `next-transpile-modules`ç‰ˆæœ¬æœ‰å¾ˆå¤§åŒºåˆ«</span>
<span class="comment"># https://www.npmjs.com/package/next-transpile-modules#user-content-compatibility-table</span>
yarn add next-transpile-modules -D</code></pre>

<p>åœ¨<code>nextjs-app</code>æ ¹ç›®å½•ä¸‹æ–°å»ºåˆ›å»º<code>next.config.js</code>æ–‡ä»¶</p>
<pre><code class="highlight js"><span class="comment">// pass the modules you would like to see transpiled</span>
<span class="keyword">const</span> withTM = <span class="built_in">require</span>(<span class="string">&quot;next-transpile-modules&quot;</span>)([<span class="string">&quot;@mono/common&quot;</span>]);
<span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title function_">withTM</span>();</code></pre>
</li>
<li><p>é…ç½®</p>
</li>
<li><p>create service app (koa service)</p>
<ul>
<li>åˆå§‹åŒ– service app</li>
</ul>
<pre><code class="highlight bash">
<span class="built_in">cd</span> packages &amp;&amp; <span class="built_in">mkdir</span> koa-service-app &amp;&amp; <span class="built_in">cd</span> koa-service-app

yarn init -y

<span class="comment"># åˆ›å»ºæœåŠ¡å…¥å£</span>
<span class="built_in">touch</span> server.ts

yarn add typescript ts-node @types/node nodemon -D</code></pre>

<ul>
<li>scripts</li>
</ul>
<p>åœ¨<code>koa-service-app</code>ç›®å½•ä¸‹<code>package.json</code>ä¸­<code>scripts</code>æ·»åŠ ä¸‹é¢è„šæœ¬</p>
<pre><code class="highlight json"><span class="punctuation">&#123;</span>
  <span class="attr">&quot;dev&quot;</span><span class="punctuation">:</span> <span class="string">&quot;nodemon --watch &#x27;./**/*.ts&#x27; --watch &#x27;../common/**/*.ts&#x27; --exec &#x27;ts-node&#x27; server.ts&quot;</span>
<span class="punctuation">&#125;</span></code></pre>

<p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹<code>package.json</code>ä¸­<code>scripts</code>æ·»åŠ ä¸‹é¢è„šæœ¬</p>
<pre><code class="highlight json"><span class="punctuation">&#123;</span>
  <span class="attr">&quot;koa-service-app&quot;</span><span class="punctuation">:</span> <span class="string">&quot;yarn workspace koa-service-app dev&quot;</span>
<span class="punctuation">&#125;</span></code></pre></li>
</ul>
<h2 id="scripts-è¯´æ˜"><a href="#scripts-è¯´æ˜" class="headerlink" title="scripts è¯´æ˜"></a>scripts è¯´æ˜</h2><pre><code class="highlight bash"><span class="comment"># å¯åŠ¨ mobile app</span>
<span class="comment"># é¦–å…ˆå·²ç»å®‰è£… http-server</span>
http-server -p ./package/mobile

<span class="comment"># å¯åŠ¨ react spa app</span>
yarn workspace react-spa-app start

<span class="comment"># å¯åŠ¨ next.js ssr app</span>
yarn workspace nextjs-app dev

<span class="comment"># å¯åŠ¨ koa node server</span>
yarn workspace koa-service-app start</code></pre>

<h2 id="yarn-workspace-cli"><a href="#yarn-workspace-cli" class="headerlink" title="yarn workspace cli"></a>yarn workspace cli</h2><pre><code class="highlight bash"><span class="comment"># root install dependency xxxxx</span>
yarn add -W -D xxxxx

<span class="comment"># root remove dependency xxxxx</span>
yarn remove -W xxxxx

<span class="comment"># package app1 install dependency xxxx</span>
yarn workspace app1 add xxxx

<span class="comment"># run app1 dev</span>
yarn workspace app1 dev

<span class="comment"># build all package</span>
yarn workspaces run build</code></pre>

<h2 id="æå–å…¬å…±ä¾èµ–åŒ…"><a href="#æå–å…¬å…±ä¾èµ–åŒ…" class="headerlink" title="æå–å…¬å…±ä¾èµ–åŒ…"></a>æå–å…¬å…±ä¾èµ–åŒ…</h2><p>æŠŠå„ä¸ªé¡¹ç›®ä¸­å…¬å…±ä¾èµ–æå–åˆ°æ ¹ç›®å½•<code>package.json</code>ä¸­æ–¹ä¾¿ç»Ÿä¸€ç®¡ç†</p>
<pre><code class="highlight json"><span class="punctuation">&#123;</span>
  <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>
    <span class="attr">&quot;react&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^17.0.2&quot;</span><span class="punctuation">,</span>
    <span class="attr">&quot;react-dom&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^17.0.2&quot;</span>
  <span class="punctuation">&#125;</span><span class="punctuation">,</span>
  <span class="attr">&quot;devDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>
    <span class="attr">&quot;@craco/craco&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.1.2&quot;</span><span class="punctuation">,</span>
    <span class="attr">&quot;@types/koa&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.13.3&quot;</span><span class="punctuation">,</span>
    <span class="attr">&quot;@types/node&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^15.12.4&quot;</span><span class="punctuation">,</span>
    <span class="attr">&quot;@types/react&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^17.0.11&quot;</span><span class="punctuation">,</span>
    <span class="attr">&quot;@types/react-dom&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^17.0.8&quot;</span><span class="punctuation">,</span>
    <span class="attr">&quot;koa&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.13.1&quot;</span><span class="punctuation">,</span>
    <span class="attr">&quot;next&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^11.0.1&quot;</span><span class="punctuation">,</span>
    <span class="attr">&quot;next-transpile-modules&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^8.0.0&quot;</span><span class="punctuation">,</span>
    <span class="attr">&quot;ts-node&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^10.0.0&quot;</span><span class="punctuation">,</span>
    <span class="attr">&quot;typescript&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.3.4&quot;</span><span class="punctuation">,</span>
    <span class="attr">&quot;@testing-library/jest-dom&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.11.4&quot;</span><span class="punctuation">,</span>
    <span class="attr">&quot;@testing-library/react&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^11.1.0&quot;</span><span class="punctuation">,</span>
    <span class="attr">&quot;@testing-library/user-event&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^12.1.10&quot;</span><span class="punctuation">,</span>
    <span class="attr">&quot;@types/jest&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^26.0.15&quot;</span><span class="punctuation">,</span>
    <span class="attr">&quot;react-scripts&quot;</span><span class="punctuation">:</span> <span class="string">&quot;4.0.3&quot;</span>
  <span class="punctuation">&#125;</span>
<span class="punctuation">&#125;</span></code></pre>


<h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><ul>
<li>å¦‚æœæœ¬åœ°æ–°å¢ package è®°å¾—æ‰§è¡Œ <code>yarn install</code></li>
</ul>
<h2 id="ç‰ˆæœ¬ç®¡ç†"><a href="#ç‰ˆæœ¬ç®¡ç†" class="headerlink" title="ç‰ˆæœ¬ç®¡ç†"></a>ç‰ˆæœ¬ç®¡ç†</h2><p>å¦‚æœæƒ³å¯¹ç‰ˆæœ¬è¿›è¡Œç®¡ç†å¯ä»¥ç»“åˆ <a href="https://lerna.js.org/">leran</a></p>
<h2 id="github-åœ°å€"><a href="#github-åœ°å€" class="headerlink" title="github åœ°å€"></a>github åœ°å€</h2><p><a href="https://github.com/qqxs/monorepo">yarn workspaces monorepo</a></p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://yarnpkg.com/features/workspaces">yarn workspace</a></li>
<li><a href="https://create-react-app.dev/docs/adding-typescript">create-react-app</a></li>
<li><a href="https://nextjs.org/">next.js</a></li>
<li><a href="https://koajs.com/">koa2</a></li>
<li><a href="https://nodemon.io/">nodemon</a></li>
</ul>
]]></content>
      <categories>
        <category>Yarn</category>
      </categories>
      <tags>
        <tag>Tool</tag>
        <tag>Yarn</tag>
      </tags>
  </entry>
  <entry>
    <title>Typescript ç±»å‹æ“ä½œ</title>
    <url>/2020/11/21/typescript/type/</url>
    <content><![CDATA[<h2 id="Ts-ç±»å‹æ“ä½œ"><a href="#Ts-ç±»å‹æ“ä½œ" class="headerlink" title="Ts ç±»å‹æ“ä½œ"></a>Ts ç±»å‹æ“ä½œ</h2><ul>
<li>Partial (éƒ¨åˆ†, æŠŠæ‰€æœ‰å­—æ®µè½¬ä¸ºå¯é€‰å­—æ®µ)</li>
</ul>
<pre><code class="highlight ts"><span class="comment">/**</span>
<span class="comment"> * Make all properties in T optional</span>
<span class="comment"> */</span>
<span class="keyword">type</span> <span class="title class_">Partial</span>&lt;T&gt; = &#123;
  [P <span class="keyword">in</span> keyof T]?: T[P];
&#125;;</code></pre>

<p>exampleï¼š</p>
<pre><code class="highlight ts"><span class="keyword">type</span> partial = &#123;
  <span class="attr">name</span>: <span class="built_in">string</span>;
  <span class="title function_">getName</span>(): <span class="built_in">string</span>;
&#125;;

<span class="comment">/**</span>
<span class="comment"> * TPartial ç»“æœ</span>
<span class="comment"> * &#123;</span>
<span class="comment"> *   name?: string</span>
<span class="comment"> *   getName()?: string</span>
<span class="comment"> * &#125;</span>
<span class="comment"> */</span>
<span class="keyword">type</span> <span class="title class_">TPartial</span> = <span class="title class_">Partial</span>&lt;partial&gt;;</code></pre>

<ul>
<li>Required (éœ€è¦, æŠŠæ‰€æœ‰å­—æ®µè½¬ä¸ºå¿…é€‰å­—æ®µ)</li>
</ul>
<pre><code class="highlight ts"><span class="comment">/**</span>
<span class="comment"> * Make all properties in T required</span>
<span class="comment"> */</span>
<span class="keyword">type</span> <span class="title class_">Required</span>&lt;T&gt; = &#123;
  [P <span class="keyword">in</span> keyof T]-?: T[P];
&#125;;</code></pre>

<p>example:</p>
<pre><code class="highlight ts"><span class="keyword">type</span> required = &#123;
  name?: <span class="built_in">string</span>;
  <span class="title function_">getName</span>(): <span class="built_in">string</span>;
&#125;;

<span class="comment">/**</span>
<span class="comment"> * TRequired ç»“æœ</span>
<span class="comment"> * &#123;</span>
<span class="comment"> *   name: string</span>
<span class="comment"> *   getName(): string</span>
<span class="comment"> * &#125;</span>
<span class="comment"> */</span>
<span class="keyword">type</span> <span class="title class_">TRequired</span> = <span class="title class_">Required</span>&lt;required&gt;;</code></pre>

<ul>
<li>Readonly (åªè¯»ï¼ŒæŠŠæ‰€æœ‰å­—æ®µè½¬ä¸ºåªè¯»å­—æ®µ)</li>
</ul>
<pre><code class="highlight ts"><span class="comment">/**</span>
<span class="comment"> * Make all properties in T readonly</span>
<span class="comment"> */</span>
<span class="keyword">type</span> <span class="title class_">Readonly</span>&lt;T&gt; = &#123;
  <span class="keyword">readonly</span> [P <span class="keyword">in</span> keyof T]: T[P];
&#125;;</code></pre>

<p>example:</p>
<pre><code class="highlight ts"><span class="keyword">type</span> <span class="title class_">Treadonly</span> = &#123;
  name?: <span class="built_in">string</span>;
  <span class="title function_">getName</span>(): <span class="built_in">string</span>;
&#125;;

<span class="comment">/**</span>
<span class="comment"> * TReadonly ç»“æœ</span>
<span class="comment"> * &#123;</span>
<span class="comment"> *   readonly name?: string</span>
<span class="comment"> *   readonly getName(): string</span>
<span class="comment"> * &#125;</span>
<span class="comment"> */</span>
<span class="keyword">type</span> <span class="title class_">TReadonly</span> = <span class="title class_">Readonly</span>&lt;<span class="title class_">Treadonly</span>&gt;;</code></pre>

<ul>
<li>Pick (æŒ‘é€‰, æŒ‘é€‰æŒ‡å®šçš„å­—æ®µ)</li>
</ul>
<pre><code class="highlight ts"><span class="comment">/**</span>
<span class="comment"> * From T, pick a set of properties whose keys are in the union K</span>
<span class="comment"> */</span>
<span class="keyword">type</span> <span class="title class_">Pick</span>&lt;T, K <span class="keyword">extends</span> keyof T&gt; = &#123;
  [P <span class="keyword">in</span> K]: T[P];
&#125;;</code></pre>

<p>example:</p>
<pre><code class="highlight ts"><span class="keyword">type</span> pick = &#123;
  name?: <span class="built_in">string</span>;
  <span class="attr">age</span>: <span class="built_in">number</span>;
  <span class="title function_">getName</span>(): <span class="built_in">string</span>;
&#125;;

<span class="comment">/**</span>
<span class="comment"> * TPick ç»“æœ</span>
<span class="comment"> * &#123;</span>
<span class="comment"> *   name?: string</span>
<span class="comment"> *   age: number</span>
<span class="comment"> * &#125;</span>
<span class="comment"> */</span>
<span class="keyword">type</span> <span class="title class_">TPick</span> = <span class="title class_">Pick</span>&lt;pick, <span class="string">&quot;name&quot;</span> | <span class="string">&quot;age&quot;</span>&gt;;</code></pre>

<ul>
<li>Record(è®°å½•,å°† K ä¸­æ‰€æœ‰çš„å±æ€§çš„å€¼è½¬åŒ–ä¸º T ç±»å‹)</li>
</ul>
<pre><code class="highlight ts"><span class="comment">/**</span>
<span class="comment"> * Construct a type with a set of properties K of type T</span>
<span class="comment"> */</span>
<span class="keyword">type</span> <span class="title class_">Record</span>&lt;K <span class="keyword">extends</span> keyof <span class="built_in">any</span>, T&gt; = &#123;
  [P <span class="keyword">in</span> K]: T;
&#125;;</code></pre>

<p>example:</p>
<pre><code class="highlight ts"><span class="keyword">type</span> record = &#123;
  name?: <span class="built_in">string</span>;
  <span class="attr">age</span>: <span class="built_in">number</span>;
  <span class="title function_">getName</span>(): <span class="built_in">string</span>;
&#125;;

<span class="comment">/**</span>
<span class="comment"> * TRecord ç»“æœ</span>
<span class="comment"> * &#123;</span>
<span class="comment"> *   name: string</span>
<span class="comment"> *   age: string</span>
<span class="comment"> *   getName: string</span>
<span class="comment"> * &#125;</span>
<span class="comment"> */</span>
<span class="keyword">type</span> <span class="title class_">TRecord</span> = <span class="title class_">Record</span>&lt;keyof record, <span class="built_in">string</span>&gt;;

<span class="comment">/**</span>
<span class="comment"> * Ta ç»“æœ</span>
<span class="comment"> * &#123;</span>
<span class="comment"> *   a: number</span>
<span class="comment"> *   b: number</span>
<span class="comment"> *   c: number</span>
<span class="comment"> *   1: number</span>
<span class="comment"> * &#125;</span>
<span class="comment"> */</span>
<span class="keyword">type</span> <span class="title class_">Ta</span> = <span class="title class_">Record</span>&lt;<span class="string">&quot;a&quot;</span> | <span class="string">&quot;b&quot;</span> | <span class="string">&quot;c&quot;</span> | <span class="number">1</span>, <span class="built_in">number</span>&gt;;</code></pre>

<ul>
<li>Exclude(æ’é™¤,ä» T ä¸­æ’é™¤é‚£äº›å¯åˆ†é…ç»™ U çš„ç±»å‹ï¼Œ)</li>
</ul>
<pre><code class="highlight ts"><span class="comment">/**</span>
<span class="comment"> * Exclude from T those types that are assignable to U</span>
<span class="comment"> */</span>
<span class="keyword">type</span> <span class="title class_">Exclude</span>&lt;T, U&gt; = T <span class="keyword">extends</span> U ? <span class="built_in">never</span> : T;</code></pre>

<p>example:</p>
<pre><code class="highlight ts"><span class="keyword">type</span> T = <span class="title class_">Exclude</span>&lt;<span class="number">1</span> | <span class="number">2</span>, <span class="number">1</span> | <span class="number">3</span>&gt;; <span class="comment">// -&gt; 2</span></code></pre>

<ul>
<li>Extract(æå–,ä» T ä¸­æå–å¯åˆ†é…ç»™ U çš„ç±»å‹ï¼Œ äº¤é›†)</li>
</ul>
<pre><code class="highlight ts"><span class="comment">/**</span>
<span class="comment"> * Extract from T those types that are assignable to U</span>
<span class="comment"> */</span>
<span class="keyword">type</span> <span class="title class_">Extract</span>&lt;T, U&gt; = T <span class="keyword">extends</span> U ? T : <span class="built_in">never</span>;</code></pre>

<p>example:</p>
<pre><code class="highlight ts"><span class="keyword">type</span> T = <span class="title class_">Extract</span>&lt;<span class="number">1</span> | <span class="number">2</span>, <span class="number">1</span> | <span class="number">3</span>&gt;; <span class="comment">// -&gt; 1</span></code></pre>

<ul>
<li>Omit (åˆ å», æ„é€ ä¸€ä¸ªé™¤ K ç±»å‹å¤–å…·æœ‰ T å±æ€§çš„ç±»å‹ã€‚)</li>
</ul>
<pre><code class="highlight ts"><span class="comment">/**</span>
<span class="comment"> * Construct a type with the properties of T except for those in type K.</span>
<span class="comment"> */</span>
<span class="keyword">type</span> <span class="title class_">Omit</span>&lt;T, K <span class="keyword">extends</span> keyof <span class="built_in">any</span>&gt; = <span class="title class_">Pick</span>&lt;T, <span class="title class_">Exclude</span>&lt;keyof T, K&gt;&gt;;</code></pre>

<p>example:</p>
<pre><code class="highlight ts"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;
  <span class="attr">name</span>: <span class="built_in">string</span>;
  <span class="attr">age</span>: <span class="built_in">number</span>;
  <span class="attr">location</span>: <span class="built_in">string</span>;
&#125;

<span class="comment">/**</span>
<span class="comment"> * OmitPerson ç»“æœ</span>
<span class="comment"> * &#123;</span>
<span class="comment"> *   location: string</span>
<span class="comment"> * &#125;</span>
<span class="comment"> */</span>
<span class="keyword">type</span> <span class="title class_">OmitPerson</span> = <span class="title class_">Omit</span>&lt;<span class="title class_">Person</span>, <span class="string">&quot;name&quot;</span> | <span class="string">&quot;age&quot;</span>&gt;;</code></pre>

<ul>
<li>æ•°ç»„</li>
</ul>
<pre><code class="highlight ts"><span class="comment">/** arr1Example ä¸­åªå¯ä»¥ä½¿ç”¨`string`ç±»å‹å¡«å…… */</span>
<span class="keyword">type</span> arr1 = <span class="built_in">string</span>[]; <span class="comment">// å»ºè®®ä½¿ç”¨[]</span>
<span class="keyword">const</span> <span class="attr">arr1Example</span>: arr1 = [<span class="string">&quot;123&quot;</span>, <span class="string">&quot;23454&quot;</span>];

<span class="comment">/** arr2Example ä¸­åªå¯ä»¥ä½¿ç”¨[`string`,`number`]ç±»å‹å¡«å……ï¼Œå¿…é¡»æŒ‰é¡ºåºå¡«å……, ä¸ªæ•°ä¹Ÿæœ‰é™åˆ¶ */</span>
<span class="keyword">type</span> arr2 = [<span class="built_in">string</span>, <span class="built_in">number</span>];
<span class="keyword">const</span> <span class="attr">arr2Example</span>: arr2 = [<span class="string">&quot;0&quot;</span>, <span class="number">1</span>];

<span class="comment">/** arr3Example ä¸­åªå¯ä»¥ä½¿ç”¨`string`æˆ–`number`ç±»å‹å¡«å……ï¼Œæ²¡æœ‰é¡ºåºè¦æ±‚ */</span>
<span class="keyword">type</span> arr3 = (<span class="built_in">string</span> | <span class="built_in">number</span>)[];
<span class="keyword">const</span> <span class="attr">arr3Example</span>: arr3 = [<span class="number">0</span>, <span class="string">&quot;1&quot;</span>, <span class="string">&quot;2&quot;</span>, <span class="number">3</span>, <span class="number">4</span>];</code></pre>

<ul>
<li>å¯¹è±¡</li>
</ul>
<pre><code class="highlight ts"><span class="keyword">interface</span> <span class="title class_">Persion</span>&lt;T&gt; &#123;
  [<span class="attr">key</span>: T]: T;
&#125;</code></pre>

<ul>
<li><p>extends</p>
</li>
<li><p>keyof (å¯¹äºä»»ä½•ç±»å‹ <code>T</code>ï¼Œ <code>keyof T</code>çš„ç»“æœä¸º <code>T</code>ä¸Šå·²çŸ¥çš„å…¬å…±å±æ€§åçš„è”åˆ)</p>
</li>
</ul>
<pre><code class="highlight ts"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;
  <span class="attr">name</span>: <span class="built_in">string</span>;
  <span class="attr">age</span>: <span class="built_in">number</span>;
&#125;

<span class="keyword">type</span> p = keyof <span class="title class_">Person</span>; <span class="comment">// -&gt; p = &#x27;name&#x27; | &#x27;age&#x27;</span></code></pre>

<ul>
<li>typeof</li>
</ul>
<pre><code class="highlight ts"></code></pre>

<ul>
<li>äº¤å‰ç±»å‹ (äº¤å‰ç±»å‹æ˜¯å°†å¤šä¸ªç±»å‹åˆå¹¶ä¸ºä¸€ä¸ªç±»å‹)</li>
</ul>
<pre><code class="highlight ts"><span class="keyword">interface</span>;</code></pre>

<ul>
<li>è”åˆç±»å‹ (è”åˆç±»å‹è¡¨ç¤ºä¸€ä¸ªå€¼å¯ä»¥æ˜¯å‡ ç§ç±»å‹ä¹‹ä¸€,ç”¨ç«–çº¿<code>ï½œ</code>åˆ†éš”æ¯ä¸ªç±»å‹)</li>
</ul>
<pre><code class="highlight ts"><span class="keyword">function</span> <span class="title function_">getNum</span>(<span class="params"><span class="attr">num</span>: <span class="built_in">number</span> | <span class="built_in">string</span></span>): <span class="built_in">number</span> &#123;
  <span class="keyword">return</span> +num;
&#125;</code></pre>

<ul>
<li>ç´¢å¼•ç±»å‹</li>
</ul>
<pre><code class="highlight ts"></code></pre>

<ul>
<li>æ˜ å°„ç±»å‹</li>
</ul>
<pre><code class="highlight ts"></code></pre>

<ul>
<li>@4.1</li>
</ul>
<pre><code class="highlight ts">  <span class="comment">// @4.1</span>
<span class="keyword">type</span> <span class="title class_">Getters</span>&lt;T&gt; = &#123;
  <span class="comment">//</span>
  [K <span class="keyword">in</span> keyof T <span class="keyword">as</span> <span class="string">`get<span class="subst">$&#123;capitalize K&#125;</span>`</span>]: <span class="function">() =&gt;</span> T[K]
&#125;

<span class="keyword">interface</span> <span class="title class_">Person</span> &#123;
	<span class="attr">name</span>: <span class="built_in">string</span>;
	<span class="attr">age</span>: <span class="built_in">number</span>;
	<span class="attr">location</span>: <span class="built_in">string</span>;
&#125;

<span class="comment">/**</span>
<span class="comment">* LazyPerson ç»“æœ</span>
<span class="comment">* &#123;</span>
<span class="comment">*   name: string</span>
<span class="comment">*   age: number</span>
<span class="comment">*   location: string</span>
<span class="comment">*   getName: () =&gt; string</span>
<span class="comment">*   getAge: () =&gt; number</span>
<span class="comment">*   getLocation: () =&gt; string</span>
<span class="comment">* &#125;</span>
<span class="comment">*/</span>
<span class="keyword">type</span> <span class="title class_">LazyPerson</span> = <span class="title class_">Getters</span>&lt;<span class="title class_">Person</span>&gt;;</code></pre>

<ul>
<li><p>React ä¸­çš„ç±»å‹çº¦æŸ</p>
<ul>
<li>FC (å‡½æ•°ç»„ä»¶ç±»å‹)</li>
</ul>
<pre><code class="highlight tsx"><span class="keyword">interface</span> <span class="title class_">FunctionComponent</span>&lt;P = &#123;&#125;&gt; &#123;
  (<span class="attr">props</span>: <span class="title class_">PropsWithChildren</span>&lt;P&gt;, context?: <span class="built_in">any</span>): <span class="title class_">ReactElement</span>&lt;<span class="built_in">any</span>, <span class="built_in">any</span>&gt; | <span class="literal">null</span>;
  propTypes?: <span class="title class_">WeakValidationMap</span>&lt;P&gt;;
  contextTypes?: <span class="title class_">ValidationMap</span>&lt;<span class="built_in">any</span>&gt;;
  defaultProps?: <span class="title class_">Partial</span>&lt;P&gt;;
  displayName?: <span class="built_in">string</span>;
&#125;

<span class="keyword">type</span> <span class="variable constant_">FC</span>&lt;P = &#123;&#125;&gt; = <span class="title class_">FunctionComponent</span>&lt;P&gt;;

<span class="comment">// å…·ä½“ä½¿ç”¨</span>
<span class="keyword">interface</span> <span class="title class_">IProps</span> &#123;&#125;
<span class="keyword">const</span> <span class="title class_">App</span>: <span class="variable constant_">FC</span>&lt;<span class="title class_">IProps</span>&gt; = <span class="function"><span class="params">props</span> =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;props.children&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</code></pre>

<ul>
<li><p>useState</p>
<p>React ä¸­ä½¿ç”¨<code>useState</code>æ–¹æ³•å»è®¾ç½® state</p>
</li>
</ul>
<pre><code class="highlight tsx"><span class="keyword">function</span> useState&lt;S&gt;(
  <span class="attr">initialState</span>: S | (<span class="function">() =&gt;</span> S)
): [S, <span class="title class_">Dispatch</span>&lt;<span class="title class_">SetStateAction</span>&lt;S&gt;&gt;];</code></pre></li>
</ul>
]]></content>
      <categories>
        <category>Typescript</category>
      </categories>
      <tags>
        <tag>Typescript</tag>
      </tags>
  </entry>
  <entry>
    <title>webpack5 é…ç½®é¡¹</title>
    <url>/2022/11/13/webpack/config/</url>
    <content><![CDATA[<h2 id="webpack5-é…ç½®é¡¹"><a href="#webpack5-é…ç½®é¡¹" class="headerlink" title="webpack5 é…ç½®é¡¹"></a>webpack5 é…ç½®é¡¹</h2><p>webpack <a href="https://sourcegraph.com/github.com/webpack/webpack@main/-/blob/declarations/WebpackOptions.d.ts">WebpackOptions</a></p>
<p><a href="https://webpack.docschina.org/configuration/other-options">https://webpack.docschina.org/configuration/other-options</a></p>
<pre><code class="highlight ts"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">WebpackOptions</span> &#123;
  <span class="comment">/**</span>
<span class="comment">   * è®¾ç½®`require.amd`å’Œ`define.amd`çš„å€¼ã€‚æˆ–è€…ç¦ç”¨AMDæ”¯æŒã€‚</span>
<span class="comment">   */</span>
  amd?: <span class="literal">false</span> | &#123; [<span class="attr">k</span>: <span class="built_in">string</span>]: <span class="built_in">any</span> &#125;;
  <span class="comment">/**</span>
<span class="comment">   * åœ¨ç¬¬ä¸€ä¸ªé”™è¯¯å‡ºç°æ—¶æŠ›å‡ºå¤±è´¥ç»“æœï¼Œè€Œä¸æ˜¯å®¹å¿å®ƒ;  true: å°†ä¼šè‡´ä½¿ webpack åœ¨å‘ç°é”™è¯¯æ—¶å°½å¿«é€€å‡ºã€‚</span>
<span class="comment">   */</span>
  bail?: <span class="built_in">boolean</span>;
  <span class="comment">/**</span>
<span class="comment">   * ç¼“å­˜ç”Ÿæˆçš„ modules å’Œ chunksï¼Œä»¥æé«˜å¤šä¸ªå¢é‡æ„å»ºçš„æ€§èƒ½ã€‚</span>
<span class="comment">   */</span>
  cache?: <span class="built_in">boolean</span> | <span class="title class_">MemoryCacheOptions</span> | <span class="title class_">FileCacheOptions</span>;
  <span class="comment">/**</span>
<span class="comment">   * åŸºæœ¬ç›®å½•ï¼ˆç»å¯¹è·¯å¾„ï¼ï¼‰ç”¨äºè§£æ`entry`é€‰é¡¹ã€‚å¦‚æœè®¾ç½®äº†`output.pathinfo`ï¼Œåˆ™åŒ…å«çš„pathinfoå°†ç¼©çŸ­åˆ°æ­¤ç›®å½•ã€‚</span>
<span class="comment">   */</span>
  context?: <span class="built_in">string</span>; <span class="comment">// Context;</span>
  <span class="comment">/**</span>
<span class="comment">   * å¯¹è¦ä¾èµ–çš„å…¶ä»–é…ç½®çš„å¼•ç”¨ã€‚</span>
<span class="comment">   */</span>
  dependencies?: <span class="built_in">string</span>[]; <span class="comment">// Dependencies;</span>
  <span class="comment">/**</span>
<span class="comment">   * https://webpack.js.org/configuration/dev-server/</span>
<span class="comment">   * webpack-dev-serverçš„é€‰é¡¹</span>
<span class="comment">   */</span>
  devServer?: <span class="title class_">DevServer</span>;
  <span class="comment">/**</span>
<span class="comment">   * ç”¨äºå¢å¼ºè°ƒè¯•çš„å¼€å‘å·¥å…· (false | eval | [inline-|hidden-|eval-][nosources-][cheap-[module-]]source-map).</span>
<span class="comment">   */</span>
  devtool?: <span class="title class_">DevTool</span>;
  <span class="comment">/**</span>
<span class="comment">   * ç¼–è¯‘çš„å…¥å£ç‚¹</span>
<span class="comment">   */</span>
  entry?: <span class="title class_">Entry</span>;
  <span class="comment">/**</span>
<span class="comment">   * å¯ç”¨/ç¦ç”¨å®éªŒï¼ˆå…·æœ‰relax-SemVerå…¼å®¹æ€§çš„å®éªŒåŠŸèƒ½ï¼‰</span>
<span class="comment">   */</span>
  experiments?: <span class="title class_">Experiments</span>;
  <span class="comment">/**</span>
<span class="comment">   * æŒ‡å®šä¸åº”è¯¥ç”±webpackè§£æï¼Œä½†åº”è¯¥æˆä¸ºç»“æœåŒ…çš„ä¾èµ–é¡¹çš„ä¾èµ–é¡¹ã€‚ä¾èµ–å…³ç³»çš„ç±»å‹å–å†³äº`output.libraryTarget`ã€‚</span>
<span class="comment">   */</span>
  externals?: <span class="title class_">Externals</span>;
  <span class="comment">/**</span>
<span class="comment">   * ä¸ºç‰¹å®šç›®æ ‡å¯ç”¨å¤–éƒ¨é¢„è®¾</span>
<span class="comment">   */</span>
  externalsPresets?: <span class="title class_">ExternalsPresets</span>;
  <span class="comment">/**</span>
<span class="comment">   * æŒ‡å®šå¤–éƒ¨çš„é»˜è®¤ç±»å‹ï¼ˆ&#x27;amd*&#x27;ã€&#x27;umd*&#x27;ï¼Œ&#x27;system&#x27;å’Œ&#x27;jsonp&#x27;å–å†³äºè®¾ç½®ä¸ºç›¸åŒå€¼çš„output.libraryTargetï¼‰ã€‚</span>
<span class="comment">   */</span>
  externalsType?: <span class="title class_">ExternalsType</span>;
  <span class="comment">/**</span>
<span class="comment">   * https://webpack.docschina.org/configuration/other-options/#ignorewarnings</span>
<span class="comment">   * å¿½ç•¥ç‰¹å®šè­¦å‘Š</span>
<span class="comment">   */</span>
  ignoreWarnings?: <span class="title class_">IgnoreWarnings</span>;
  <span class="comment">/**</span>
<span class="comment">   * https://webpack.docschina.org/configuration/other-options/#infrastructurelogging</span>
<span class="comment">   * ç”¨äºåŸºç¡€è®¾æ–½æ°´å¹³çš„æ—¥å¿—é€‰é¡¹</span>
<span class="comment">   */</span>
  infrastructureLogging?: <span class="title class_">InfrastructureLogging</span>;
  <span class="comment">/**</span>
<span class="comment">   * https://webpack.docschina.org/configuration/other-options/#loader</span>
<span class="comment">   * loaderä¸Šä¸‹æ–‡ä¸­å¯ç”¨çš„è‡ªå®šä¹‰å€¼</span>
<span class="comment">   */</span>
  loader?: <span class="title class_">Loader</span>;
  <span class="comment">/**</span>
<span class="comment">   * å¯ç”¨ç”Ÿäº§ä¼˜åŒ–æˆ–å¼€å‘æç¤º</span>
<span class="comment">   */</span>
  mode?: <span class="string">&quot;development&quot;</span> | <span class="string">&quot;production&quot;</span> | <span class="string">&quot;none&quot;</span>;
  <span class="comment">/**</span>
<span class="comment">   * å½±å“æ­£å¸¸æ¨¡å—çš„é€‰é¡¹ï¼ˆ`NormalModuleFactory`ï¼‰</span>
<span class="comment">   */</span>
  <span class="variable language_">module</span>?: <span class="title class_">ModuleOptions</span>;
  <span class="comment">/**</span>
<span class="comment">   * https://webpack.docschina.org/configuration/other-options/#name</span>
<span class="comment">   * é…ç½®çš„åç§°ã€‚åŠ è½½å¤šä¸ªé…ç½®æ—¶ä½¿ç”¨ã€‚</span>
<span class="comment">   */</span>
  name?: <span class="built_in">string</span>; <span class="comment">//Name;</span>
  <span class="comment">/**</span>
<span class="comment">   * åŒ…æ‹¬å„ç§èŠ‚ç‚¹å¡«å……çš„polyfillæˆ–mock</span>
<span class="comment">   */</span>
  node?: <span class="title class_">Node</span>;
  <span class="comment">/**</span>
<span class="comment">   * https://webpack.docschina.org/configuration/optimization/#root</span>
<span class="comment">   * å¯ç”¨/ç¦ç”¨é›†æˆä¼˜åŒ–</span>
<span class="comment">   */</span>
  optimization?: <span class="title class_">Optimization</span>;
  <span class="comment">/**</span>
<span class="comment">   * Options affecting the output of the compilation. `output` options tell webpack how to write the compiled files to disk.</span>
<span class="comment">   * å½±å“ç¼–è¯‘è¾“å‡ºçš„é€‰é¡¹. `output`é€‰é¡¹å‘Šè¯‰`webpack`å¦‚ä½•å°†ç¼–è¯‘åçš„æ–‡ä»¶å†™å…¥ç£ç›˜ã€‚</span>
<span class="comment">   */</span>
  output?: <span class="title class_">Output</span>;
  <span class="comment">/**</span>
<span class="comment">   * https://webpack.docschina.org/configuration/other-options/#parallelism</span>
<span class="comment">   * ç¼–è¯‘ä¸­å¹¶è¡Œå¤„ç†çš„æ¨¡å—æ•°</span>
<span class="comment">   * é»˜è®¤ 100</span>
<span class="comment">   */</span>
  parallelism?: <span class="built_in">number</span>; <span class="comment">//Parallelism;</span>
  <span class="comment">/**</span>
<span class="comment">   * https://webpack.docschina.org/configuration/performance/#root</span>
<span class="comment">   * webæ€§èƒ½å»ºè®®çš„é…ç½®</span>
<span class="comment">   */</span>
  performance?: <span class="title class_">Performance</span>;
  <span class="comment">/**</span>
<span class="comment">   * https://webpack.docschina.org/configuration/plugins/#plugins</span>
<span class="comment">   * å‘ç¼–è¯‘å™¨æ·»åŠ å…¶ä»–æ’ä»¶.</span>
<span class="comment">   *</span>
<span class="comment">   * https://sourcegraph.com/github.com/webpack/webpack-cli/-/blob/packages/webpack-cli/src/plugins/CLIPlugin.ts?L11</span>
<span class="comment">   * webpack-cli ä¼šé»˜è®¤åœ¨æ•°ç»„çš„æœ€å‰é¢æ’å…¥ CLIPlugin çš„å®ä¾‹  (why ??) ä¸»è¦æ˜¯åœ¨æ§åˆ¶å°è¾“å‡ºå†…å®¹ï¼ˆæ‰“å°æ—¥å¿—ï¼‰</span>
<span class="comment">   */</span>
  plugins?: <span class="title class_">Plugins</span>;
  <span class="comment">/**</span>
<span class="comment">   * https://webpack.docschina.org/configuration/other-options/#profile</span>
<span class="comment">   * æ•è·æ¯ä¸ªæ¨¡å—çš„è®¡æ—¶ä¿¡æ¯</span>
<span class="comment">   */</span>
  profile?: <span class="title class_">Profile</span>;
  <span class="comment">/**</span>
<span class="comment">   * https://webpack.docschina.org/configuration/other-options/#recordsinputpath</span>
<span class="comment">   * å°†ç¼–è¯‘å™¨çŠ¶æ€å­˜å‚¨åˆ°jsonæ–‡ä»¶ä¸­, æŒ‡å®šè¯»å–æœ€åä¸€æ¡è®°å½•çš„æ–‡ä»¶çš„åç§°ã€‚è¿™å¯ä»¥ç”¨æ¥é‡å‘½åä¸€ä¸ªè®°å½•æ–‡ä»¶</span>
<span class="comment">   */</span>
  recordsInputPath?: <span class="built_in">string</span> | <span class="literal">false</span>; <span class="comment">// RecordsInputPath;</span>
  <span class="comment">/**</span>
<span class="comment">   * https://webpack.docschina.org/configuration/other-options/#recordsoutputpath</span>
<span class="comment">   * ä»jsonæ–‡ä»¶åŠ è½½ç¼–è¯‘å™¨çŠ¶æ€</span>
<span class="comment">   */</span>
  recordsOutputPath?: <span class="built_in">string</span> | <span class="literal">false</span>; <span class="comment">// RecordsOutputPath;</span>
  <span class="comment">/**</span>
<span class="comment">   * https://webpack.docschina.org/configuration/other-options/#recordspath</span>
<span class="comment">   * å¼€å¯è¿™ä¸ªé€‰é¡¹å¯ä»¥ç”Ÿæˆä¸€ä¸ª JSON æ–‡ä»¶ï¼Œå…¶ä¸­å«æœ‰ webpack çš„ &quot;records&quot; è®°å½• - å³ã€Œç”¨äºå­˜å‚¨è·¨å¤šæ¬¡æ„å»º(across multiple builds)çš„æ¨¡å—æ ‡è¯†ç¬¦ã€çš„æ•°æ®ç‰‡æ®µã€‚å¯ä»¥ä½¿ç”¨æ­¤æ–‡ä»¶æ¥è·Ÿè¸ªåœ¨æ¯æ¬¡æ„å»ºä¹‹é—´çš„æ¨¡å—å˜åŒ–ã€‚åªè¦ç®€å•çš„è®¾ç½®ä¸€ä¸‹è·¯å¾„,å°±å¯ä»¥ç”Ÿæˆè¿™ä¸ª JSON æ–‡ä»¶</span>
<span class="comment">   */</span>
  recordsPath?: <span class="title class_">RecordsPath</span>;
  <span class="comment">/**</span>
<span class="comment">   * è§£æå™¨é€‰é¡¹</span>
<span class="comment">   */</span>
  resolve?: <span class="title class_">Resolve</span>;
  <span class="comment">/**</span>
<span class="comment">   * https://webpack.docschina.org/configuration/resolve/#resolveloader</span>
<span class="comment">   * è§£æloadersæ—¶è§£æç¨‹åºçš„é€‰é¡¹</span>
<span class="comment">   */</span>
  resolveLoader?: <span class="title class_">ResolveLoader</span>;
  <span class="comment">/**</span>
<span class="comment">   * å½±å“æ–‡ä»¶ç³»ç»Ÿå¿«ç…§åˆ›å»ºå’ŒéªŒè¯æ–¹å¼çš„é€‰</span>
<span class="comment">   */</span>
  snapshot?: <span class="title class_">SnapshotOptions</span>;
  <span class="comment">/**</span>
<span class="comment">   * ç»Ÿè®¡é€‰é¡¹å¯¹è±¡æˆ–é¢„è®¾åç§°</span>
<span class="comment">   * é»˜è®¤: &#123;colors:false,preset:&#x27;normal&#x27;&#125;</span>
<span class="comment">   */</span>
  stats?: <span class="title class_">StatsValue</span>;
  <span class="comment">/**</span>
<span class="comment">   * è¦æ„å»ºçš„ç¯å¢ƒã€‚å°½å¯èƒ½ä¸ºæ‰€æœ‰ç”¨æˆ·æ„å»ºä¸€ç³»åˆ—ç¯å¢ƒ</span>
<span class="comment">   */</span>
  target?: <span class="built_in">string</span> | <span class="literal">false</span> | <span class="built_in">string</span>[]; <span class="comment">// Target;</span>
  <span class="comment">/**</span>
<span class="comment">   * https://webpack.docschina.org/configuration/watch#root</span>
<span class="comment">   * å¯ç”¨ Watch æ¨¡å¼ï¼Œè¯¥æ¨¡å¼å°†åœ¨æ–‡ä»¶æ›´æ”¹æ—¶é‡å»º</span>
<span class="comment">   * Compiler æ”¯æŒå¯ä»¥ç›‘æ§æ–‡ä»¶ç³»ç»Ÿçš„ ç›‘å¬(watching) æœºåˆ¶ï¼Œå¹¶ä¸”åœ¨æ–‡ä»¶ä¿®æ”¹æ—¶é‡æ–°ç¼–è¯‘ã€‚</span>
<span class="comment">   * å½“å¤„äºç›‘å¬æ¨¡å¼(watch mode)æ—¶ï¼Œ compiler ä¼šè§¦å‘è¯¸å¦‚ watchRun, watchClose å’Œ invalid ç­‰é¢å¤–çš„äº‹ä»¶</span>
<span class="comment">   *</span>
<span class="comment">   */</span>
  watch?: <span class="built_in">boolean</span>; <span class="comment">// Watch;</span>
  <span class="comment">/**</span>
<span class="comment">   * https://webpack.docschina.org/configuration/watch#watchoptions</span>
<span class="comment">   * ä¸€ç»„ç”¨æ¥å®šåˆ¶ watch æ¨¡å¼çš„é€‰é¡¹</span>
<span class="comment">   */</span>
  watchOptions?: <span class="title class_">WatchOptions</span>;
&#125;</code></pre>

<h2 id="loader"><a href="#loader" class="headerlink" title="loader"></a>loader</h2><pre><code class="highlight ts"><span class="comment">/**</span>
<span class="comment"> * Custom values available in the loader context.</span>
<span class="comment"> */</span>
<span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">Loader</span> &#123;
  [<span class="attr">k</span>: <span class="built_in">string</span>]: <span class="built_in">any</span>;
&#125;</code></pre>

<h2 id="plugin"><a href="#plugin" class="headerlink" title="plugin"></a>plugin</h2><pre><code class="highlight ts"><span class="comment">/**</span>
<span class="comment"> * å‘ç¼–è¯‘å™¨æ·»åŠ å…¶ä»–æ’ä»¶</span>
<span class="comment"> */</span>
<span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">Plugins</span> = (<span class="title class_">WebpackPluginInstance</span> | <span class="title class_">WebpackPluginFunction</span>)[];

<span class="comment">/**</span>
<span class="comment"> * æ’ä»¶å®ä¾‹</span>
<span class="comment"> */</span>
<span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">WebpackPluginInstance</span> &#123;
  <span class="comment">/**</span>
<span class="comment">   * The run point of the plugin, required method.</span>
<span class="comment">   */</span>
  <span class="attr">apply</span>: <span class="function">(<span class="params"><span class="attr">compiler</span>: <span class="keyword">import</span>(<span class="string">&quot;../lib/Compiler&quot;</span>)</span>) =&gt;</span> <span class="built_in">void</span>;
  [<span class="attr">k</span>: <span class="built_in">string</span>]: <span class="built_in">any</span>;
&#125;

<span class="comment">/**</span>
<span class="comment"> * Function acting as plugin.</span>
<span class="comment"> */</span>
<span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">WebpackPluginFunction</span> = <span class="function">(<span class="params"></span></span>
<span class="params"><span class="function">  <span class="attr">this</span>: <span class="keyword">import</span>(<span class="string">&quot;../lib/Compiler&quot;</span>),</span></span>
<span class="params"><span class="function">  <span class="attr">compiler</span>: <span class="keyword">import</span>(<span class="string">&quot;../lib/Compiler&quot;</span>)</span></span>
<span class="params"><span class="function"></span>) =&gt;</span> <span class="built_in">void</span>;</code></pre>
]]></content>
      <categories>
        <category>Webpack</category>
      </categories>
      <tags>
        <tag>Tool</tag>
        <tag>Webpack5</tag>
      </tags>
  </entry>
  <entry>
    <title>tapable ä½¿ç”¨éšç¬”</title>
    <url>/2022/11/28/webpack/tapable/</url>
    <content><![CDATA[<h2 id="tapable"><a href="#tapable" class="headerlink" title="tapable"></a>tapable</h2><p>The <a href="https://github.com/webpack/tapable">tapable</a> package expose many Hook classes, which can be used to create hooks for plugins.</p>
<p><code>tapable</code> æ˜¯ä¸€ä¸ªå‘å¸ƒè®¢é˜…æ¨¡å¼çš„å®ç°ï¼Œå®ƒæä¾›äº†å¾ˆå¤šåº”å¯¹ä¸šåŠ¡çš„ <code>hooks</code> å®ç°å’ŒæŠ½è±¡ã€‚ä¸»è¦åˆ†ä¸ºä¸¤å¤§ç±»åŒæ­¥å’Œå¼‚æ­¥ã€‚</p>
<h2 id="Base-Hooks"><a href="#Base-Hooks" class="headerlink" title="Base Hooks"></a>Base Hooks</h2><ul>
<li><a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/Hook.js?L25:1">Hooks</a></li>
</ul>
<p>ç»§æ‰¿ <code>Hooks</code> çš„ç±»éœ€è¦è‡ªå·±å®ç°<code>compile</code>æŠ½è±¡æ–¹æ³•ã€‚</p>
<ul>
<li><a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/HookCodeFactory.js?L7:1">HookCodeFactory</a></li>
</ul>
<p>ç»§æ‰¿<code>HookCodeFactory</code>ç±»éœ€è¦å®ç°æŠ½è±¡æ–¹æ³•<code>content</code>, è¿”å› <code>call</code>æˆ–<code>callAsync</code>æˆ–<code>promise</code> çš„å‡½æ•°ä½“çš„å®ç°çš„ä»£ç å­—ç¬¦ä¸²ï¼Œ ç„¶åä½¿ç”¨ <code>Function</code> ç”Ÿæˆä¸€ä¸ª<code>call</code>æˆ–<code>callAsync</code>æˆ–<code>promise</code> å‡½æ•°</p>
<h2 id="SyncHook"><a href="#SyncHook" class="headerlink" title="SyncHook"></a>SyncHook</h2><p><a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/SyncHook.js?L35:1">SyncHook</a> æŒ‰æ³¨å†Œçš„å›è°ƒå‡½æ•°ä¸²è¡Œä¹‹è¡Œã€‚</p>
<p>ç®€å•ä½¿ç”¨ï¼š</p>
<pre><code class="highlight js"><span class="keyword">const</span> &#123; <span class="title class_">SyncHook</span> &#125; = <span class="built_in">require</span>(<span class="string">&quot;tapable&quot;</span>);
<span class="comment">// ç®€å•æ¥è¯´å°±æ˜¯å®ä¾‹åŒ– Hooks ç±»</span>
<span class="comment">// æ¥æ”¶ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªå‚æ•°åçš„å­—ç¬¦ä¸²æ•°ç»„</span>
<span class="comment">// è¿™ç»„å‚æ•°å’Œæ³¨å†Œå›è°ƒå‡½æ•°çš„å‚æ•°æœ‰å…³ï¼Œ</span>
<span class="keyword">const</span> hook = <span class="keyword">new</span> <span class="title class_">SyncHook</span>([<span class="string">&quot;arg1&quot;</span>, <span class="string">&quot;arg2&quot;</span>, <span class="string">&quot;arg3&quot;</span>]);
<span class="comment">// æ³¨å†Œ</span>
<span class="comment">// ç¬¬ä¸€ä¸ªå…¥å‚ä¸ºæ³¨å†Œå</span>
<span class="comment">// ç¬¬äºŒä¸ªä¸ºæ³¨å†Œå›è°ƒæ–¹æ³•ï¼Œå‚æ•°çš„å½¢å‚ä¸ªæ•°å’Œ`SyncHook`çš„å…¥å‚çš„æ•°ç»„æœ‰å…³ç³»</span>
hook.<span class="title function_">tap</span>(<span class="string">&quot;fn0&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>, arg1, arg2, arg3);
  <span class="keyword">return</span> <span class="string">&quot;fn0&quot;</span>; <span class="comment">// å›è°ƒå‡½æ•°çš„è¿”å›å€¼ä¹‹é—´æ²¡æœ‰è”ç³»</span>
&#125;);
hook.<span class="title function_">tap</span>(<span class="string">&quot;fn1&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>, arg1, arg2, arg3);
  <span class="keyword">return</span> <span class="string">&quot;fn1&quot;</span>;
&#125;);
hook.<span class="title function_">tap</span>(<span class="string">&quot;fn2&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span>, arg1, arg2, arg3);
  <span class="keyword">return</span> <span class="string">&quot;fn2&quot;</span>;
&#125;);
<span class="comment">// æ‰§è¡Œ</span>
<span class="comment">// æ‰§è¡Œé¡ºåºåˆ™æ˜¯æ ¹æ®è¿™ä¸ªå®ä¾‹ç±»å‹æ¥å†³å®šçš„</span>
hook.<span class="title function_">call</span>(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>);</code></pre>

<p><code>call</code>ç”±<a href="https://sourcegraph.com/search?q=context:global+repo:%5Egithub%5C.com/webpack/tapable$+SyncHookCodeFactory&patternType=standard&sm=1">SyncHookCodeFactory</a>çš„<code>content</code>å®ç°, ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="highlight js"><span class="comment">// è¿™æ˜¯ä¸€æ®µ`call`æ–¹æ³•å®ç°çš„ä»£ç å­—ç¬¦ä¸²</span>
<span class="comment">// è¿™æ®µä»£ç éœ€è¦ä½¿ç”¨ `Function` æ¥ç”Ÿæˆ`call`æ–¹æ³•æ¥æ‰§è¡Œ</span>
<span class="comment">// å…¶ä¸­`this._x`å°±æ˜¯æ³¨å†Œçš„å›è°ƒå‡½æ•°ç»„æˆçš„æ•°ç»„</span>
<span class="comment">// å¯ä»¥çœ‹å‡ºå›è°ƒå‡½æ•°çš„è°ƒç”¨å°±æ˜¯æŠŠæ•°ç»„ä¸­çš„å‡½æ•°å±•å¼€</span>
<span class="meta">&quot;use strict&quot;</span>;
<span class="keyword">var</span> _context;
<span class="keyword">var</span> _x = <span class="variable language_">this</span>.<span class="property">_x</span>;
<span class="keyword">var</span> _fn0 = _x[<span class="number">0</span>];
<span class="title function_">_fn0</span>(arg3, arg2, arg1); <span class="comment">// å›è°ƒå‡½æ•° fn0</span>
<span class="keyword">var</span> _fn1 = _x[<span class="number">1</span>];
<span class="title function_">_fn1</span>(arg3, arg2, arg1); <span class="comment">// å›è°ƒå‡½æ•° fn1</span>
<span class="keyword">var</span> _fn2 = _x[<span class="number">2</span>];
<span class="title function_">_fn2</span>(arg3, arg2, arg1); <span class="comment">// å›è°ƒå‡½æ•° fn2</span></code></pre>

<h2 id="SyncBailHook"><a href="#SyncBailHook" class="headerlink" title="SyncBailHook"></a>SyncBailHook</h2><p><a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/SyncBailHook.js?L40:1">SyncBailHook</a> ä¼šå¯¹æ¯æ¬¡æ‰§è¡Œçš„ç»“æœè¿›è¡Œæ£€æµ‹ï¼Œå¦‚æœç»“æœä¸æ˜¯ <code>undefined</code> å°±ç›´æ¥ <code>return</code> äº†ï¼Œåé¢çš„å›è°ƒå‡½æ•°å°±æ²¡æœ‰æœºä¼šæ‰§è¡Œäº†ã€‚</p>
<p>ç®€å•ä½¿ç”¨ï¼š</p>
<pre><code class="highlight js"><span class="keyword">const</span> &#123; <span class="title class_">SyncBailHook</span> &#125; = <span class="built_in">require</span>(<span class="string">&quot;tapable&quot;</span>);
<span class="comment">// ç®€å•æ¥è¯´å°±æ˜¯å®ä¾‹åŒ– Hooks ç±»</span>
<span class="comment">// æ¥æ”¶ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªå‚æ•°åçš„å­—ç¬¦ä¸²æ•°ç»„</span>
<span class="comment">// è¿™ç»„å‚æ•°å’Œæ³¨å†Œå›è°ƒå‡½æ•°çš„å‚æ•°æœ‰å…³ï¼Œ</span>
<span class="comment">// åŒæ­¥æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œå›è°ƒå‡½æ•°è¿”å›ç»“æœä¸æ˜¯ `undefined` å°±ç›´æ¥ `return` äº†ï¼Œåé¢çš„å›è°ƒå‡½æ•°å°±æ²¡æœ‰æœºä¼šæ‰§è¡Œäº†</span>
<span class="keyword">const</span> hook = <span class="keyword">new</span> <span class="title class_">SyncBailHook</span>([<span class="string">&quot;arg1&quot;</span>, <span class="string">&quot;arg2&quot;</span>, <span class="string">&quot;arg3&quot;</span>]);
<span class="comment">// æ³¨å†Œ</span>
<span class="comment">// ç¬¬ä¸€ä¸ªå…¥å‚ä¸ºæ³¨å†Œå</span>
<span class="comment">// ç¬¬äºŒä¸ªä¸ºæ³¨å†Œå›è°ƒæ–¹æ³•ï¼Œå‚æ•°çš„å½¢å‚ä¸ªæ•°å’Œ`SyncBailHook`çš„å…¥å‚çš„æ•°ç»„æœ‰å…³ç³»</span>
hook.<span class="title function_">tap</span>(<span class="string">&quot;fn0&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn0&quot;</span>, arg1, arg2, arg3);
  <span class="keyword">return</span> <span class="literal">undefined</span>;
&#125;);
hook.<span class="title function_">tap</span>(<span class="string">&quot;fn1&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn1&quot;</span>, arg1, arg2, arg3);
  <span class="comment">// å¦‚æœå›è°ƒå‡½æ•°çš„è¿”å›ç»“æœä¸æ˜¯ `undefined` å°±ç›´æ¥ `return` äº†ï¼Œåé¢çš„å›è°ƒå‡½æ•°å°±æ²¡æœ‰æœºä¼šæ‰§è¡Œäº†</span>
  <span class="keyword">return</span> <span class="string">&quot;fn1&quot;</span>;
&#125;);
hook.<span class="title function_">tap</span>(<span class="string">&quot;fn2&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn2&quot;</span>, arg1, arg2, arg3);
  <span class="keyword">return</span> <span class="literal">undefined</span>;
&#125;);
<span class="comment">// æ‰§è¡Œ</span>
<span class="comment">// æ‰§è¡Œé¡ºåºåˆ™æ˜¯æ ¹æ®è¿™ä¸ªå®ä¾‹ç±»å‹æ¥å†³å®šçš„</span>
hook.<span class="title function_">call</span>(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>);</code></pre>

<p><code>call</code>ç”±<code>SyncBailHookCodeFactory</code>çš„<code>content</code>å®ç°, ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="highlight js"><span class="comment">// è¿™æ˜¯ä¸€æ®µ`call`æ–¹æ³•å®ç°çš„ä»£ç å­—ç¬¦ä¸²</span>
<span class="comment">// å‚æ•°å’ŒSyncHookæ˜¯ä¸€è‡´çš„ï¼ŒåŒºåˆ«åœ¨äºå›è°ƒå‡½æ•°çš„è¿”å›å€¼</span>
<span class="comment">// å¦‚æœå›è°ƒå‡½æ•°çš„è¿”å›ç»“æœä¸æ˜¯ `undefined` å°±ç›´æ¥ `return` äº†ï¼Œåé¢çš„å›è°ƒå‡½æ•°å°±æ²¡æœ‰æœºä¼šæ‰§è¡Œäº†ã€‚</span>
<span class="comment">// å°±åƒä¸€ä¸ªæœ‰é™çš„å¥—å¨ƒğŸª†</span>
<span class="meta">&quot;use strict&quot;</span>;
<span class="keyword">var</span> _context;
<span class="keyword">var</span> _x = <span class="variable language_">this</span>.<span class="property">_x</span>;
<span class="keyword">var</span> _fn0 = _x[<span class="number">0</span>];
<span class="keyword">var</span> _result0 = <span class="title function_">_fn0</span>(arg3, arg2, arg1);
<span class="comment">// å¦‚æœè¿”å›ç»“æœä¸æ˜¯ `undefined` å°±ç›´æ¥ `return` äº†ï¼Œåé¢çš„å›è°ƒå‡½æ•°å°±æ²¡æœ‰æœºä¼šæ‰§è¡Œäº†ã€‚</span>
<span class="keyword">if</span> (_result0 !== <span class="literal">undefined</span>) &#123;
  <span class="keyword">return</span> _result0;
&#125; <span class="keyword">else</span> &#123;
  <span class="keyword">var</span> _fn1 = _x[<span class="number">1</span>];
  <span class="keyword">var</span> _result1 = <span class="title function_">_fn1</span>(arg3, arg2, arg1);
  <span class="comment">// å¦‚æœè¿”å›ç»“æœä¸æ˜¯ `undefined` å°±ç›´æ¥ `return` äº†ï¼Œåé¢çš„å›è°ƒå‡½æ•°å°±æ²¡æœ‰æœºä¼šæ‰§è¡Œäº†ã€‚</span>
  <span class="keyword">if</span> (_result1 !== <span class="literal">undefined</span>) &#123;
    <span class="keyword">return</span> _result1;
  &#125; <span class="keyword">else</span> &#123;
    <span class="keyword">var</span> _fn2 = _x[<span class="number">2</span>];
    <span class="keyword">var</span> _result2 = <span class="title function_">_fn2</span>(arg3, arg2, arg1);
    <span class="comment">// å¦‚æœè¿”å›ç»“æœä¸æ˜¯ `undefined` å°±ç›´æ¥ `return` äº†ï¼Œåé¢çš„å›è°ƒå‡½æ•°å°±æ²¡æœ‰æœºä¼šæ‰§è¡Œäº†ã€‚</span>
    <span class="keyword">if</span> (_result2 !== <span class="literal">undefined</span>) &#123;
      <span class="keyword">return</span> _result2;
    &#125; <span class="keyword">else</span> &#123;
    &#125;
  &#125;
&#125;</code></pre>

<h2 id="SyncLoopHook"><a href="#SyncLoopHook" class="headerlink" title="SyncLoopHook"></a>SyncLoopHook</h2><p><a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/SyncLoopHook.js?L35:1">SyncLoopHook</a> ä¼šå¯¹æ¯æ¬¡æ‰§è¡Œçš„ç»“æœè¿›è¡Œæ£€æµ‹ï¼Œå¦‚æœç»“æœä¸æ˜¯ <code>undefined</code> å°±ä¸åœå¾ªç¯ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°åˆ°å½“å‰å›è°ƒå‡½æ•°ï¼Œç›´è‡³éƒ½è¿”å› <code>undefined</code>ã€‚</p>
<p>ç®€å•ä½¿ç”¨ï¼š</p>
<pre><code class="highlight js"><span class="keyword">const</span> &#123; <span class="title class_">SyncLoopHook</span> &#125; = <span class="built_in">require</span>(<span class="string">&quot;tapable&quot;</span>);
<span class="comment">// ç®€å•æ¥è¯´å°±æ˜¯å®ä¾‹åŒ– Hooks ç±»</span>
<span class="comment">// æ¥æ”¶ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªå‚æ•°åçš„å­—ç¬¦ä¸²æ•°ç»„</span>
<span class="comment">// è¿™ç»„å‚æ•°å’Œæ³¨å†Œå›è°ƒå‡½æ•°çš„å‚æ•°æœ‰å…³ï¼Œ</span>
<span class="keyword">const</span> hook = <span class="keyword">new</span> <span class="title class_">SyncLoopHook</span>([<span class="string">&quot;arg1&quot;</span>, <span class="string">&quot;arg2&quot;</span>, <span class="string">&quot;arg3&quot;</span>]);
<span class="keyword">let</span> _loop = <span class="number">4</span>;

<span class="comment">// æ³¨å†Œ</span>
<span class="comment">// ç¬¬ä¸€ä¸ªå…¥å‚ä¸ºæ³¨å†Œå</span>
<span class="comment">// ç¬¬äºŒä¸ªä¸ºæ³¨å†Œå›è°ƒæ–¹æ³•ï¼Œå‚æ•°çš„å½¢å‚ä¸ªæ•°å’Œ`SyncLoopHook`çš„å…¥å‚çš„æ•°ç»„æœ‰å…³ç³»</span>
hook.<span class="title function_">tap</span>(<span class="string">&quot;fn0&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn0&quot;</span>, arg1, arg2, arg3);
  <span class="keyword">return</span> <span class="literal">undefined</span>;
&#125;);
hook.<span class="title function_">tap</span>(<span class="string">&quot;fn1&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn1&quot;</span>, arg1, arg2, arg3);
  _loop = _loop - <span class="number">1</span>;
  <span class="comment">// å¦‚æœè¿”å›ç»“æœä¸æ˜¯ `undefined` å°±ä¸åœå¾ªç¯ `f0` `f1`ï¼Œç›´è‡³éƒ½è¿”å› `undefined`ã€‚</span>
  <span class="keyword">return</span> _loop &gt; <span class="number">0</span> ? _loop : <span class="literal">undefined</span>;
&#125;);
hook.<span class="title function_">tap</span>(<span class="string">&quot;fn2&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn2&quot;</span>, arg1, arg2, arg3);
  <span class="keyword">return</span> <span class="literal">undefined</span>;
&#125;);
<span class="comment">// æ‰§è¡Œ</span>
<span class="comment">// æ‰§è¡Œé¡ºåºåˆ™æ˜¯æ ¹æ®è¿™ä¸ªå®ä¾‹ç±»å‹æ¥å†³å®šçš„</span>
hook.<span class="title function_">call</span>(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>);</code></pre>

<p><code>call</code>ç”±<a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/SyncLoopHook.js?L10:1">SyncLoopHookCodeFactory</a>çš„<code>content</code>å®ç°, ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="highlight js"><span class="comment">// è¿™æ˜¯ä¸€æ®µ`call`æ–¹æ³•å®ç°çš„ä»£ç å­—ç¬¦ä¸²</span>
<span class="comment">// å‚æ•°å’ŒSyncHookæ˜¯ä¸€è‡´çš„ï¼ŒåŒºåˆ«åœ¨äºå›è°ƒå‡½æ•°çš„è¿”å›å€¼</span>
<span class="comment">// å¦‚æœç»“æœä¸æ˜¯ `undefined` å°±ä¸åœå¾ªç¯ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°åˆ°å½“å‰å›è°ƒå‡½æ•°ï¼Œç›´è‡³éƒ½è¿”å› `undefined`</span>
<span class="comment">// æ³¨æ„: ä¸è¿”å›`undefined`å°±ä¸åœå¾ªç¯ï¼Œå®¹æ˜“é€ æˆæ­»å¾ªç¯</span>
<span class="meta">&quot;use strict&quot;</span>;
<span class="keyword">var</span> _context;
<span class="keyword">var</span> _x = <span class="variable language_">this</span>.<span class="property">_x</span>;
<span class="keyword">var</span> _loop;
<span class="keyword">do</span> &#123;
  _loop = <span class="literal">false</span>;
  <span class="keyword">var</span> _fn0 = _x[<span class="number">0</span>];
  <span class="keyword">var</span> _result0 = <span class="title function_">_fn0</span>(arg3, arg2, arg1);
  <span class="keyword">if</span> (_result0 !== <span class="literal">undefined</span>) &#123;
    _loop = <span class="literal">true</span>;
  &#125; <span class="keyword">else</span> &#123;
    <span class="keyword">var</span> _fn1 = _x[<span class="number">1</span>];
    <span class="keyword">var</span> _result1 = <span class="title function_">_fn1</span>(arg3, arg2, arg1);
    <span class="keyword">if</span> (_result1 !== <span class="literal">undefined</span>) &#123;
      _loop = <span class="literal">true</span>;
    &#125; <span class="keyword">else</span> &#123;
      <span class="keyword">var</span> _fn2 = _x[<span class="number">2</span>];
      <span class="keyword">var</span> _result2 = <span class="title function_">_fn2</span>(arg3, arg2, arg1);
      <span class="keyword">if</span> (_result2 !== <span class="literal">undefined</span>) &#123;
        _loop = <span class="literal">true</span>;
      &#125; <span class="keyword">else</span> &#123;
        <span class="keyword">if</span> (!_loop) &#123;
        &#125;
      &#125;
    &#125;
  &#125;
&#125; <span class="keyword">while</span> (_loop);</code></pre>

<h2 id="SyncWaterfallHook"><a href="#SyncWaterfallHook" class="headerlink" title="SyncWaterfallHook"></a>SyncWaterfallHook</h2><p><a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/SyncWaterfallHook.js?L44">SyncWaterfallHook</a> ä¼šå¯¹æ¯æ¬¡æ‰§è¡Œçš„ç»“æœå½“æˆä¸‹ä¸€ä¸ªå›è°ƒå‡½æ•°çš„å…¥å‚ï¼ˆ<code>call</code>çš„å…¥å‚ ï¼‰ï¼Œå¦‚æœè¿”å›å€¼æ˜¯ <code>undefined</code>ï¼Œä½¿ç”¨ä¸Šä¸€ä¸ªå‚æ•°ã€‚</p>
<p>ç®€å•ä½¿ç”¨ï¼š</p>
<pre><code class="highlight js"><span class="keyword">const</span> &#123; <span class="title class_">SyncWaterfallHook</span> &#125; = <span class="built_in">require</span>(<span class="string">&quot;tapable&quot;</span>);
<span class="comment">// ç®€å•æ¥è¯´å°±æ˜¯å®ä¾‹åŒ– Hooks ç±»</span>
<span class="comment">// æ¥æ”¶ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªå‚æ•°åçš„å­—ç¬¦ä¸²æ•°ç»„</span>
<span class="comment">// è¿™ç»„å‚æ•°å’Œæ³¨å†Œå›è°ƒå‡½æ•°çš„å‚æ•°æœ‰å…³ï¼Œ</span>
<span class="keyword">const</span> hook = <span class="keyword">new</span> <span class="title class_">SyncWaterfallHook</span>([<span class="string">&quot;arg1&quot;</span>, <span class="string">&quot;arg2&quot;</span>, <span class="string">&quot;arg3&quot;</span>]);

<span class="comment">// æ³¨å†Œ</span>
<span class="comment">// ç¬¬ä¸€ä¸ªå…¥å‚ä¸ºæ³¨å†Œå</span>
<span class="comment">// ç¬¬äºŒä¸ªä¸ºæ³¨å†Œå›è°ƒæ–¹æ³•ï¼Œå‚æ•°çš„å½¢å‚ä¸ªæ•°å’Œ`SyncWaterfallHook`çš„å…¥å‚çš„æ•°ç»„æœ‰å…³ç³»</span>
hook.<span class="title function_">tap</span>(<span class="string">&quot;fn0&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn0&quot;</span>, arg1, arg2, arg3);
  <span class="keyword">return</span> <span class="string">&quot;fn0-result&quot;</span>;
&#125;);
hook.<span class="title function_">tap</span>(<span class="string">&quot;fn1&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn1&quot;</span>, arg1, arg2, arg3);
  <span class="keyword">return</span> <span class="literal">undefined</span>;
&#125;);
hook.<span class="title function_">tap</span>(<span class="string">&quot;fn2&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn2&quot;</span>, arg1, arg2, arg3);
  <span class="keyword">return</span> <span class="string">&quot;fn2&quot;</span>;
&#125;);
hook.<span class="title function_">tap</span>(<span class="string">&quot;fn3&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn3&quot;</span>, arg1, arg2, arg3);
  <span class="keyword">return</span> <span class="string">&quot;fn3&quot;</span>;
&#125;);
<span class="comment">// æ‰§è¡Œ</span>
<span class="comment">// æ‰§è¡Œé¡ºåºåˆ™æ˜¯æ ¹æ®è¿™ä¸ªå®ä¾‹ç±»å‹æ¥å†³å®šçš„</span>
hook.<span class="title function_">call</span>(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>);
<span class="comment">// æ‰§è¡Œç»“æœï¼š</span>
<span class="comment">// fn0 a b c</span>
<span class="comment">// fn1 fn0-result b c</span>
<span class="comment">// fn2 fn0-result b c</span>
<span class="comment">// fn3 fn2 b c</span></code></pre>

<p><code>call</code>ç”±<a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/SyncWaterfallHook.js?L10:7">SyncWaterfallHookCodeFactory</a>çš„<code>content</code>å®ç°, ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="highlight js"><span class="comment">// è¿™æ˜¯ä¸€æ®µ`call`æ–¹æ³•å®ç°çš„ä»£ç å­—ç¬¦ä¸²</span>
<span class="comment">// å‚æ•°å’ŒSyncHookæ˜¯ä¸€è‡´çš„ï¼ŒåŒºåˆ«åœ¨äºå›è°ƒå‡½æ•°çš„è¿”å›å€¼</span>
<span class="comment">// å¦‚æœè¿”å›å€¼æ˜¯ `undefined` , ä½¿ç”¨`call`çš„å‚æ•°ï¼Œå¦åˆ™ä½¿ç”¨è¿”å›çš„å€¼</span>
<span class="meta">&quot;use strict&quot;</span>;
<span class="keyword">var</span> _context;
<span class="keyword">var</span> _x = <span class="variable language_">this</span>.<span class="property">_x</span>;
<span class="keyword">var</span> _fn0 = _x[<span class="number">0</span>];
<span class="keyword">var</span> _result0 = <span class="title function_">_fn0</span>(arg1, arg2, arg3);
<span class="keyword">if</span> (_result0 !== <span class="literal">undefined</span>) &#123;
  <span class="comment">// å¦‚æœè¿”å›å€¼æ˜¯ `undefined` , ä½¿ç”¨`call`çš„å‚æ•°ï¼Œå¦åˆ™ä½¿ç”¨è¿”å›çš„å€¼</span>
  arg1 = _result0;
&#125;
<span class="keyword">var</span> _fn1 = _x[<span class="number">1</span>];
<span class="keyword">var</span> _result1 = <span class="title function_">_fn1</span>(arg1, arg2, arg3);
<span class="keyword">if</span> (_result1 !== <span class="literal">undefined</span>) &#123;
  <span class="comment">// å¦‚æœè¿”å›å€¼æ˜¯ `undefined` , ä½¿ç”¨`call`çš„å‚æ•°ï¼Œå¦åˆ™ä½¿ç”¨è¿”å›çš„å€¼</span>
  arg1 = _result1;
&#125;
<span class="keyword">var</span> _fn2 = _x[<span class="number">2</span>];
<span class="keyword">var</span> _result2 = <span class="title function_">_fn2</span>(arg1, arg2, arg3);
<span class="keyword">if</span> (_result2 !== <span class="literal">undefined</span>) &#123;
  <span class="comment">// å¦‚æœè¿”å›å€¼æ˜¯ `undefined` , ä½¿ç”¨`call`çš„å‚æ•°ï¼Œå¦åˆ™ä½¿ç”¨è¿”å›çš„å€¼</span>
  arg1 = _result2;
&#125;
<span class="keyword">var</span> _fn3 = _x[<span class="number">3</span>];
<span class="keyword">var</span> _result3 = <span class="title function_">_fn3</span>(arg1, arg2, arg3);
<span class="keyword">if</span> (_result3 !== <span class="literal">undefined</span>) &#123;
  arg1 = _result3;
&#125;
<span class="keyword">return</span> arg1;</code></pre>

<h2 id="AsyncSeriesHook"><a href="#AsyncSeriesHook" class="headerlink" title="AsyncSeriesHook"></a>AsyncSeriesHook</h2><p><a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/AsyncSeriesHook.js?L26:1">AsyncSeriesHook</a>å¼‚æ­¥ä¸²è¡Œ</p>
<pre><code class="highlight js"><span class="keyword">const</span> &#123; <span class="title class_">AsyncSeriesHook</span> &#125; = <span class="built_in">require</span>(<span class="string">&quot;tapable&quot;</span>);
<span class="comment">// ç®€å•æ¥è¯´å°±æ˜¯å®ä¾‹åŒ– Hooks ç±»</span>
<span class="comment">// æ¥æ”¶ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªå‚æ•°åçš„å­—ç¬¦ä¸²æ•°ç»„</span>
<span class="comment">// è¿™ç»„å‚æ•°å’Œæ³¨å†Œå›è°ƒå‡½æ•°çš„å‚æ•°æœ‰å…³ï¼Œ</span>
<span class="keyword">const</span> hook = <span class="keyword">new</span> <span class="title class_">AsyncSeriesHook</span>([<span class="string">&quot;arg1&quot;</span>, <span class="string">&quot;arg2&quot;</span>, <span class="string">&quot;arg3&quot;</span>]);

<span class="comment">// æ³¨å†Œ</span>
<span class="comment">// ç¬¬ä¸€ä¸ªå…¥å‚ä¸ºæ³¨å†Œå</span>
<span class="comment">// ç¬¬äºŒä¸ªä¸ºæ³¨å†Œå›è°ƒæ–¹æ³•ï¼Œå‚æ•°çš„å½¢å‚ä¸ªæ•°å’Œ`AsyncSeriesHook`çš„å…¥å‚çš„æ•°ç»„æœ‰å…³ç³»</span>
hook.<span class="title function_">tapAsync</span>(<span class="string">&quot;fn0&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3, callback</span>) =&gt;</span> &#123;
  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;
    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn0&quot;</span>, arg1, arg2, arg3);
    <span class="title function_">callback</span>();
  &#125;, <span class="number">1000</span>);
&#125;);
hook.<span class="title function_">tapAsync</span>(<span class="string">&quot;fn1&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3, callback</span>) =&gt;</span> &#123;
  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;
    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn1&quot;</span>, arg1, arg2, arg3);
    <span class="title function_">callback</span>();
  &#125;, <span class="number">1000</span>);
&#125;);
hook.<span class="title function_">tapAsync</span>(<span class="string">&quot;fn2&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3, callback</span>) =&gt;</span> &#123;
  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;
    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn2&quot;</span>, arg1, arg2, arg3);
    <span class="title function_">callback</span>(); <span class="comment">// å†³å®š `callAsync` æœ€åçš„å®å‚callbackæ˜¯å¦ä¼šè¢«è°ƒç”¨</span>
  &#125;, <span class="number">1000</span>);
&#125;);
<span class="comment">// æ‰§è¡Œ</span>
<span class="comment">// æ‰§è¡Œé¡ºåºåˆ™æ˜¯æ ¹æ®è¿™ä¸ªå®ä¾‹ç±»å‹æ¥å†³å®šçš„</span>
hook.<span class="title function_">callAsync</span>(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>, <span class="function">() =&gt;</span> &#123;
  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;AsyncSeriesHook async&quot;</span>);
&#125;);

<span class="comment">// æ‰§è¡Œç»“æœï¼š</span>
<span class="comment">// fn0 a b c</span>
<span class="comment">// fn1 a b c</span>
<span class="comment">// fn2 a b c</span>
<span class="comment">// AsyncSeriesHook async</span></code></pre>

<p><code>callAsync</code> ç”±<a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/AsyncSeriesHook.js?L10:1">AsyncSeriesHookCodeFactory</a>çš„<code>content</code>å®ç°, æ›´æ·±å±‚æ¬¡æ¥è¯´åº”è¯¥æ˜¯ç”±<a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/HookCodeFactory.js?L7:1">HookCodeFactory</a>çš„<a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/HookCodeFactory.js?L276">callTapsSeries</a>å®ç°ã€‚ ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="highlight js"><span class="meta">&quot;use strict&quot;</span>;
<span class="keyword">var</span> _context;
<span class="keyword">var</span> _x = <span class="variable language_">this</span>.<span class="property">_x</span>;
<span class="keyword">function</span> <span class="title function_">_next1</span>(<span class="params"></span>) &#123;
  <span class="keyword">var</span> _fn2 = _x[<span class="number">2</span>];
  <span class="title function_">_fn2</span>(arg1, arg2, arg3, <span class="keyword">function</span> (<span class="params">_err2</span>) &#123;
    <span class="comment">// ...</span>
  &#125;);
&#125;
<span class="keyword">function</span> <span class="title function_">_next0</span>(<span class="params"></span>) &#123;
  <span class="keyword">var</span> _fn1 = _x[<span class="number">1</span>];
  <span class="title function_">_fn1</span>(arg1, arg2, arg3, <span class="keyword">function</span> (<span class="params">_err1</span>) &#123;
    <span class="comment">// ...</span>
    <span class="title function_">_next1</span>();
  &#125;);
&#125;
<span class="keyword">var</span> _fn0 = _x[<span class="number">0</span>];
<span class="title function_">_fn0</span>(arg1, arg2, arg3, <span class="keyword">function</span> (<span class="params">_err0</span>) &#123;
  <span class="comment">// ...</span>
  <span class="title function_">_next0</span>();
&#125;);</code></pre>

<p><code>Promise</code> æ–¹å¼</p>
<pre><code class="highlight js"><span class="keyword">const</span> &#123; <span class="title class_">AsyncSeriesHook</span> &#125; = <span class="built_in">require</span>(<span class="string">&quot;tapable&quot;</span>);

<span class="comment">// ç®€å•æ¥è¯´å°±æ˜¯å®ä¾‹åŒ– Hooks ç±»</span>
<span class="comment">// æ¥æ”¶ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªå‚æ•°åçš„å­—ç¬¦ä¸²æ•°ç»„</span>
<span class="comment">// è¿™ç»„å‚æ•°å’Œæ³¨å†Œå›è°ƒå‡½æ•°çš„å‚æ•°æœ‰å…³ï¼Œ</span>
<span class="keyword">const</span> hook = <span class="keyword">new</span> <span class="title class_">AsyncSeriesHook</span>([<span class="string">&quot;arg1&quot;</span>, <span class="string">&quot;arg2&quot;</span>, <span class="string">&quot;arg3&quot;</span>]);

<span class="comment">// æ³¨å†Œ</span>
<span class="comment">// ç¬¬ä¸€ä¸ªå…¥å‚ä¸ºæ³¨å†Œå</span>
<span class="comment">// ç¬¬äºŒä¸ªä¸ºæ³¨å†Œå›è°ƒæ–¹æ³•ï¼Œå‚æ•°çš„å½¢å‚ä¸ªæ•°å’Œ`AsyncSeriesHook`çš„å…¥å‚çš„æ•°ç»„æœ‰å…³ç³»</span>
hook.<span class="title function_">tapPromise</span>(<span class="string">&quot;fn0&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;
    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;
      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn0&quot;</span>, arg1, arg2, arg3);
      <span class="title function_">resolve</span>();
    &#125;, <span class="number">1000</span>);
  &#125;);
&#125;);
hook.<span class="title function_">tapPromise</span>(<span class="string">&quot;fn1&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3, callback</span>) =&gt;</span> &#123;
  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;
    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;
      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn1&quot;</span>, arg1, arg2, arg3);
      <span class="title function_">resolve</span>();
    &#125;, <span class="number">1000</span>);
  &#125;);
&#125;);
hook.<span class="title function_">tapPromise</span>(<span class="string">&quot;fn2&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3, callback</span>) =&gt;</span> &#123;
  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;
    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;
      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn2&quot;</span>, arg1, arg2, arg3);
      <span class="title function_">resolve</span>();
    &#125;, <span class="number">1000</span>);
  &#125;);
&#125;);
<span class="comment">// æ‰§è¡Œ</span>
<span class="comment">// æ‰§è¡Œé¡ºåºåˆ™æ˜¯æ ¹æ®è¿™ä¸ªå®ä¾‹ç±»å‹æ¥å†³å®šçš„</span>
hook.<span class="title function_">promise</span>(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>);</code></pre>

<p><code>promise</code> ç”±<a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/AsyncSeriesHook.js?L10:1">AsyncSeriesHookCodeFactory</a>çš„<code>content</code>å®ç°, æ›´æ·±å±‚æ¬¡æ¥è¯´åº”è¯¥æ˜¯ç”±<a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/HookCodeFactory.js?L7:1">HookCodeFactory</a>çš„<a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/HookCodeFactory.js?L276">callTapsSeries</a>å®ç°ã€‚ ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="highlight js"><span class="meta">&quot;use strict&quot;</span>;
<span class="keyword">var</span> _context;
<span class="keyword">var</span> _x = <span class="variable language_">this</span>.<span class="property">_x</span>;
<span class="keyword">function</span> <span class="title function_">_next1</span>(<span class="params"></span>) &#123;
  <span class="keyword">var</span> _fn2 = _x[<span class="number">2</span>];
  <span class="keyword">var</span> _hasResult2 = <span class="literal">false</span>;
  <span class="keyword">var</span> _promise2 = <span class="title function_">_fn2</span>(arg1, arg2, arg3);
  _promise2.<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">_result2</span>) &#123;
    _hasResult2 = <span class="literal">true</span>;
  &#125;);
&#125;
<span class="keyword">function</span> <span class="title function_">_next0</span>(<span class="params"></span>) &#123;
  <span class="keyword">var</span> _fn1 = _x[<span class="number">1</span>];
  <span class="keyword">var</span> _hasResult1 = <span class="literal">false</span>;
  <span class="keyword">var</span> _promise1 = <span class="title function_">_fn1</span>(arg1, arg2, arg3);
  _promise1.<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">_result1</span>) &#123;
    _hasResult1 = <span class="literal">true</span>;
    <span class="title function_">_next1</span>();
  &#125;);
&#125;
<span class="keyword">var</span> _fn0 = _x[<span class="number">0</span>];
<span class="keyword">var</span> _hasResult0 = <span class="literal">false</span>;
<span class="keyword">var</span> _promise0 = <span class="title function_">_fn0</span>(arg1, arg2, arg3);
_promise0.<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">_result0</span>) &#123;
  _hasResult0 = <span class="literal">true</span>;
  <span class="title function_">_next0</span>();
&#125;);</code></pre>

<h2 id="AsyncSeriesBailHook"><a href="#AsyncSeriesBailHook" class="headerlink" title="AsyncSeriesBailHook"></a>AsyncSeriesBailHook</h2><p><a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/AsyncSeriesBailHook.js?L31">AsyncSeriesBailHook</a> ä¼šå¯¹æ¯æ¬¡å¼‚æ­¥æ‰§è¡Œçš„ç»“æœè¿›è¡Œæ£€æµ‹ï¼Œå¦‚æœç»“æœä¸æ˜¯ <code>undefined</code> å°±ç›´æ¥ <code>return</code> äº†ï¼Œåé¢çš„å›è°ƒå‡½æ•°å°±æ²¡æœ‰æœºä¼šæ‰§è¡Œäº†</p>
<pre><code class="highlight js"><span class="keyword">const</span> &#123; <span class="title class_">AsyncSeriesBailHook</span> &#125; = <span class="built_in">require</span>(<span class="string">&quot;tapable&quot;</span>);
<span class="comment">// ç®€å•æ¥è¯´å°±æ˜¯å®ä¾‹åŒ– Hooks ç±»</span>
<span class="comment">// æ¥æ”¶ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªå‚æ•°åçš„å­—ç¬¦ä¸²æ•°ç»„</span>
<span class="comment">// è¿™ç»„å‚æ•°å’Œæ³¨å†Œå›è°ƒå‡½æ•°çš„å‚æ•°æœ‰å…³ï¼Œ</span>
<span class="keyword">const</span> hook = <span class="keyword">new</span> <span class="title class_">AsyncSeriesBailHook</span>([<span class="string">&quot;arg1&quot;</span>, <span class="string">&quot;arg2&quot;</span>, <span class="string">&quot;arg3&quot;</span>]);

<span class="comment">// æ³¨å†Œ</span>
<span class="comment">// ç¬¬ä¸€ä¸ªå…¥å‚ä¸ºæ³¨å†Œå</span>
<span class="comment">// ç¬¬äºŒä¸ªä¸ºæ³¨å†Œå›è°ƒæ–¹æ³•ï¼Œå‚æ•°çš„å½¢å‚ä¸ªæ•°å’Œ`AsyncSeriesBailHook`çš„å…¥å‚çš„æ•°ç»„æœ‰å…³ç³»</span>
<span class="comment">// ä¸²è¡Œè°ƒç”¨</span>
hook.<span class="title function_">tapPromise</span>(<span class="string">&quot;fn0&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;
    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;
      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn0&quot;</span>, arg1, arg2, arg3);
      <span class="title function_">resolve</span>();
    &#125;, <span class="number">1000</span>);
  &#125;);
&#125;);
hook.<span class="title function_">tapPromise</span>(<span class="string">&quot;fn1&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3, callback</span>) =&gt;</span> &#123;
  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;
    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;
      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn1&quot;</span>, arg1, arg2, arg3);
      <span class="title function_">resolve</span>(<span class="number">12</span>); <span class="comment">// åé¢çš„å›è°ƒä¸ä¼šæ‰§è¡Œ</span>
    &#125;, <span class="number">1000</span>);
  &#125;);
&#125;);
hook.<span class="title function_">tapPromise</span>(<span class="string">&quot;fn2&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3, callback</span>) =&gt;</span> &#123;
  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;
    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;
      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn2&quot;</span>, arg1, arg2, arg3);
      <span class="title function_">resolve</span>();
    &#125;, <span class="number">1000</span>);
  &#125;);
&#125;);
<span class="comment">// æ‰§è¡Œ</span>
<span class="comment">// æ‰§è¡Œé¡ºåºåˆ™æ˜¯æ ¹æ®è¿™ä¸ªå®ä¾‹ç±»å‹æ¥å†³å®šçš„</span>
hook.<span class="title function_">promise</span>(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>);

<span class="comment">// æ‰§è¡Œç»“æœï¼š</span>
<span class="comment">// fn0 a b c</span>
<span class="comment">// fn1 a b c</span></code></pre>

<p><code>tapAsync</code> å’Œ <code>callAsync</code>çš„ç»„åˆåŒç†</p>
<pre><code class="highlight js"><span class="meta">&quot;use strict&quot;</span>;
<span class="keyword">var</span> _context;
<span class="keyword">var</span> _x = <span class="variable language_">this</span>.<span class="property">_x</span>;
<span class="keyword">function</span> <span class="title function_">_next1</span>(<span class="params"></span>) &#123;
  <span class="keyword">var</span> _fn2 = _x[<span class="number">2</span>];
  <span class="keyword">var</span> _hasResult2 = <span class="literal">false</span>;
  <span class="keyword">var</span> _promise2 = <span class="title function_">_fn2</span>(arg1, arg2, arg3);
  <span class="comment">//...</span>
  _promise2.<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">_result2</span>) &#123;
    _hasResult2 = <span class="literal">true</span>;
    <span class="keyword">if</span> (_result2 !== <span class="literal">undefined</span>) &#123;
      <span class="keyword">return</span> _result2;
    &#125; <span class="keyword">else</span> &#123;
    &#125;
  &#125;);
&#125;
<span class="keyword">function</span> <span class="title function_">_next0</span>(<span class="params"></span>) &#123;
  <span class="keyword">var</span> _fn1 = _x[<span class="number">1</span>];
  <span class="keyword">var</span> _hasResult1 = <span class="literal">false</span>;
  <span class="keyword">var</span> _promise1 = <span class="title function_">_fn1</span>(arg1, arg2, arg3);
  <span class="comment">//...</span>
  _promise1.<span class="title function_">then</span>(
    <span class="keyword">function</span> (<span class="params">_result1</span>) &#123;
      _hasResult1 = <span class="literal">true</span>;
      <span class="keyword">if</span> (_result1 !== <span class="literal">undefined</span>) &#123;
        <span class="keyword">return</span> _result1;
      &#125; <span class="keyword">else</span> &#123;
        <span class="keyword">return</span> <span class="title function_">_next1</span>();
      &#125;
    &#125;
    <span class="comment">//...</span>
  );
&#125;
<span class="keyword">var</span> _fn0 = _x[<span class="number">0</span>];
<span class="keyword">var</span> _hasResult0 = <span class="literal">false</span>;
<span class="keyword">var</span> _promise0 = <span class="title function_">_fn0</span>(arg1, arg2, arg3);
<span class="comment">//...</span>
_promise0.<span class="title function_">then</span>(
  <span class="keyword">function</span> (<span class="params">_result0</span>) &#123;
    _hasResult0 = <span class="literal">true</span>;
    <span class="keyword">if</span> (_result0 !== <span class="literal">undefined</span>) &#123;
      <span class="keyword">return</span> _result0;
    &#125; <span class="keyword">else</span> &#123;
      <span class="keyword">return</span> <span class="title function_">_next0</span>();
    &#125;
  &#125;
  <span class="comment">//...</span>
);</code></pre>

<h2 id="AsyncSeriesLoopHook"><a href="#AsyncSeriesLoopHook" class="headerlink" title="AsyncSeriesLoopHook"></a>AsyncSeriesLoopHook</h2><p><a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/AsyncSeriesLoopHook.js?L26">AsyncSeriesLoopHook</a>ä¼šå¯¹æ¯æ¬¡å¼‚æ­¥æ‰§è¡Œçš„ç»“æœè¿›è¡Œæ£€æµ‹ï¼Œå¦‚æœç»“æœä¸æ˜¯ <code>undefined</code> å°±ä¸åœå¾ªç¯ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°åˆ°å½“å‰å›è°ƒå‡½æ•°ï¼Œç›´è‡³éƒ½è¿”å› <code>undefined</code>ã€‚</p>
<pre><code class="highlight js"><span class="keyword">const</span> &#123; <span class="title class_">AsyncSeriesLoopHook</span> &#125; = <span class="built_in">require</span>(<span class="string">&quot;tapable&quot;</span>);
<span class="comment">// ç®€å•æ¥è¯´å°±æ˜¯å®ä¾‹åŒ– Hooks ç±»</span>
<span class="comment">// æ¥æ”¶ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªå‚æ•°åçš„å­—ç¬¦ä¸²æ•°ç»„</span>
<span class="comment">// è¿™ç»„å‚æ•°å’Œæ³¨å†Œå›è°ƒå‡½æ•°çš„å‚æ•°æœ‰å…³ï¼Œ</span>
<span class="keyword">const</span> hook = <span class="keyword">new</span> <span class="title class_">AsyncSeriesLoopHook</span>([<span class="string">&quot;arg1&quot;</span>, <span class="string">&quot;arg2&quot;</span>, <span class="string">&quot;arg3&quot;</span>]);

<span class="keyword">let</span> _loop = <span class="number">2</span>; <span class="comment">// å¾ªç¯ä¸¤æ¬¡</span>

<span class="comment">// æ³¨å†Œ</span>
<span class="comment">// ç¬¬ä¸€ä¸ªå…¥å‚ä¸ºæ³¨å†Œå</span>
<span class="comment">// ç¬¬äºŒä¸ªä¸ºæ³¨å†Œå›è°ƒæ–¹æ³•ï¼Œå‚æ•°çš„å½¢å‚ä¸ªæ•°å’Œ`AsyncSeriesLoopHook`çš„å…¥å‚çš„æ•°ç»„æœ‰å…³ç³»</span>
hook.<span class="title function_">tapPromise</span>(<span class="string">&quot;fn0&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;
    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;
      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn0&quot;</span>, arg1, arg2, arg3);
      <span class="title function_">resolve</span>();
    &#125;, <span class="number">1000</span>);
  &#125;);
&#125;);
hook.<span class="title function_">tapPromise</span>(<span class="string">&quot;fn1&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3, callback</span>) =&gt;</span> &#123;
  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;
    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;
      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn1&quot;</span>, arg1, arg2, arg3);
      <span class="title function_">resolve</span>(_loop &gt; <span class="number">0</span> ? <span class="string">&quot;fn1 result&quot;</span> : <span class="literal">undefined</span>);
      _loop = _loop - <span class="number">1</span>;
    &#125;, <span class="number">1000</span>);
  &#125;);
&#125;);
hook.<span class="title function_">tapPromise</span>(<span class="string">&quot;fn2&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3, callback</span>) =&gt;</span> &#123;
  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;
    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;
      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn2&quot;</span>, arg1, arg2, arg3);
      <span class="title function_">resolve</span>();
    &#125;, <span class="number">1000</span>);
  &#125;);
&#125;);
<span class="comment">// æ‰§è¡Œ</span>
<span class="comment">// æ‰§è¡Œé¡ºåºåˆ™æ˜¯æ ¹æ®è¿™ä¸ªå®ä¾‹ç±»å‹æ¥å†³å®šçš„</span>
hook.<span class="title function_">promise</span>(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>);

<span class="comment">// æ‰§è¡Œç»“æœ</span>
<span class="comment">// fn0 a b c</span>
<span class="comment">// fn1 a b c</span>
<span class="comment">// fn0 a b c // å¾ªç¯</span>
<span class="comment">// fn1 a b c // å¾ªç¯</span>
<span class="comment">// fn0 a b c // å¾ªç¯</span>
<span class="comment">// fn1 a b c // å¾ªç¯</span>
<span class="comment">// fn2 a b c</span></code></pre>

<p><code>tapAsync</code> å’Œ <code>callAsync</code>çš„ç»„åˆåŒç†</p>
<p><code>promise</code> ç”±<a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/AsyncSeriesLoopHook.js?L10:1">AsyncSeriesLoopHookCodeFactory</a>çš„<code>content</code>å®ç°, æ›´æ·±å±‚æ¬¡æ¥è¯´åº”è¯¥æ˜¯ç”±<a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/HookCodeFactory.js?L7:1">HookCodeFactory</a>çš„<a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/HookCodeFactory.js?L324:2">callTapsLooping</a>å®ç°ã€‚ ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="highlight js"><span class="meta">&quot;use strict&quot;</span>;
<span class="keyword">var</span> _context;
<span class="keyword">var</span> _x = <span class="variable language_">this</span>.<span class="property">_x</span>;
<span class="keyword">var</span> _looper = <span class="keyword">function</span> (<span class="params"></span>) &#123;
  <span class="keyword">var</span> _loopAsync = <span class="literal">false</span>;
  <span class="keyword">var</span> _loop;
  <span class="keyword">do</span> &#123;
    _loop = <span class="literal">false</span>;
    <span class="keyword">function</span> <span class="title function_">_next1</span>(<span class="params"></span>) &#123;
      <span class="keyword">var</span> _fn2 = _x[<span class="number">2</span>];
      <span class="keyword">var</span> _hasResult2 = <span class="literal">false</span>;
      <span class="keyword">var</span> _promise2 = <span class="title function_">_fn2</span>(arg1, arg2, arg3);
      <span class="comment">// åˆ¤æ–­è¿”å›æ˜¯ä¸æ˜¯promise</span>
      <span class="keyword">if</span> (!_promise2 || !_promise2.<span class="property">then</span>)
        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(
          <span class="string">&quot;Tap function (tapPromise) did not return promise (returned &quot;</span> +
            _promise2 +
            <span class="string">&quot;)&quot;</span>
        );
      _promise2.<span class="title function_">then</span>(
        <span class="keyword">function</span> (<span class="params">_result2</span>) &#123;
          _hasResult2 = <span class="literal">true</span>;
          <span class="keyword">if</span> (_result2 !== <span class="literal">undefined</span>) &#123;
            _loop = <span class="literal">true</span>;
            <span class="keyword">if</span> (_loopAsync) <span class="title function_">_looper</span>();
          &#125; <span class="keyword">else</span> &#123;
            <span class="keyword">if</span> (!_loop) &#123;
            &#125;
          &#125;
        &#125;
        <span class="comment">// ... reject å¤„ç†</span>
      );
    &#125;
    <span class="keyword">function</span> <span class="title function_">_next0</span>(<span class="params"></span>) &#123;
      <span class="keyword">var</span> _fn1 = _x[<span class="number">1</span>];
      <span class="keyword">var</span> _hasResult1 = <span class="literal">false</span>;
      <span class="keyword">var</span> _promise1 = <span class="title function_">_fn1</span>(arg1, arg2, arg3);
      <span class="comment">// ...</span>
      _promise1.<span class="title function_">then</span>(
        <span class="keyword">function</span> (<span class="params">_result1</span>) &#123;
          _hasResult1 = <span class="literal">true</span>;
          <span class="keyword">if</span> (_result1 !== <span class="literal">undefined</span>) &#123;
            _loop = <span class="literal">true</span>;
            <span class="keyword">if</span> (_loopAsync) <span class="title function_">_looper</span>();
          &#125; <span class="keyword">else</span> &#123;
            <span class="title function_">_next1</span>();
          &#125;
        &#125;
        <span class="comment">// ... reject å¤„ç†</span>
      );
    &#125;
    <span class="keyword">var</span> _fn0 = _x[<span class="number">0</span>];
    <span class="keyword">var</span> _hasResult0 = <span class="literal">false</span>;
    <span class="keyword">var</span> _promise0 = <span class="title function_">_fn0</span>(arg1, arg2, arg3);
    <span class="comment">// ...</span>
    _promise0.<span class="title function_">then</span>(
      <span class="keyword">function</span> (<span class="params">_result0</span>) &#123;
        _hasResult0 = <span class="literal">true</span>;
        <span class="keyword">if</span> (_result0 !== <span class="literal">undefined</span>) &#123;
          _loop = <span class="literal">true</span>;
          <span class="keyword">if</span> (_loopAsync) <span class="title function_">_looper</span>();
        &#125; <span class="keyword">else</span> &#123;
          <span class="title function_">_next0</span>();
        &#125;
      &#125;
      <span class="comment">// ... reject å¤„ç†</span>
    );
  &#125; <span class="keyword">while</span> (_loop);
  _loopAsync = <span class="literal">true</span>;
&#125;;
<span class="title function_">_looper</span>();</code></pre>

<h2 id="AsyncSeriesWaterfallHook"><a href="#AsyncSeriesWaterfallHook" class="headerlink" title="AsyncSeriesWaterfallHook"></a>AsyncSeriesWaterfallHook</h2><p><a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/AsyncSeriesWaterfallHook.js?L34">AsyncSeriesWaterfallHook</a>ä¼šå¯¹æ¯æ¬¡æ‰§è¡Œå¼‚æ­¥å‡½æ•°çš„ç»“æœå½“æˆä¸‹ä¸€ä¸ªå›è°ƒå‡½æ•°çš„å…¥å‚ï¼ˆ<code>callAsync</code>&#x2F;<code>promise</code>çš„å…¥å‚ ï¼‰ï¼Œå¦‚æœè¿”å›å€¼æ˜¯ <code>undefined</code>ï¼Œä½¿ç”¨ä¸Šä¸€ä¸ªå‚æ•°ã€‚</p>
<pre><code class="highlight js"><span class="keyword">const</span> &#123; <span class="title class_">AsyncSeriesWaterfallHook</span> &#125; = <span class="built_in">require</span>(<span class="string">&quot;tapable&quot;</span>);
<span class="comment">// ç®€å•æ¥è¯´å°±æ˜¯å®ä¾‹åŒ– Hooks ç±»</span>
<span class="comment">// æ¥æ”¶ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªå‚æ•°åçš„å­—ç¬¦ä¸²æ•°ç»„</span>
<span class="comment">// è¿™ç»„å‚æ•°å’Œæ³¨å†Œå›è°ƒå‡½æ•°çš„å‚æ•°æœ‰å…³ï¼Œ</span>
<span class="keyword">const</span> hook = <span class="keyword">new</span> <span class="title class_">AsyncSeriesWaterfallHook</span>([<span class="string">&quot;arg1&quot;</span>, <span class="string">&quot;arg2&quot;</span>, <span class="string">&quot;arg3&quot;</span>]);

<span class="comment">// æ³¨å†Œ</span>
<span class="comment">// ç¬¬ä¸€ä¸ªå…¥å‚ä¸ºæ³¨å†Œå</span>
<span class="comment">// ç¬¬äºŒä¸ªä¸ºæ³¨å†Œå›è°ƒæ–¹æ³•ï¼Œå‚æ•°çš„å½¢å‚ä¸ªæ•°å’Œ`AsyncSeriesWaterfallHook`çš„å…¥å‚çš„æ•°ç»„æœ‰å…³ç³»</span>
hook.<span class="title function_">tapPromise</span>(<span class="string">&quot;fn0&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;
    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;
      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn0&quot;</span>, arg1, arg2, arg3);
      <span class="title function_">resolve</span>();
    &#125;, <span class="number">1000</span>);
  &#125;);
&#125;);
hook.<span class="title function_">tapPromise</span>(<span class="string">&quot;fn1&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3, callback</span>) =&gt;</span> &#123;
  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;
    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;
      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn1&quot;</span>, arg1, arg2, arg3);
      <span class="title function_">resolve</span>(<span class="string">&quot;fn1-result&quot;</span>); <span class="comment">// è¿”å›å€¼ä½œä¸ºfn2çš„ç¬¬ä¸€ä¸ªå…¥å‚</span>
    &#125;, <span class="number">1000</span>);
  &#125;);
&#125;);
hook.<span class="title function_">tapPromise</span>(<span class="string">&quot;fn2&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3, callback</span>) =&gt;</span> &#123;
  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;
    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;
      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn2&quot;</span>, arg1, arg2, arg3);
      <span class="title function_">resolve</span>();
    &#125;, <span class="number">1000</span>);
  &#125;);
&#125;);
<span class="comment">// æ‰§è¡Œ</span>
<span class="comment">// æ‰§è¡Œé¡ºåºåˆ™æ˜¯æ ¹æ®è¿™ä¸ªå®ä¾‹ç±»å‹æ¥å†³å®šçš„</span>
hook.<span class="title function_">promise</span>(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>);

<span class="comment">// æ‰§è¡Œç»“æœ</span>
<span class="comment">// fn0 a b c</span>
<span class="comment">// fn1 a b c</span>
<span class="comment">// fn2 fn1-result b c</span></code></pre>

<p><code>tapAsync</code> å’Œ <code>callAsync</code>çš„ç»„åˆåŒç†</p>
<p><code>promise</code> ç”±<a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/AsyncSeriesWaterfallHook.js?L10:1">AsyncSeriesWaterfallHookCodeFactory</a>çš„<code>content</code>å®ç°, æ›´æ·±å±‚æ¬¡æ¥è¯´åº”è¯¥æ˜¯ç”±<a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/HookCodeFactory.js?L7:1">HookCodeFactory</a>çš„<a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/HookCodeFactory.js?L276">callTapsSeries</a>å®ç°ã€‚ ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="highlight js"><span class="meta">&quot;use strict&quot;</span>;
<span class="keyword">var</span> _context;
<span class="keyword">var</span> _x = <span class="variable language_">this</span>.<span class="property">_x</span>;
<span class="keyword">function</span> <span class="title function_">_next2</span>(<span class="params"></span>) &#123;
  <span class="keyword">var</span> _fn3 = _x[<span class="number">3</span>];
  <span class="keyword">var</span> _hasResult3 = <span class="literal">false</span>;
  <span class="keyword">var</span> _promise3 = <span class="title function_">_fn3</span>(arg1, arg2, arg3);
  <span class="keyword">if</span> (!_promise3 || !_promise3.<span class="property">then</span>)
    <span class="comment">// åˆ¤æ–­è¿”å›æ˜¯ä¸æ˜¯promise</span>
    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(
      <span class="string">&quot;Tap function (tapPromise) did not return promise (returned &quot;</span> +
        _promise3 +
        <span class="string">&quot;)&quot;</span>
    );
  _promise3.<span class="title function_">then</span>(
    <span class="keyword">function</span> (<span class="params">_result3</span>) &#123;
      _hasResult3 = <span class="literal">true</span>;
      <span class="keyword">if</span> (_result3 !== <span class="literal">undefined</span>) &#123;
        arg1 = _result3;
      &#125;
      <span class="keyword">return</span> arg1;
    &#125;
    <span class="comment">// ...</span>
  );
&#125;
<span class="keyword">function</span> <span class="title function_">_next1</span>(<span class="params"></span>) &#123;
  <span class="keyword">var</span> _fn2 = _x[<span class="number">2</span>];
  <span class="keyword">var</span> _hasResult2 = <span class="literal">false</span>;
  <span class="keyword">var</span> _promise2 = <span class="title function_">_fn2</span>(arg1, arg2, arg3);
  <span class="comment">// ...</span>
  _promise2.<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">_result2</span>) &#123;
    _hasResult2 = <span class="literal">true</span>;
    <span class="keyword">if</span> (_result2 !== <span class="literal">undefined</span>) &#123;
      arg1 = _result2;
    &#125;
    <span class="title function_">_next2</span>();
  &#125;);
&#125;
<span class="keyword">function</span> <span class="title function_">_next0</span>(<span class="params"></span>) &#123;
  <span class="keyword">var</span> _fn1 = _x[<span class="number">1</span>];
  <span class="keyword">var</span> _hasResult1 = <span class="literal">false</span>;
  <span class="keyword">var</span> _promise1 = <span class="title function_">_fn1</span>(arg1, arg2, arg3);
  <span class="comment">// ...</span>
  _promise1.<span class="title function_">then</span>(
    <span class="keyword">function</span> (<span class="params">_result1</span>) &#123;
      _hasResult1 = <span class="literal">true</span>;
      <span class="keyword">if</span> (_result1 !== <span class="literal">undefined</span>) &#123;
        arg1 = _result1;
      &#125;
      <span class="title function_">_next1</span>();
    &#125;
    <span class="comment">// ...</span>
  );
&#125;
<span class="keyword">var</span> _fn0 = _x[<span class="number">0</span>];
<span class="keyword">var</span> _hasResult0 = <span class="literal">false</span>;
<span class="keyword">var</span> _promise0 = <span class="title function_">_fn0</span>(arg1, arg2, arg3);
<span class="comment">// ...</span>
_promise0.<span class="title function_">then</span>(
  <span class="keyword">function</span> (<span class="params">_result0</span>) &#123;
    _hasResult0 = <span class="literal">true</span>;
    <span class="keyword">if</span> (_result0 !== <span class="literal">undefined</span>) &#123;
      arg1 = _result0;
    &#125;
    <span class="title function_">_next0</span>();
  &#125;
  <span class="comment">// ...</span>
);</code></pre>

<h2 id="AsyncParallelHook"><a href="#AsyncParallelHook" class="headerlink" title="AsyncParallelHook"></a>AsyncParallelHook</h2><p><a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/AsyncParallelHook.js?L26:1">AsyncParallelHook</a>å¹¶è¡Œæ‰§è¡Œ, ä¸å…³å¿ƒå›è°ƒå‡½æ•°çš„è¿”å›å€¼ã€‚</p>
<pre><code class="highlight js"><span class="keyword">const</span> &#123; <span class="title class_">AsyncParallelHook</span> &#125; = <span class="built_in">require</span>(<span class="string">&quot;tapable&quot;</span>);
<span class="comment">// ç®€å•æ¥è¯´å°±æ˜¯å®ä¾‹åŒ– Hooks ç±»</span>
<span class="comment">// æ¥æ”¶ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªå‚æ•°åçš„å­—ç¬¦ä¸²æ•°ç»„</span>
<span class="comment">// è¿™ç»„å‚æ•°å’Œæ³¨å†Œå›è°ƒå‡½æ•°çš„å‚æ•°æœ‰å…³ï¼Œ</span>
<span class="comment">// å¹¶è¡Œæ‰§è¡Œ ä¸å…³å¿ƒå›è°ƒå‡½æ•°çš„è¿”å›å€¼ã€‚</span>
<span class="keyword">const</span> hook = <span class="keyword">new</span> <span class="title class_">AsyncParallelHook</span>([<span class="string">&quot;arg1&quot;</span>, <span class="string">&quot;arg2&quot;</span>, <span class="string">&quot;arg3&quot;</span>]);

<span class="comment">// æ³¨å†Œ</span>
<span class="comment">// ç¬¬ä¸€ä¸ªå…¥å‚ä¸ºæ³¨å†Œå</span>
<span class="comment">// ç¬¬äºŒä¸ªä¸ºæ³¨å†Œå›è°ƒæ–¹æ³•ï¼Œå‚æ•°çš„å½¢å‚ä¸ªæ•°å’Œ`AsyncParallelHook`çš„å…¥å‚çš„æ•°ç»„æœ‰å…³ç³»</span>
hook.<span class="title function_">tapPromise</span>(<span class="string">&quot;fn0&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;
    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;
      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn0&quot;</span>, arg1, arg2, arg3);
      <span class="title function_">resolve</span>();
    &#125;, <span class="number">1000</span>);
  &#125;);
&#125;);
hook.<span class="title function_">tapPromise</span>(<span class="string">&quot;fn1&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;
    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;
      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn1&quot;</span>, arg1, arg2, arg3);
      <span class="title function_">resolve</span>(<span class="string">&quot;fn1-result&quot;</span>);
    &#125;, <span class="number">1000</span>);
  &#125;);
&#125;);
hook.<span class="title function_">tapPromise</span>(<span class="string">&quot;fn2&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;
    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;
      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn2&quot;</span>, arg1, arg2, arg3);
      <span class="title function_">resolve</span>();
    &#125;, <span class="number">500</span>);
  &#125;);
&#125;);
<span class="comment">// æ‰§è¡Œ</span>
<span class="comment">// æ‰§è¡Œé¡ºåºåˆ™æ˜¯æ ¹æ®è¿™ä¸ªå®ä¾‹ç±»å‹æ¥å†³å®šçš„</span>
hook.<span class="title function_">promise</span>(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>);

<span class="comment">// æ‰§è¡Œç»“æœ</span>
<span class="comment">// fn2 a b c</span>
<span class="comment">// fn0 a b c</span>
<span class="comment">// fn1 a b c</span></code></pre>

<p><code>tapAsync</code> å’Œ <code>callAsync</code>çš„ç»„åˆåŒç†</p>
<p><code>promise</code> ç”±<a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/AsyncParallelHook.js?L10:1">AsyncParallelHookCodeFactory</a>çš„<code>content</code>å®ç°, æ›´æ·±å±‚æ¬¡æ¥è¯´åº”è¯¥æ˜¯ç”±<a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/HookCodeFactory.js?L7:1">HookCodeFactory</a>çš„<a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/HookCodeFactory.js?L376:2">callTapsParallel</a>å®ç°ã€‚ ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="highlight js"><span class="meta">&quot;use strict&quot;</span>;
<span class="keyword">var</span> _context;
<span class="keyword">var</span> _x = <span class="variable language_">this</span>.<span class="property">_x</span>;
<span class="keyword">do</span> &#123;
  <span class="keyword">var</span> _counter = <span class="number">3</span>;
  <span class="keyword">var</span> _done = <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;;
  <span class="keyword">if</span> (_counter &lt;= <span class="number">0</span>) <span class="keyword">break</span>;
  <span class="keyword">var</span> _fn0 = _x[<span class="number">0</span>];
  <span class="keyword">var</span> _hasResult0 = <span class="literal">false</span>;
  <span class="keyword">var</span> _promise0 = <span class="title function_">_fn0</span>(arg1, arg2, arg3);

  <span class="comment">// åˆ¤æ–­è¿”å›æ˜¯ä¸æ˜¯promise</span>
  <span class="keyword">if</span> (!_promise0 || !_promise0.<span class="property">then</span>)
    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(
      <span class="string">&quot;Tap function (tapPromise) did not return promise (returned &quot;</span> +
        _promise0 +
        <span class="string">&quot;)&quot;</span>
    );
  _promise0.<span class="title function_">then</span>(
    <span class="keyword">function</span> (<span class="params">_result0</span>) &#123;
      _hasResult0 = <span class="literal">true</span>;
      <span class="keyword">if</span> (--_counter === <span class="number">0</span>) <span class="title function_">_done</span>();
    &#125;,
    <span class="keyword">function</span> (<span class="params">_err0</span>) &#123;
      <span class="keyword">if</span> (_hasResult0) <span class="keyword">throw</span> _err0;
      <span class="keyword">if</span> (_counter &gt; <span class="number">0</span>) &#123;
        <span class="keyword">throw</span> _err0;
        _counter = <span class="number">0</span>;
      &#125;
    &#125;
  );
  <span class="keyword">if</span> (_counter &lt;= <span class="number">0</span>) <span class="keyword">break</span>;
  <span class="keyword">var</span> _fn1 = _x[<span class="number">1</span>];
  <span class="keyword">var</span> _hasResult1 = <span class="literal">false</span>;
  <span class="keyword">var</span> _promise1 = <span class="title function_">_fn1</span>(arg1, arg2, arg3);
  <span class="comment">// ...</span>
  _promise1.<span class="title function_">then</span>(
    <span class="keyword">function</span> (<span class="params">_result1</span>) &#123;
      _hasResult1 = <span class="literal">true</span>;
      <span class="keyword">if</span> (--_counter === <span class="number">0</span>) <span class="title function_">_done</span>();
    &#125;,
    <span class="keyword">function</span> (<span class="params">_err1</span>) &#123;
      <span class="keyword">if</span> (_hasResult1) <span class="keyword">throw</span> _err1;
      <span class="keyword">if</span> (_counter &gt; <span class="number">0</span>) &#123;
        <span class="keyword">throw</span> _err1;
        _counter = <span class="number">0</span>;
      &#125;
    &#125;
  );
  <span class="keyword">if</span> (_counter &lt;= <span class="number">0</span>) <span class="keyword">break</span>;
  <span class="keyword">var</span> _fn2 = _x[<span class="number">2</span>];
  <span class="keyword">var</span> _hasResult2 = <span class="literal">false</span>;
  <span class="keyword">var</span> _promise2 = <span class="title function_">_fn2</span>(arg1, arg2, arg3);
  <span class="comment">// ...</span>
  _promise2.<span class="title function_">then</span>(
    <span class="keyword">function</span> (<span class="params">_result2</span>) &#123;
      _hasResult2 = <span class="literal">true</span>;
      <span class="keyword">if</span> (--_counter === <span class="number">0</span>) <span class="title function_">_done</span>();
    &#125;,
    <span class="keyword">function</span> (<span class="params">_err2</span>) &#123;
      <span class="keyword">if</span> (_hasResult2) <span class="keyword">throw</span> _err2;
      <span class="keyword">if</span> (_counter &gt; <span class="number">0</span>) &#123;
        <span class="keyword">throw</span> _err2;
        _counter = <span class="number">0</span>;
      &#125;
    &#125;
  );
&#125; <span class="keyword">while</span> (<span class="literal">false</span>);</code></pre>

<h2 id="AsyncParallelBailHook"><a href="#AsyncParallelBailHook" class="headerlink" title="AsyncParallelBailHook"></a>AsyncParallelBailHook</h2><p><a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/AsyncParallelBailHook.js?L74:1">AsyncParallelBailHook</a> åªè¦å›è°ƒå‡½æ•°çš„è¿”å›å€¼ä¸ä¸º <code>undefined</code>, å°±ä¼šå¿½ç•¥åé¢çš„å›è°ƒå‡½æ•°æ‰§è¡Œ, ç›´æ¥è·³è·ƒåˆ° <code>callAsync</code> ç­‰è§¦å‘å‡½æ•°ç»‘å®šçš„å›è°ƒå‡½æ•°, ç„¶åæ‰§è¡Œè¿™ä¸ªè¢«ç»‘å®šçš„å›è°ƒå‡½æ•°ã€‚</p>
<p>ä½¿ç”¨å’ŒåŸç†ä¸ SyncBailHook ç›¸ä¼¼</p>
<pre><code class="highlight js"><span class="keyword">const</span> &#123; <span class="title class_">AsyncParallelBailHook</span> &#125; = <span class="built_in">require</span>(<span class="string">&quot;tabable&quot;</span>);
<span class="comment">// ç®€å•æ¥è¯´å°±æ˜¯å®ä¾‹åŒ– Hooks ç±»</span>
<span class="comment">// æ¥æ”¶ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªå‚æ•°åçš„å­—ç¬¦ä¸²æ•°ç»„</span>
<span class="comment">// è¿™ç»„å‚æ•°å’Œæ³¨å†Œå›è°ƒå‡½æ•°çš„å‚æ•°æœ‰å…³ï¼Œ</span>
<span class="comment">// å¹¶è¡Œæ‰§è¡Œ ä¸å…³å¿ƒå›è°ƒå‡½æ•°çš„è¿”å›å€¼ã€‚</span>
<span class="keyword">const</span> hook = <span class="keyword">new</span> <span class="title class_">AsyncParallelBailHook</span>([<span class="string">&quot;arg1&quot;</span>, <span class="string">&quot;arg2&quot;</span>, <span class="string">&quot;arg3&quot;</span>]);

<span class="comment">// æ³¨å†Œ</span>
<span class="comment">// ç¬¬ä¸€ä¸ªå…¥å‚ä¸ºæ³¨å†Œå</span>
<span class="comment">// ç¬¬äºŒä¸ªä¸ºæ³¨å†Œå›è°ƒæ–¹æ³•ï¼Œå‚æ•°çš„å½¢å‚ä¸ªæ•°å’Œ`AsyncParallelBailHook`çš„å…¥å‚çš„æ•°ç»„æœ‰å…³ç³»</span>
hook.<span class="title function_">tapPromise</span>(<span class="string">&quot;fn0&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;
    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;
      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn0&quot;</span>, arg1, arg2, arg3);
      <span class="title function_">resolve</span>();
    &#125;, <span class="number">1000</span>);
  &#125;);
&#125;);
hook.<span class="title function_">tapPromise</span>(<span class="string">&quot;fn1&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;
    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;
      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn1&quot;</span>, arg1, arg2, arg3);
      <span class="title function_">resolve</span>(<span class="string">&quot;fn1-result&quot;</span>);
    &#125;, <span class="number">1000</span>);
  &#125;);
&#125;);
hook.<span class="title function_">tapPromise</span>(<span class="string">&quot;fn2&quot;</span>, <span class="function">(<span class="params">arg1, arg2, arg3</span>) =&gt;</span> &#123;
  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;
    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;
      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn2&quot;</span>, arg1, arg2, arg3);
      <span class="title function_">resolve</span>();
    &#125;, <span class="number">500</span>);
  &#125;);
&#125;);
<span class="comment">// æ‰§è¡Œ</span>
<span class="comment">// æ‰§è¡Œé¡ºåºåˆ™æ˜¯æ ¹æ®è¿™ä¸ªå®ä¾‹ç±»å‹æ¥å†³å®šçš„</span>
hook.<span class="title function_">promise</span>(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>);

<span class="comment">// æ‰§è¡Œç»“æœ</span>
<span class="comment">// fn2 a b c</span>
<span class="comment">// fn0 a b c</span>
<span class="comment">// fn1 a b c</span></code></pre>

<p><code>tapAsync</code> å’Œ <code>callAsync</code>çš„ç»„åˆåŒç†</p>
<p><code>promise</code> ç”±<a href="https://sourcegraph.com/github.com/webpack/tapable/-/blob/lib/AsyncParallelBailHook.js?L10:1">AsyncParallelBailHookCodeFactory</a>çš„<code>content</code>å®ç°ã€‚ ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="highlight js"><span class="meta">&quot;use strict&quot;</span>;
<span class="keyword">var</span> _context;
<span class="keyword">var</span> _x = <span class="variable language_">this</span>.<span class="property">_x</span>;
<span class="keyword">var</span> _results = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">3</span>);
<span class="keyword">var</span> _checkDone = <span class="keyword">function</span> (<span class="params"></span>) &#123;
  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; _results.<span class="property">length</span>; i++) &#123;
    <span class="keyword">var</span> item = _results[i];
    <span class="keyword">if</span> (item === <span class="literal">undefined</span>) <span class="keyword">return</span> <span class="literal">false</span>;
    <span class="keyword">if</span> (item.<span class="property">result</span> !== <span class="literal">undefined</span>) &#123;
      <span class="keyword">return</span> item.<span class="property">result</span>;
      <span class="keyword">return</span> <span class="literal">true</span>;
    &#125;
    <span class="keyword">if</span> (item.<span class="property">error</span>) &#123;
      <span class="keyword">throw</span> item.<span class="property">error</span>;
      <span class="keyword">return</span> <span class="literal">true</span>;
    &#125;
  &#125;
  <span class="keyword">return</span> <span class="literal">false</span>;
&#125;;
<span class="keyword">do</span> &#123;
  <span class="keyword">var</span> _counter = <span class="number">3</span>;
  <span class="keyword">var</span> _done = <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;;
  <span class="keyword">if</span> (_counter &lt;= <span class="number">0</span>) <span class="keyword">break</span>;
  <span class="keyword">var</span> _fn0 = _x[<span class="number">0</span>];
  <span class="keyword">var</span> _hasResult0 = <span class="literal">false</span>;
  <span class="keyword">var</span> _promise0 = <span class="title function_">_fn0</span>(arg1, arg2, arg3);
  <span class="comment">// åˆ¤æ–­è¿”å›æ˜¯ä¸æ˜¯promise</span>
  <span class="keyword">if</span> (!_promise0 || !_promise0.<span class="property">then</span>)
    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(
      <span class="string">&quot;Tap function (tapPromise) did not return promise (returned &quot;</span> +
        _promise0 +
        <span class="string">&quot;)&quot;</span>
    );
  _promise0.<span class="title function_">then</span>(
    <span class="keyword">function</span> (<span class="params">_result0</span>) &#123;
      _hasResult0 = <span class="literal">true</span>;
      <span class="keyword">if</span> (_counter &gt; <span class="number">0</span>) &#123;
        <span class="keyword">if</span> (
          <span class="number">0</span> &lt; _results.<span class="property">length</span> &amp;&amp;
          (_result0 !== <span class="literal">undefined</span> &amp;&amp; (_results.<span class="property">length</span> = <span class="number">1</span>),
          (_results[<span class="number">0</span>] = &#123; <span class="attr">result</span>: _result0 &#125;),
          <span class="title function_">_checkDone</span>())
        ) &#123;
          _counter = <span class="number">0</span>;
        &#125; <span class="keyword">else</span> &#123;
          <span class="keyword">if</span> (--_counter === <span class="number">0</span>) <span class="title function_">_done</span>();
        &#125;
      &#125;
    &#125;,
    <span class="keyword">function</span> (<span class="params">_err0</span>) &#123;
      <span class="keyword">if</span> (_hasResult0) <span class="keyword">throw</span> _err0;
      <span class="keyword">if</span> (_counter &gt; <span class="number">0</span>) &#123;
        <span class="keyword">if</span> (
          <span class="number">0</span> &lt; _results.<span class="property">length</span> &amp;&amp;
          ((_results.<span class="property">length</span> = <span class="number">1</span>),
          (_results[<span class="number">0</span>] = &#123; <span class="attr">error</span>: _err0 &#125;),
          <span class="title function_">_checkDone</span>())
        ) &#123;
          _counter = <span class="number">0</span>;
        &#125; <span class="keyword">else</span> &#123;
          <span class="keyword">if</span> (--_counter === <span class="number">0</span>) <span class="title function_">_done</span>();
        &#125;
      &#125;
    &#125;
  );
  <span class="keyword">if</span> (_counter &lt;= <span class="number">0</span>) <span class="keyword">break</span>;
  <span class="keyword">if</span> (<span class="number">1</span> &gt;= _results.<span class="property">length</span>) &#123;
    <span class="keyword">if</span> (--_counter === <span class="number">0</span>) <span class="title function_">_done</span>();
  &#125; <span class="keyword">else</span> &#123;
    <span class="keyword">var</span> _fn1 = _x[<span class="number">1</span>];
    <span class="keyword">var</span> _hasResult1 = <span class="literal">false</span>;
    <span class="keyword">var</span> _promise1 = <span class="title function_">_fn1</span>(arg1, arg2, arg3);
    <span class="comment">// ...</span>
    _promise1.<span class="title function_">then</span>(
      <span class="keyword">function</span> (<span class="params">_result1</span>) &#123;
        _hasResult1 = <span class="literal">true</span>;
        <span class="keyword">if</span> (_counter &gt; <span class="number">0</span>) &#123;
          <span class="keyword">if</span> (
            <span class="number">1</span> &lt; _results.<span class="property">length</span> &amp;&amp;
            (_result1 !== <span class="literal">undefined</span> &amp;&amp; (_results.<span class="property">length</span> = <span class="number">2</span>),
            (_results[<span class="number">1</span>] = &#123; <span class="attr">result</span>: _result1 &#125;),
            <span class="title function_">_checkDone</span>())
          ) &#123;
            _counter = <span class="number">0</span>;
          &#125; <span class="keyword">else</span> &#123;
            <span class="keyword">if</span> (--_counter === <span class="number">0</span>) <span class="title function_">_done</span>();
          &#125;
        &#125;
      &#125;,
      <span class="keyword">function</span> (<span class="params">_err1</span>) &#123;
        <span class="keyword">if</span> (_hasResult1) <span class="keyword">throw</span> _err1;
        <span class="keyword">if</span> (_counter &gt; <span class="number">0</span>) &#123;
          <span class="keyword">if</span> (
            <span class="number">1</span> &lt; _results.<span class="property">length</span> &amp;&amp;
            ((_results.<span class="property">length</span> = <span class="number">2</span>),
            (_results[<span class="number">1</span>] = &#123; <span class="attr">error</span>: _err1 &#125;),
            <span class="title function_">_checkDone</span>())
          ) &#123;
            _counter = <span class="number">0</span>;
          &#125; <span class="keyword">else</span> &#123;
            <span class="keyword">if</span> (--_counter === <span class="number">0</span>) <span class="title function_">_done</span>();
          &#125;
        &#125;
      &#125;
    );
  &#125;
  <span class="keyword">if</span> (_counter &lt;= <span class="number">0</span>) <span class="keyword">break</span>;
  <span class="keyword">if</span> (<span class="number">2</span> &gt;= _results.<span class="property">length</span>) &#123;
    <span class="keyword">if</span> (--_counter === <span class="number">0</span>) <span class="title function_">_done</span>();
  &#125; <span class="keyword">else</span> &#123;
    <span class="keyword">var</span> _fn2 = _x[<span class="number">2</span>];
    <span class="keyword">var</span> _hasResult2 = <span class="literal">false</span>;
    <span class="keyword">var</span> _promise2 = <span class="title function_">_fn2</span>(arg1, arg2, arg3);
    <span class="comment">// ...</span>
    _promise2.<span class="title function_">then</span>(
      <span class="keyword">function</span> (<span class="params">_result2</span>) &#123;
        _hasResult2 = <span class="literal">true</span>;
        <span class="keyword">if</span> (_counter &gt; <span class="number">0</span>) &#123;
          <span class="keyword">if</span> (
            <span class="number">2</span> &lt; _results.<span class="property">length</span> &amp;&amp;
            (_result2 !== <span class="literal">undefined</span> &amp;&amp; (_results.<span class="property">length</span> = <span class="number">3</span>),
            (_results[<span class="number">2</span>] = &#123; <span class="attr">result</span>: _result2 &#125;),
            <span class="title function_">_checkDone</span>())
          ) &#123;
            _counter = <span class="number">0</span>;
          &#125; <span class="keyword">else</span> &#123;
            <span class="keyword">if</span> (--_counter === <span class="number">0</span>) <span class="title function_">_done</span>();
          &#125;
        &#125;
      &#125;,
      <span class="keyword">function</span> (<span class="params">_err2</span>) &#123;
        <span class="keyword">if</span> (_hasResult2) <span class="keyword">throw</span> _err2;
        <span class="keyword">if</span> (_counter &gt; <span class="number">0</span>) &#123;
          <span class="keyword">if</span> (
            <span class="number">2</span> &lt; _results.<span class="property">length</span> &amp;&amp;
            ((_results.<span class="property">length</span> = <span class="number">3</span>),
            (_results[<span class="number">2</span>] = &#123; <span class="attr">error</span>: _err2 &#125;),
            <span class="title function_">_checkDone</span>())
          ) &#123;
            _counter = <span class="number">0</span>;
          &#125; <span class="keyword">else</span> &#123;
            <span class="keyword">if</span> (--_counter === <span class="number">0</span>) <span class="title function_">_done</span>();
          &#125;
        &#125;
      &#125;
    );
  &#125;
&#125; <span class="keyword">while</span> (<span class="literal">false</span>);</code></pre>

<p>å‚è€ƒ</p>
<p><a href="https://github.com/webpack/tapable">tapable</a></p>
<p><a href="https://www.cnblogs.com/dennisj/p/14606902.html">webpack æ ¸å¿ƒæ¨¡å— tapable æºç è§£æ</a></p>
]]></content>
      <categories>
        <category>Webpack</category>
      </categories>
      <tags>
        <tag>Webpack</tag>
      </tags>
  </entry>
</search>
